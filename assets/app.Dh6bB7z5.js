import{j as X}from"./jsx-runtime.D_zvdyIk.js";import{r as R,a as so}from"./index.BzNeU_WD.js";import"./index.BLy_0GNg.js";const Ur=(e,t,n={})=>{if(!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let r,i,o=[];const s=()=>{clearTimeout(i),i=void 0;try{n.signal?.throwIfAborted()}catch(a){for(const{reject:c}of o)c(a);o=[]}};return function(...a){return new Promise((c,u)=>{try{n.signal?.throwIfAborted()}catch(h){u(h);return}const p=n.before&&!i;clearTimeout(i),i=setTimeout(async()=>{i=void 0;const h=o;o=[];try{const y=n.before?r:await e.apply(this,a);for(const{resolve:g}of h)g(y)}catch(y){for(const{reject:g}of h)g(y)}r=void 0,n.signal?.removeEventListener("abort",s)},t),p?(async()=>{try{r=await e.apply(this,a),c(r)}catch(h){u(h)}})():(o.push({resolve:c,reject:u}),n.signal&&o.length===1&&n.signal.addEventListener("abort",s,{once:!0}))})}};Ur.promise=(e,t={})=>{let n,r;return async function(...i){if(n)return t.after?(r??={resolvers:[]},r.arguments=i,r.context=this,new Promise((o,s)=>{r.resolvers.push({resolve:o,reject:s})})):n;n=(async()=>{let o,s;try{o=await e.apply(this,i)}catch(a){s=a}for(;r;){const a=r;r=void 0;try{const c=await e.apply(a.context,a.arguments);for(const{resolve:u}of a.resolvers)u(c)}catch(c){for(const{reject:u}of a.resolvers)u(c)}}if(s)throw s;return o})();try{return await n}finally{n=void 0}}};var zt={},M={},D={},$n;function Fr(){if($n)return D;$n=1;var e=D&&D.__extends||(function(){var d=function(f,l){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(m[v]=b[v])},d(f,l)};return function(f,l){d(f,l);function m(){this.constructor=f}f.prototype=l===null?Object.create(l):(m.prototype=l.prototype,new m)}})(),t=D&&D.__awaiter||function(d,f,l,m){function b(v){return v instanceof l?v:new l(function(w){w(v)})}return new(l||(l=Promise))(function(v,w){function I(E){try{_(m.next(E))}catch(A){w(A)}}function O(E){try{_(m.throw(E))}catch(A){w(A)}}function _(E){E.done?v(E.value):b(E.value).then(I,O)}_((m=m.apply(d,f||[])).next())})},n=D&&D.__generator||function(d,f){var l={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},m,b,v,w;return w={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function I(_){return function(E){return O([_,E])}}function O(_){if(m)throw new TypeError("Generator is already executing.");for(;l;)try{if(m=1,b&&(v=_[0]&2?b.return:_[0]?b.throw||((v=b.return)&&v.call(b),0):b.next)&&!(v=v.call(b,_[1])).done)return v;switch(b=0,v&&(_=[_[0]&2,v.value]),_[0]){case 0:case 1:v=_;break;case 4:return l.label++,{value:_[1],done:!1};case 5:l.label++,b=_[1],_=[0];continue;case 7:_=l.ops.pop(),l.trys.pop();continue;default:if(v=l.trys,!(v=v.length>0&&v[v.length-1])&&(_[0]===6||_[0]===2)){l=0;continue}if(_[0]===3&&(!v||_[1]>v[0]&&_[1]<v[3])){l.label=_[1];break}if(_[0]===6&&l.label<v[1]){l.label=v[1],v=_;break}if(v&&l.label<v[2]){l.label=v[2],l.ops.push(_);break}v[2]&&l.ops.pop(),l.trys.pop();continue}_=f.call(d,l)}catch(E){_=[6,E],b=0}finally{m=v=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},r=D&&D.__read||function(d,f){var l=typeof Symbol=="function"&&d[Symbol.iterator];if(!l)return d;var m=l.call(d),b,v=[],w;try{for(;(f===void 0||f-- >0)&&!(b=m.next()).done;)v.push(b.value)}catch(I){w={error:I}}finally{try{b&&!b.done&&(l=m.return)&&l.call(m)}finally{if(w)throw w.error}}return v},i=D&&D.__spread||function(){for(var d=[],f=0;f<arguments.length;f++)d=d.concat(r(arguments[f]));return d};Object.defineProperty(D,"__esModule",{value:!0}),D.zip2=D.join=D.optionify=D.AsyncNone=D.None=D.AsyncSome=D.Some=void 0;var o=Vr(),s=(function(){function d(f){this._value=f}return d})(),a=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.isSome=function(){return!0},f.prototype.isNone=function(){return!1},f.prototype.map=function(l){return new f(l(this._value))},f.prototype.mapNullable=function(l){return h(l(this._value))},f.prototype.mapOr=function(l,m){return new f(m(this._value))},f.prototype.mapOrElse=function(l,m){return m(this._value)},f.prototype.filter=function(l){return l(this._value)?new f(this._value):new u},f.prototype.and=function(l){return l},f.prototype.andThen=function(l){return l(this._value)},f.prototype.or=function(l){return new f(this._value)},f.prototype.orElse=function(l){return new f(this._value)},f.prototype.xor=function(l){var m=this;return l.mapOrElse(function(){return new f(m._value)},function(){return new u})},f.prototype.zip=function(l){var m=this;return l.andThen(function(b){return new f([m._value,b])})},f.prototype.okOr=function(l){return new o.Ok(this._value)},f.prototype.okOrElse=function(l){return new o.Ok(this._value)},f.prototype.unwrap=function(){return this._value},f.prototype.unwrapNullable=function(){return this._value},f.prototype.unwrapOr=function(l){return this._value},f.prototype.unwrapOrElse=function(l){return this._value},f.prototype.async=function(){return new c(this._value)},f})(s);D.Some=a;var c=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.map=function(l){return t(this,void 0,void 0,function(){var m;return n(this,function(b){switch(b.label){case 0:return m=a.bind,[4,l(this._value)];case 1:return[2,new(m.apply(a,[void 0,b.sent()]))]}})})},f.prototype.mapNullable=function(l){return t(this,void 0,void 0,function(){var m;return n(this,function(b){switch(b.label){case 0:return m=h,[4,l(this._value)];case 1:return[2,m.apply(void 0,[b.sent()])]}})})},f.prototype.filter=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){switch(m.label){case 0:return[4,l(this._value)];case 1:return[2,m.sent()?new a(this._value):new u]}})})},f.prototype.andThen=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,l(this._value)]})})},f.prototype.unwrapOrElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,this._value]})})},f.prototype.orElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new a(this._value)]})})},f.prototype.okOrElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new o.Ok(this._value)]})})},f})(s);D.AsyncSome=c;var u=(function(){function d(){}return d.prototype.isSome=function(){return!1},d.prototype.isNone=function(){return!0},d.prototype.map=function(f){return new d},d.prototype.mapNullable=function(f){return new d},d.prototype.mapOr=function(f,l){return new a(f)},d.prototype.mapOrElse=function(f,l){return f()},d.prototype.filter=function(f){return new d},d.prototype.and=function(f){return new d},d.prototype.andThen=function(f){return new d},d.prototype.or=function(f){return f},d.prototype.orElse=function(f){return f()},d.prototype.xor=function(f){return f},d.prototype.zip=function(f){return new d},d.prototype.okOr=function(f){return new o.Err(f)},d.prototype.okOrElse=function(f){return new o.Err(f())},d.prototype.unwrap=function(){throw new Error("Unwrapped a None")},d.prototype.unwrapNullable=function(){return null},d.prototype.unwrapOr=function(f){return f},d.prototype.unwrapOrElse=function(f){return f()},d.prototype.async=function(){return new p},d})();D.None=u;var p=(function(){function d(){}return d.prototype.map=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,new u]})})},d.prototype.mapNullable=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,new u]})})},d.prototype.filter=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,new u]})})},d.prototype.andThen=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,new u]})})},d.prototype.orElse=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,f()]})})},d.prototype.okOrElse=function(f){return t(this,void 0,void 0,function(){var l;return n(this,function(m){switch(m.label){case 0:return l=o.Err.bind,[4,f()];case 1:return[2,new(l.apply(o.Err,[void 0,m.sent()]))]}})})},d.prototype.unwrapOrElse=function(f){return t(this,void 0,void 0,function(){return n(this,function(l){return[2,f()]})})},d})();D.AsyncNone=p;function h(d){return d==null?new u:new a(d)}D.optionify=h;function y(d){for(var f=[],l=1;l<arguments.length;l++)f[l-1]=arguments[l];return f.reduce(function(m,b){return m.andThen(function(v){return b.map(function(w){return i(v,[w])})})},d.map(function(m){return[m]}))}D.join=y;function g(d,f){return d.andThen(function(l){return f.map(function(m){return[l,m]})})}return D.zip2=g,D}var jn;function Vr(){if(jn)return M;jn=1;var e=M&&M.__extends||(function(){var d=function(f,l){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(m[v]=b[v])},d(f,l)};return function(f,l){d(f,l);function m(){this.constructor=f}f.prototype=l===null?Object.create(l):(m.prototype=l.prototype,new m)}})(),t=M&&M.__awaiter||function(d,f,l,m){function b(v){return v instanceof l?v:new l(function(w){w(v)})}return new(l||(l=Promise))(function(v,w){function I(E){try{_(m.next(E))}catch(A){w(A)}}function O(E){try{_(m.throw(E))}catch(A){w(A)}}function _(E){E.done?v(E.value):b(E.value).then(I,O)}_((m=m.apply(d,f||[])).next())})},n=M&&M.__generator||function(d,f){var l={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},m,b,v,w;return w={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function I(_){return function(E){return O([_,E])}}function O(_){if(m)throw new TypeError("Generator is already executing.");for(;l;)try{if(m=1,b&&(v=_[0]&2?b.return:_[0]?b.throw||((v=b.return)&&v.call(b),0):b.next)&&!(v=v.call(b,_[1])).done)return v;switch(b=0,v&&(_=[_[0]&2,v.value]),_[0]){case 0:case 1:v=_;break;case 4:return l.label++,{value:_[1],done:!1};case 5:l.label++,b=_[1],_=[0];continue;case 7:_=l.ops.pop(),l.trys.pop();continue;default:if(v=l.trys,!(v=v.length>0&&v[v.length-1])&&(_[0]===6||_[0]===2)){l=0;continue}if(_[0]===3&&(!v||_[1]>v[0]&&_[1]<v[3])){l.label=_[1];break}if(_[0]===6&&l.label<v[1]){l.label=v[1],v=_;break}if(v&&l.label<v[2]){l.label=v[2],l.ops.push(_);break}v[2]&&l.ops.pop(),l.trys.pop();continue}_=f.call(d,l)}catch(E){_=[6,E],b=0}finally{m=v=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},r=M&&M.__read||function(d,f){var l=typeof Symbol=="function"&&d[Symbol.iterator];if(!l)return d;var m=l.call(d),b,v=[],w;try{for(;(f===void 0||f-- >0)&&!(b=m.next()).done;)v.push(b.value)}catch(I){w={error:I}}finally{try{b&&!b.done&&(l=m.return)&&l.call(m)}finally{if(w)throw w.error}}return v},i=M&&M.__spread||function(){for(var d=[],f=0;f<arguments.length;f++)d=d.concat(r(arguments[f]));return d};Object.defineProperty(M,"__esModule",{value:!0}),M.asResult=M.resultify=M.AsyncErr=M.Err=M.AsyncOk=M.Ok=void 0;var o=Fr(),s=(function(){function d(f){this._value=f}return d})(),a=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.isOk=function(){return!0},f.prototype.isErr=function(){return!1},f.prototype.map=function(l){return new f(l(this._value))},f.prototype.mapErr=function(l){return new f(this._value)},f.prototype.mapOr=function(l,m){return m(this._value)},f.prototype.mapOrElse=function(l,m){return m(this._value)},f.prototype.and=function(l){return l},f.prototype.andThen=function(l){return l(this._value)},f.prototype.or=function(l){return new f(this._value)},f.prototype.orElse=function(l){return new f(this._value)},f.prototype.ok=function(){return new o.Some(this._value)},f.prototype.unwrap=function(){return this._value},f.prototype.unwrapErr=function(){throw new Error("unwrapErr on an Ok()")},f.prototype.unwrapOr=function(l){return this._value},f.prototype.unwrapOrElse=function(l){return this._value},f.prototype.async=function(){return new c(this._value)},f})(s);M.Ok=a;var c=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.map=function(l){return t(this,void 0,void 0,function(){var m;return n(this,function(b){switch(b.label){case 0:return m=a.bind,[4,l(this._value)];case 1:return[2,new(m.apply(a,[void 0,b.sent()]))]}})})},f.prototype.mapErr=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new a(this._value)]})})},f.prototype.mapOr=function(l,m){return t(this,void 0,void 0,function(){return n(this,function(b){return[2,m(this._value)]})})},f.prototype.mapOrElse=function(l,m){return t(this,void 0,void 0,function(){return n(this,function(b){return[2,m(this._value)]})})},f.prototype.andThen=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,l(this._value)]})})},f.prototype.orElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new a(this._value)]})})},f.prototype.unwrapOrElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,this._value]})})},f})(s);M.AsyncOk=c;var u=(function(){function d(f){this._error=f}return d})(),p=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.isOk=function(){return!1},f.prototype.isErr=function(){return!0},f.prototype.map=function(l){return new f(this._error)},f.prototype.mapErr=function(l){return new f(l(this._error))},f.prototype.mapOr=function(l,m){return l},f.prototype.mapOrElse=function(l,m){return l(this._error)},f.prototype.and=function(l){return new f(this._error)},f.prototype.andThen=function(l){return new f(this._error)},f.prototype.or=function(l){return l},f.prototype.orElse=function(l){return l(this._error)},f.prototype.ok=function(){return new o.None},f.prototype.unwrap=function(){throw this._error},f.prototype.unwrapErr=function(){return this._error},f.prototype.unwrapOr=function(l){return l},f.prototype.unwrapOrElse=function(l){return l(this._error)},f.prototype.async=function(){return new h(this._error)},f})(u);M.Err=p;var h=(function(d){e(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.prototype.map=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new p(this._error)]})})},f.prototype.mapErr=function(l){return t(this,void 0,void 0,function(){var m;return n(this,function(b){switch(b.label){case 0:return m=p.bind,[4,l(this._error)];case 1:return[2,new(m.apply(p,[void 0,b.sent()]))]}})})},f.prototype.mapOr=function(l,m){return t(this,void 0,void 0,function(){return n(this,function(b){return[2,l]})})},f.prototype.mapOrElse=function(l,m){return t(this,void 0,void 0,function(){return n(this,function(b){return[2,l(this._error)]})})},f.prototype.andThen=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,new p(this._error)]})})},f.prototype.orElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,l(this._error)]})})},f.prototype.unwrapOrElse=function(l){return t(this,void 0,void 0,function(){return n(this,function(m){return[2,l(this._error)]})})},f})(u);M.AsyncErr=h;function y(d){return t(this,void 0,void 0,function(){return n(this,function(f){return[2,d.then(function(l){return new a(l)},function(l){return new p(l)})]})})}M.resultify=y;function g(d){for(var f=[],l=1;l<arguments.length;l++)f[l-1]=arguments[l];try{return new a(d.apply(void 0,i(f)))}catch(m){return new p(m)}}return M.asResult=g,M}var Bn;function ao(){return Bn||(Bn=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.zip2=e.optionify=e.join=e.resultify=void 0;var t=Vr();Object.defineProperty(e,"resultify",{enumerable:!0,get:function(){return t.resultify}});var n=Fr();Object.defineProperty(e,"join",{enumerable:!0,get:function(){return n.join}}),Object.defineProperty(e,"optionify",{enumerable:!0,get:function(){return n.optionify}}),Object.defineProperty(e,"zip2",{enumerable:!0,get:function(){return n.zip2}})})(zt)),zt}var dn=ao();const $r={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"},co={dutch:/[^A-Za-zàèéìòóù0-9_'-]+/gim,english:/[^A-Za-zàèéìòóù0-9_'-]+/gim,french:/[^a-z0-9äâàéèëêïîöôùüûœç-]+/gim,italian:/[^A-Za-zàèéìòóù0-9_'-]+/gim,norwegian:/[^a-z0-9_æøåÆØÅäÄöÖüÜ]+/gim,portuguese:/[^a-z0-9à-úÀ-Ú]/gim,russian:/[^a-z0-9а-яА-ЯёЁ]+/gim,spanish:/[^a-z0-9A-Zá-úÁ-ÚñÑüÜ]+/gim,swedish:/[^a-z0-9_åÅäÄöÖüÜ-]+/gim,german:/[^a-z0-9A-ZäöüÄÖÜß]+/gim,finnish:/[^a-z0-9äöÄÖ]+/gim,danish:/[^a-z0-9æøåÆØÅ]+/gim,hungarian:/[^a-z0-9áéíóöőúüűÁÉÍÓÖŐÚÜŰ]+/gim,romanian:/[^a-z0-9ăâîșțĂÂÎȘȚ]+/gim,serbian:/[^a-z0-9čćžšđČĆŽŠĐ]+/gim,turkish:/[^a-z0-9çÇğĞıİöÖşŞüÜ]+/gim,lithuanian:/[^a-z0-9ąčęėįšųūžĄČĘĖĮŠŲŪŽ]+/gim,arabic:/[^a-z0-9أ-ي]+/gim,nepali:/[^a-z0-9अ-ह]+/gim,irish:/[^a-z0-9áéíóúÁÉÍÓÚ]+/gim,indian:/[^a-z0-9अ-ह]+/gim,armenian:/[^a-z0-9ա-ֆ]+/gim,greek:/[^a-z0-9α-ωά-ώ]+/gim,indonesian:/[^a-z0-9]+/gim,ukrainian:/[^a-z0-9а-яА-ЯіїєІЇЄ]+/gim,slovenian:/[^a-z0-9čžšČŽŠ]+/gim,bulgarian:/[^a-z0-9а-яА-Я]+/gim,tamil:/[^a-z0-9அ-ஹ]+/gim,sanskrit:/[^a-z0-9A-Zāīūṛḷṃṁḥśṣṭḍṇṅñḻḹṝ]+/gim,czech:/[^A-Z0-9a-zěščřžýáíéúůóťďĚŠČŘŽÝÁÍÉÓÚŮŤĎ-]+/gim},hn=Object.keys($r);function uo(e){return e!==void 0&&hn.includes(e)?$r[e]:void 0}const lo=Date.now().toString().slice(5);let fo=0;const Wn=BigInt(1e3),qn=BigInt(1e6),Gn=BigInt(1e9),Ut=65535;function jr(e,t){if(t.length<Ut)Array.prototype.push.apply(e,t);else{const n=t.length;for(let r=0;r<n;r+=Ut)Array.prototype.push.apply(e,t.slice(r,r+Ut))}}function ho(e,...t){return e.replace(/%(?:(?<position>\d+)\$)?(?<width>-?\d*\.?\d*)(?<type>[dfs])/g,function(...n){const r=n[n.length-1],{width:i,type:o,position:s}=r,a=s?t[Number.parseInt(s)-1]:t.shift(),c=i===""?0:Number.parseInt(i);switch(o){case"d":return a.toString().padStart(c,"0");case"f":{let u=a;const[p,h]=i.split(".").map(y=>Number.parseFloat(y));return typeof h=="number"&&h>=0&&(u=u.toFixed(h)),typeof p=="number"&&p>=0?u.toString().padStart(c,"0"):u.toString()}case"s":return c<0?a.toString().padEnd(-c," "):a.toString().padStart(c," ");default:return a}})}function po(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function yo(){return typeof process<"u"&&process.release&&process.release.name==="node"}function Hn(){return BigInt(Math.floor(performance.now()*1e6))}function pn(e){return typeof e=="number"&&(e=BigInt(e)),e<Wn?`${e}ns`:e<qn?`${e/Wn}μs`:e<Gn?`${e/qn}ms`:`${e/Gn}s`}function xe(){return po()?Hn():yo()||typeof process<"u"&&typeof process?.hrtime?.bigint=="function"?process.hrtime.bigint():typeof performance<"u"?Hn():BigInt(0)}function Br(){return`${lo}-${fo++}`}function Ft(e,t){return Object.hasOwn===void 0?Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0:Object.hasOwn(e,t)?e[t]:void 0}function Wr(e,t){return t[1]===e[1]?e[0]-t[0]:t[1]-e[1]}function mo(e){if(e.length===0)return[];if(e.length===1)return e[0];for(let n=1;n<e.length;n++)if(e[n].length<e[0].length){const r=e[0];e[0]=e[n],e[n]=r}const t=new Map;for(const n of e[0])t.set(n,1);for(let n=1;n<e.length;n++){let r=0;for(const i of e[n]){const o=t.get(i);o===n&&(t.set(i,o+1),r++)}if(r===0)return[]}return e[0].filter(n=>{const r=t.get(n);return r!==void 0&&t.set(n,0),r===e.length})}function qr(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const o=t[i],s=o.split(".");let a=e;const c=s.length;for(let u=0;u<c;u++)if(a=a[s[u]],typeof a=="object"){if(a!==null&&"lat"in a&&"lon"in a&&typeof a.lat=="number"&&typeof a.lon=="number"){a=n[o]=a;break}else if(!Array.isArray(a)&&a!==null&&u===c-1){a=void 0;break}}else if((a===null||typeof a!="object")&&u<c-1){a=void 0;break}typeof a<"u"&&(n[o]=a)}return n}function yn(e,t){return qr(e,[t])[t]}const go={cm:.01,m:1,km:1e3,ft:.3048,yd:.9144,mi:1609.344};function Gr(e,t){const n=go[t];if(n===void 0)throw new Error(N("INVALID_DISTANCE_SUFFIX",e).message);return e*n}function Hr(e,t){e.hits=e.hits.map(n=>({...n,document:{...n.document,...t.reduce((r,i)=>{const o=i.split("."),s=o.pop();let a=r;for(const c of o)a[c]=a[c]??{},a=a[c];return a[s]=null,r},n.document)}}))}function V(e){return Array.isArray(e)?e.some(t=>V(t)):e?.constructor?.name==="AsyncFunction"}const Kn="intersection"in new Set;function ht(...e){if(e.length===0)return new Set;if(e.length===1)return e[0];if(e.length===2){const r=e[0],i=e[1];if(Kn)return r.intersection(i);const o=new Set,s=r.size<i.size?r:i,a=s===r?i:r;for(const c of s)a.has(c)&&o.add(c);return o}const t={index:0,size:e[0].size};for(let r=1;r<e.length;r++)e[r].size<t.size&&(t.index=r,t.size=e[r].size);if(Kn){let r=e[t.index];for(let i=0;i<e.length;i++)i!==t.index&&(r=r.intersection(e[i]));return r}const n=e[t.index];for(let r=0;r<e.length;r++){if(r===t.index)continue;const i=e[r];for(const o of n)i.has(o)||n.delete(o)}return n}const vo="union"in new Set;function at(e,t){return vo?e?e.union(t):t:e?new Set([...e,...t]):new Set(t)}function bo(e,t){const n=new Set;for(const r of e)t.has(r)||n.add(r);return n}function Kr(e){if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){const t=new Int32Array(new SharedArrayBuffer(4));if((e>0&&e<1/0)===!1)throw typeof e!="number"&&typeof e!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(t,0,0,Number(e))}else if((e>0&&e<1/0)===!1)throw typeof e!="number"&&typeof e!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}const wo=hn.join(`
 - `),_o={NO_LANGUAGE_WITH_CUSTOM_TOKENIZER:"Do not pass the language option to create when using a custom tokenizer.",LANGUAGE_NOT_SUPPORTED:`Language "%s" is not supported.
Supported languages are:
 - ${wo}`,INVALID_STEMMER_FUNCTION_TYPE:"config.stemmer property must be a function.",MISSING_STEMMER:'As of version 1.0.0 @orama/orama does not ship non English stemmers by default. To solve this, please explicitly import and specify the "%s" stemmer from the package @orama/stemmers. See https://docs.orama.com/docs/orama-js/text-analysis/stemming for more information.',CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY:"Custom stop words array must only contain strings.",UNSUPPORTED_COMPONENT:'Unsupported component "%s".',COMPONENT_MUST_BE_FUNCTION:'The component "%s" must be a function.',COMPONENT_MUST_BE_FUNCTION_OR_ARRAY_FUNCTIONS:'The component "%s" must be a function or an array of functions.',INVALID_SCHEMA_TYPE:'Unsupported schema type "%s" at "%s". Expected "string", "boolean" or "number" or array of them.',DOCUMENT_ID_MUST_BE_STRING:'Document id must be of type "string". Got "%s" instead.',DOCUMENT_ALREADY_EXISTS:'A document with id "%s" already exists.',DOCUMENT_DOES_NOT_EXIST:'A document with id "%s" does not exists.',MISSING_DOCUMENT_PROPERTY:'Missing searchable property "%s".',INVALID_DOCUMENT_PROPERTY:'Invalid document property "%s": expected "%s", got "%s"',UNKNOWN_INDEX:'Invalid property name "%s". Expected a wildcard string ("*") or array containing one of the following properties: %s',INVALID_BOOST_VALUE:"Boost value must be a number greater than, or less than 0.",INVALID_FILTER_OPERATION:"You can only use one operation per filter, you requested %d.",SCHEMA_VALIDATION_FAILURE:'Cannot insert document due schema validation failure on "%s" property.',INVALID_SORT_SCHEMA_TYPE:'Unsupported sort schema type "%s" at "%s". Expected "string" or "number".',CANNOT_SORT_BY_ARRAY:'Cannot configure sort for "%s" because it is an array (%s).',UNABLE_TO_SORT_ON_UNKNOWN_FIELD:'Unable to sort on unknown field "%s". Allowed fields: %s',SORT_DISABLED:"Sort is disabled. Please read the documentation at https://docs.orama.com/docs/orama-js for more information.",UNKNOWN_GROUP_BY_PROPERTY:'Unknown groupBy property "%s".',INVALID_GROUP_BY_PROPERTY:'Invalid groupBy property "%s". Allowed types: "%s", but given "%s".',UNKNOWN_FILTER_PROPERTY:'Unknown filter property "%s".',UNKNOWN_VECTOR_PROPERTY:'Unknown vector property "%s". Make sure the property exists in the schema and is configured as a vector.',INVALID_VECTOR_SIZE:'Vector size must be a number greater than 0. Got "%s" instead.',INVALID_VECTOR_VALUE:'Vector value must be a number greater than 0. Got "%s" instead.',INVALID_INPUT_VECTOR:`Property "%s" was declared as a %s-dimensional vector, but got a %s-dimensional vector instead.
Input vectors must be of the size declared in the schema, as calculating similarity between vectors of different sizes can lead to unexpected results.`,WRONG_SEARCH_PROPERTY_TYPE:'Property "%s" is not searchable. Only "string" properties are searchable.',FACET_NOT_SUPPORTED:`Facet doens't support the type "%s".`,INVALID_DISTANCE_SUFFIX:'Invalid distance suffix "%s". Valid suffixes are: cm, m, km, mi, yd, ft.',INVALID_SEARCH_MODE:'Invalid search mode "%s". Valid modes are: "fulltext", "vector", "hybrid".',MISSING_VECTOR_AND_SECURE_PROXY:"No vector was provided and no secure proxy was configured. Please provide a vector or configure an Orama Secure Proxy to perform hybrid search.",MISSING_TERM:'"term" is a required parameter when performing hybrid search. Please provide a search term.',INVALID_VECTOR_INPUT:'Invalid "vector" property. Expected an object with "value" and "property" properties, but got "%s" instead.',PLUGIN_CRASHED:"A plugin crashed during initialization. Please check the error message for more information:",PLUGIN_SECURE_PROXY_NOT_FOUND:`Could not find '@orama/secure-proxy-plugin' installed in your Orama instance.
Please install it before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,PLUGIN_SECURE_PROXY_MISSING_CHAT_MODEL:`Could not find a chat model defined in the secure proxy plugin configuration.
Please provide a chat model before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,ANSWER_SESSION_LAST_MESSAGE_IS_NOT_ASSISTANT:"The last message in the session is not an assistant message. Cannot regenerate non-assistant messages.",PLUGIN_COMPONENT_CONFLICT:'The component "%s" is already defined. The plugin "%s" is trying to redefine it.'};function N(e,...t){const n=new Error(ho(_o[e]??`Unsupported Orama Error code: ${e}`,...t));return n.code=e,"captureStackTrace"in Error.prototype&&Error.captureStackTrace(n),n}function So(e){return{raw:Number(e),formatted:pn(e)}}function Io(e){if(e.id){if(typeof e.id!="string")throw N("DOCUMENT_ID_MUST_BE_STRING",typeof e.id);return e.id}return Br()}function Yr(e,t){for(const[n,r]of Object.entries(t)){const i=e[n];if(!(typeof i>"u")&&!(r==="geopoint"&&typeof i=="object"&&typeof i.lon=="number"&&typeof i.lat=="number")&&!(r==="enum"&&(typeof i=="string"||typeof i=="number"))){if(r==="enum[]"&&Array.isArray(i)){const o=i.length;for(let s=0;s<o;s++)if(typeof i[s]!="string"&&typeof i[s]!="number")return n+"."+s;continue}if(_e(r)){const o=mn(r);if(!Array.isArray(i)||i.length!==o)throw N("INVALID_INPUT_VECTOR",n,o,i.length);continue}if(Ot(r)){if(!Array.isArray(i))return n;const o=Jr(r),s=i.length;for(let a=0;a<s;a++)if(typeof i[a]!==o)return n+"."+a;continue}if(typeof r=="object"){if(!i||typeof i!="object")return n;const o=Yr(i,r);if(o)return n+"."+o;continue}if(typeof i!==r)return n}}}const Eo={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},Oo={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function To(e){return e==="geopoint"}function _e(e){return typeof e=="string"&&/^vector\[\d+\]$/.test(e)}function Ot(e){return typeof e=="string"&&Eo[e]}function Jr(e){return Oo[e]}function mn(e){const t=Number(e.slice(7,-1));switch(!0){case isNaN(t):throw N("INVALID_VECTOR_VALUE",e);case t<=0:throw N("INVALID_VECTOR_SIZE",e);default:return t}}function Ao(){return{idToInternalId:new Map,internalIdToId:[],save:Ro,load:xo}}function Ro(e){return{internalIdToId:e.internalIdToId}}function xo(e,t){const{internalIdToId:n}=t;e.internalDocumentIDStore.idToInternalId.clear(),e.internalDocumentIDStore.internalIdToId=[];const r=n.length;for(let i=0;i<r;i++){const o=n[i];e.internalDocumentIDStore.idToInternalId.set(o,i+1),e.internalDocumentIDStore.internalIdToId.push(o)}}function $(e,t){if(typeof t=="string"){const n=e.idToInternalId.get(t);if(n)return n;const r=e.idToInternalId.size+1;return e.idToInternalId.set(t,r),e.internalIdToId.push(t),r}return t>e.internalIdToId.length?$(e,t.toString()):t}function Tt(e,t){if(e.internalIdToId.length<t)throw new Error(`Invalid internalId ${t}`);return e.internalIdToId[t-1]}function Po(e,t){return{sharedInternalDocumentStore:t,docs:{},count:0}}function ko(e,t){const n=$(e.sharedInternalDocumentStore,t);return e.docs[n]}function No(e,t){const n=t.length,r=Array.from({length:n});for(let i=0;i<n;i++){const o=$(e.sharedInternalDocumentStore,t[i]);r[i]=e.docs[o]}return r}function Do(e){return e.docs}function Mo(e,t,n,r){return typeof e.docs[n]<"u"?!1:(e.docs[n]=r,e.count++,!0)}function Lo(e,t){const n=$(e.sharedInternalDocumentStore,t);return typeof e.docs[n]>"u"?!1:(delete e.docs[n],e.count--,!0)}function Co(e){return e.count}function zo(e,t){const n=t;return{docs:n.docs,count:n.count,sharedInternalDocumentStore:e}}function Uo(e){return{docs:e.docs,count:e.count}}function Fo(){return{create:Po,get:ko,getMultiple:No,getAll:Do,store:Mo,remove:Lo,count:Co,load:zo,save:Uo}}const Vo=["beforeInsert","afterInsert","beforeRemove","afterRemove","beforeUpdate","afterUpdate","beforeUpsert","afterUpsert","beforeSearch","afterSearch","beforeInsertMultiple","afterInsertMultiple","beforeRemoveMultiple","afterRemoveMultiple","beforeUpdateMultiple","afterUpdateMultiple","beforeUpsertMultiple","afterUpsertMultiple","beforeLoad","afterLoad","afterCreate"];function $o(e,t){const n=[],r=e.plugins?.length;if(!r)return n;for(let i=0;i<r;i++)try{const o=e.plugins[i];typeof o[t]=="function"&&n.push(o[t])}catch(o){throw console.error("Caught error in getAllPluginsByHook:",o),N("PLUGIN_CRASHED")}return n}const jo=["tokenizer","index","documentsStore","sorter","pinning"],Yn=["validateSchema","getDocumentIndexId","getDocumentProperties","formatElapsedTime"];function pt(e,t,n,r){if(e.some(V))return(async()=>{for(const o of e)await o(t,n,r)})();for(const o of e)o(t,n,r)}function Qr(e,t,n){if(e.some(V))return(async()=>{for(const i of e)await i(t,n)})();for(const i of e)i(t,n)}function gn(e,t,n,r,i){if(e.some(V))return(async()=>{for(const s of e)await s(t,n,r,i)})();for(const s of e)s(t,n,r,i)}function vn(e,t,n,r){if(e.some(V))return(async()=>{for(const o of e)await o(t,n,r)})();for(const o of e)o(t,n,r)}function Bo(e,t){if(e.some(V))return(async()=>{for(const r of e)await r(t)})();for(const r of e)r(t)}class Y{k;v;l=null;r=null;h=1;constructor(t,n){this.k=t,this.v=new Set(n)}updateHeight(){this.h=Math.max(Y.getHeight(this.l),Y.getHeight(this.r))+1}static getHeight(t){return t?t.h:0}getBalanceFactor(){return Y.getHeight(this.l)-Y.getHeight(this.r)}rotateLeft(){const t=this.r;return this.r=t.l,t.l=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){const t=this.l;return this.l=t.r,t.r=this,this.updateHeight(),t.updateHeight(),t}toJSON(){return{k:this.k,v:Array.from(this.v),l:this.l?this.l.toJSON():null,r:this.r?this.r.toJSON():null,h:this.h}}static fromJSON(t){const n=new Y(t.k,t.v);return n.l=t.l?Y.fromJSON(t.l):null,n.r=t.r?Y.fromJSON(t.r):null,n.h=t.h,n}}class Xe{root=null;insertCount=0;constructor(t,n){t!==void 0&&n!==void 0&&(this.root=new Y(t,n))}insert(t,n,r=1e3){this.root=this.insertNode(this.root,t,n,r)}insertMultiple(t,n,r=1e3){for(const i of n)this.insert(t,i,r)}rebalance(){this.root&&(this.root=this.rebalanceNode(this.root))}toJSON(){return{root:this.root?this.root.toJSON():null,insertCount:this.insertCount}}static fromJSON(t){const n=new Xe;return n.root=t.root?Y.fromJSON(t.root):null,n.insertCount=t.insertCount||0,n}insertNode(t,n,r,i){if(t===null)return new Y(n,[r]);const o=[];let s=t,a=null;for(;s!==null;)if(o.push({parent:a,node:s}),n<s.k)if(s.l===null){s.l=new Y(n,[r]),o.push({parent:s,node:s.l});break}else a=s,s=s.l;else if(n>s.k)if(s.r===null){s.r=new Y(n,[r]),o.push({parent:s,node:s.r});break}else a=s,s=s.r;else return s.v.add(r),t;let c=!1;this.insertCount++%i===0&&(c=!0);for(let u=o.length-1;u>=0;u--){const{parent:p,node:h}=o[u];if(h.updateHeight(),c){const y=this.rebalanceNode(h);p?p.l===h?p.l=y:p.r===h&&(p.r=y):t=y}}return t}rebalanceNode(t){const n=t.getBalanceFactor();if(n>1){if(t.l&&t.l.getBalanceFactor()>=0)return t.rotateRight();if(t.l)return t.l=t.l.rotateLeft(),t.rotateRight()}if(n<-1){if(t.r&&t.r.getBalanceFactor()<=0)return t.rotateLeft();if(t.r)return t.r=t.r.rotateRight(),t.rotateLeft()}return t}find(t){const n=this.findNodeByKey(t);return n?n.v:null}contains(t){return this.find(t)!==null}getSize(){let t=0;const n=[];let r=this.root;for(;r||n.length>0;){for(;r;)n.push(r),r=r.l;r=n.pop(),t++,r=r.r}return t}isBalanced(){if(!this.root)return!0;const t=[this.root];for(;t.length>0;){const n=t.pop(),r=n.getBalanceFactor();if(Math.abs(r)>1)return!1;n.l&&t.push(n.l),n.r&&t.push(n.r)}return!0}remove(t){this.root=this.removeNode(this.root,t)}removeDocument(t,n){const r=this.findNodeByKey(t);r&&(r.v.size===1?this.root=this.removeNode(this.root,t):r.v=new Set([...r.v.values()].filter(i=>i!==n)))}findNodeByKey(t){let n=this.root;for(;n;)if(t<n.k)n=n.l;else if(t>n.k)n=n.r;else return n;return null}removeNode(t,n){if(t===null)return null;const r=[];let i=t;for(;i!==null&&i.k!==n;)r.push(i),n<i.k?i=i.l:i=i.r;if(i===null)return t;if(i.l===null||i.r===null){const o=i.l?i.l:i.r;if(r.length===0)t=o;else{const s=r[r.length-1];s.l===i?s.l=o:s.r=o}}else{let o=i,s=i.r;for(;s.l!==null;)o=s,s=s.l;i.k=s.k,i.v=s.v,o.l===s?o.l=s.r:o.r=s.r,i=o}r.push(i);for(let o=r.length-1;o>=0;o--){const s=r[o];s.updateHeight();const a=this.rebalanceNode(s);if(o>0){const c=r[o-1];c.l===s?c.l=a:c.r===s&&(c.r=a)}else t=a}return t}rangeSearch(t,n){const r=new Set,i=[];let o=this.root;for(;o||i.length>0;){for(;o;)i.push(o),o=o.l;if(o=i.pop(),o.k>=t&&o.k<=n)for(const s of o.v)r.add(s);if(o.k>n)break;o=o.r}return r}greaterThan(t,n=!1){const r=new Set,i=[];let o=this.root;for(;o||i.length>0;){for(;o;)i.push(o),o=o.r;if(o=i.pop(),n&&o.k>=t||!n&&o.k>t)for(const s of o.v)r.add(s);else if(o.k<=t)break;o=o.l}return r}lessThan(t,n=!1){const r=new Set,i=[];let o=this.root;for(;o||i.length>0;){for(;o;)i.push(o),o=o.l;if(o=i.pop(),n&&o.k<=t||!n&&o.k<t)for(const s of o.v)r.add(s);else if(o.k>t)break;o=o.r}return r}}class Ze{numberToDocumentId;constructor(){this.numberToDocumentId=new Map}insert(t,n){this.numberToDocumentId.has(t)?this.numberToDocumentId.get(t).add(n):this.numberToDocumentId.set(t,new Set([n]))}find(t){const n=this.numberToDocumentId.get(t);return n?Array.from(n):null}remove(t){this.numberToDocumentId.delete(t)}removeDocument(t,n){const r=this.numberToDocumentId.get(n);r&&(r.delete(t),r.size===0&&this.numberToDocumentId.delete(n))}contains(t){return this.numberToDocumentId.has(t)}getSize(){let t=0;for(const n of this.numberToDocumentId.values())t+=n.size;return t}filter(t){const n=Object.keys(t);if(n.length!==1)throw new Error("Invalid operation");const r=n[0];switch(r){case"eq":{const i=t[r],o=this.numberToDocumentId.get(i);return o?Array.from(o):[]}case"in":{const i=t[r],o=new Set;for(const s of i){const a=this.numberToDocumentId.get(s);if(a)for(const c of a)o.add(c)}return Array.from(o)}case"nin":{const i=new Set(t[r]),o=new Set;for(const[s,a]of this.numberToDocumentId.entries())if(!i.has(s))for(const c of a)o.add(c);return Array.from(o)}default:throw new Error("Invalid operation")}}filterArr(t){const n=Object.keys(t);if(n.length!==1)throw new Error("Invalid operation");const r=n[0];switch(r){case"containsAll":{const o=t[r].map(a=>this.numberToDocumentId.get(a)??new Set);if(o.length===0)return[];const s=o.reduce((a,c)=>new Set([...a].filter(u=>c.has(u))));return Array.from(s)}case"containsAny":{const o=t[r].map(a=>this.numberToDocumentId.get(a)??new Set);if(o.length===0)return[];const s=o.reduce((a,c)=>new Set([...a,...c]));return Array.from(s)}default:throw new Error("Invalid operation")}}static fromJSON(t){if(!t.numberToDocumentId)throw new Error("Invalid Flat Tree JSON");const n=new Ze;for(const[r,i]of t.numberToDocumentId)n.numberToDocumentId.set(r,new Set(i));return n}toJSON(){return{numberToDocumentId:Array.from(this.numberToDocumentId.entries()).map(([t,n])=>[t,Array.from(n)])}}}function Wo(e,t,n){if(n<0)return-1;if(e===t)return 0;const r=e.length,i=t.length;if(r===0)return i<=n?i:-1;if(i===0)return r<=n?r:-1;const o=Math.abs(r-i);if(e.startsWith(t))return o<=n?o:-1;if(t.startsWith(e))return 0;if(o>n)return-1;const s=[];for(let a=0;a<=r;a++){s[a]=[a];for(let c=1;c<=i;c++)s[a][c]=a===0?c:0}for(let a=1;a<=r;a++){let c=1/0;for(let u=1;u<=i;u++)e[a-1]===t[u-1]?s[a][u]=s[a-1][u-1]:s[a][u]=Math.min(s[a-1][u]+1,s[a][u-1]+1,s[a-1][u-1]+1),c=Math.min(c,s[a][u]);if(c>n)return-1}return s[r][i]<=n?s[r][i]:-1}function Jn(e,t,n){const r=Wo(e,t,n);return{distance:r,isBounded:r>=0}}class oe{k;s;c=new Map;d=new Set;e;w="";constructor(t,n,r){this.k=t,this.s=n,this.e=r}updateParent(t){this.w=t.w+this.s}addDocument(t){this.d.add(t)}removeDocument(t){return this.d.delete(t)}findAllWords(t,n,r,i){const o=[this];for(;o.length>0;){const s=o.pop();if(s.e){const{w:a,d:c}=s;if(r&&a!==n)continue;if(Ft(t,a)!==null)if(i)if(Math.abs(n.length-a.length)<=i&&Jn(n,a,i).isBounded)t[a]=[];else continue;else t[a]=[];if(Ft(t,a)!=null&&c.size>0){const u=t[a];for(const p of c)u.includes(p)||u.push(p)}}s.c.size>0&&o.push(...s.c.values())}return t}insert(t,n){let r=this,i=0;const o=t.length;for(;i<o;){const s=t[i],a=r.c.get(s);if(a){const c=a.s,u=c.length;let p=0;for(;p<u&&i+p<o&&c[p]===t[i+p];)p++;if(p===u){if(r=a,i+=p,i===o){a.e||(a.e=!0),a.addDocument(n);return}continue}const h=c.slice(0,p),y=c.slice(p),g=t.slice(i+p),d=new oe(h[0],h,!1);if(r.c.set(h[0],d),d.updateParent(r),a.s=y,a.k=y[0],d.c.set(y[0],a),a.updateParent(d),g){const f=new oe(g[0],g,!0);f.addDocument(n),d.c.set(g[0],f),f.updateParent(d)}else d.e=!0,d.addDocument(n);return}else{const c=new oe(s,t.slice(i),!0);c.addDocument(n),r.c.set(s,c),c.updateParent(r);return}}r.e||(r.e=!0),r.addDocument(n)}_findLevenshtein(t,n,r,i,o){const s=[{node:this,index:n,tolerance:r}];for(;s.length>0;){const{node:a,index:c,tolerance:u}=s.pop();if(a.w.startsWith(t)){a.findAllWords(o,t,!1,0);continue}if(u<0)continue;if(a.e){const{w:h,d:y}=a;if(h&&(Jn(t,h,i).isBounded&&(o[h]=[]),Ft(o,h)!==void 0&&y.size>0)){const g=new Set(o[h]);for(const d of y)g.add(d);o[h]=Array.from(g)}}if(c>=t.length)continue;const p=t[c];if(a.c.has(p)){const h=a.c.get(p);s.push({node:h,index:c+1,tolerance:u})}s.push({node:a,index:c+1,tolerance:u-1});for(const[h,y]of a.c)s.push({node:y,index:c,tolerance:u-1}),h!==p&&s.push({node:y,index:c+1,tolerance:u-1})}}find(t){const{term:n,exact:r,tolerance:i}=t;if(i&&!r){const o={};return this._findLevenshtein(n,0,i,i,o),o}else{let o=this,s=0;const a=n.length;for(;s<a;){const u=n[s],p=o.c.get(u);if(p){const h=p.s,y=h.length;let g=0;for(;g<y&&s+g<a&&h[g]===n[s+g];)g++;if(g===y)o=p,s+=g;else if(s+g===a)if(g===a-s){if(r)return{};{const d={};return p.findAllWords(d,n,r,i),d}}else return{};else return{}}else return{}}const c={};return o.findAllWords(c,n,r,i),c}}contains(t){let n=this,r=0;const i=t.length;for(;r<i;){const o=t[r],s=n.c.get(o);if(s){const a=s.s,c=a.length;let u=0;for(;u<c&&r+u<i&&a[u]===t[r+u];)u++;if(u<c)return!1;r+=c,n=s}else return!1}return!0}removeWord(t){if(!t)return!1;let n=this;const r=t.length,i=[];for(let o=0;o<r;o++){const s=t[o];if(n.c.has(s)){const a=n.c.get(s);i.push({parent:n,character:s}),o+=a.s.length-1,n=a}else return!1}for(n.d.clear(),n.e=!1;i.length>0&&n.c.size===0&&!n.e&&n.d.size===0;){const{parent:o,character:s}=i.pop();o.c.delete(s),n=o}return!0}removeDocumentByWord(t,n,r=!0){if(!t)return!0;let i=this;const o=t.length;for(let s=0;s<o;s++){const a=t[s];if(i.c.has(a)){const c=i.c.get(a);s+=c.s.length-1,i=c,r&&i.w!==t||i.removeDocument(n)}else return!1}return!0}static getCommonPrefix(t,n){const r=Math.min(t.length,n.length);let i=0;for(;i<r&&t.charCodeAt(i)===n.charCodeAt(i);)i++;return t.slice(0,i)}toJSON(){return{w:this.w,s:this.s,e:this.e,k:this.k,d:Array.from(this.d),c:Array.from(this.c?.entries())?.map(([t,n])=>[t,n.toJSON()])}}static fromJSON(t){const n=new oe(t.k,t.s,t.e);return n.w=t.w,n.d=new Set(t.d),n.c=new Map(t?.c?.map(([r,i])=>[r,oe.fromJSON(i)])||[]),n}}class et extends oe{constructor(){super("","",!1)}static fromJSON(t){const n=new et;return n.w=t.w,n.s=t.s,n.e=t.e,n.k=t.k,n.d=new Set(t.d),n.c=new Map(t?.c?.map(([r,i])=>[r,oe.fromJSON(i)])||[]),n}toJSON(){return super.toJSON()}}const qo=2,Go=6371e3;class Oe{point;docIDs;left;right;parent;constructor(t,n){this.point=t,this.docIDs=new Set(n),this.left=null,this.right=null,this.parent=null}toJSON(){return{point:this.point,docIDs:Array.from(this.docIDs),left:this.left?this.left.toJSON():null,right:this.right?this.right.toJSON():null}}static fromJSON(t,n=null){const r=new Oe(t.point,t.docIDs);return r.parent=n,t.left&&(r.left=Oe.fromJSON(t.left,r)),t.right&&(r.right=Oe.fromJSON(t.right,r)),r}}class q{root;nodeMap;constructor(){this.root=null,this.nodeMap=new Map}getPointKey(t){return`${t.lon},${t.lat}`}insert(t,n){const r=this.getPointKey(t),i=this.nodeMap.get(r);if(i){n.forEach(c=>i.docIDs.add(c));return}const o=new Oe(t,n);if(this.nodeMap.set(r,o),this.root==null){this.root=o;return}let s=this.root,a=0;for(;;){if(a%qo===0)if(t.lon<s.point.lon){if(s.left==null){s.left=o,o.parent=s;return}s=s.left}else{if(s.right==null){s.right=o,o.parent=s;return}s=s.right}else if(t.lat<s.point.lat){if(s.left==null){s.left=o,o.parent=s;return}s=s.left}else{if(s.right==null){s.right=o,o.parent=s;return}s=s.right}a++}}contains(t){const n=this.getPointKey(t);return this.nodeMap.has(n)}getDocIDsByCoordinates(t){const n=this.getPointKey(t),r=this.nodeMap.get(n);return r?Array.from(r.docIDs):null}removeDocByID(t,n){const r=this.getPointKey(t),i=this.nodeMap.get(r);i&&(i.docIDs.delete(n),i.docIDs.size===0&&(this.nodeMap.delete(r),this.deleteNode(i)))}deleteNode(t){const n=t.parent,r=t.left?t.left:t.right;r&&(r.parent=n),n?n.left===t?n.left=r:n.right===t&&(n.right=r):(this.root=r,this.root&&(this.root.parent=null))}searchByRadius(t,n,r=!0,i="asc",o=!1){const s=o?q.vincentyDistance:q.haversineDistance,a=[{node:this.root,depth:0}],c=[];for(;a.length>0;){const{node:u,depth:p}=a.pop();if(u==null)continue;const h=s(t,u.point);(r?h<=n:h>n)&&c.push({point:u.point,docIDs:Array.from(u.docIDs)}),u.left!=null&&a.push({node:u.left,depth:p+1}),u.right!=null&&a.push({node:u.right,depth:p+1})}return i&&c.sort((u,p)=>{const h=s(t,u.point),y=s(t,p.point);return i.toLowerCase()==="asc"?h-y:y-h}),c}searchByPolygon(t,n=!0,r=null,i=!1){const o=[{node:this.root,depth:0}],s=[];for(;o.length>0;){const{node:c,depth:u}=o.pop();if(c==null)continue;c.left!=null&&o.push({node:c.left,depth:u+1}),c.right!=null&&o.push({node:c.right,depth:u+1});const p=q.isPointInPolygon(t,c.point);(p&&n||!p&&!n)&&s.push({point:c.point,docIDs:Array.from(c.docIDs)})}const a=q.calculatePolygonCentroid(t);if(r){const c=i?q.vincentyDistance:q.haversineDistance;s.sort((u,p)=>{const h=c(a,u.point),y=c(a,p.point);return r.toLowerCase()==="asc"?h-y:y-h})}return s}toJSON(){return{root:this.root?this.root.toJSON():null}}static fromJSON(t){const n=new q;return t.root&&(n.root=Oe.fromJSON(t.root),n.buildNodeMap(n.root)),n}buildNodeMap(t){if(t==null)return;const n=this.getPointKey(t.point);this.nodeMap.set(n,t),t.left&&this.buildNodeMap(t.left),t.right&&this.buildNodeMap(t.right)}static calculatePolygonCentroid(t){let n=0,r=0,i=0;const o=t.length;for(let a=0,c=o-1;a<o;c=a++){const u=t[a].lon,p=t[a].lat,h=t[c].lon,y=t[c].lat,g=u*y-h*p;n+=g,r+=(u+h)*g,i+=(p+y)*g}n/=2;const s=6*n;return r/=s,i/=s,{lon:r,lat:i}}static isPointInPolygon(t,n){let r=!1;const i=n.lon,o=n.lat,s=t.length;for(let a=0,c=s-1;a<s;c=a++){const u=t[a].lon,p=t[a].lat,h=t[c].lon,y=t[c].lat;p>o!=y>o&&i<(h-u)*(o-p)/(y-p)+u&&(r=!r)}return r}static haversineDistance(t,n){const r=Math.PI/180,i=t.lat*r,o=n.lat*r,s=(n.lat-t.lat)*r,a=(n.lon-t.lon)*r,c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(i)*Math.cos(o)*Math.sin(a/2)*Math.sin(a/2),u=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return Go*u}static vincentyDistance(t,n){const i=.0033528106647474805,o=(1-i)*6378137,s=Math.PI/180,a=t.lat*s,c=n.lat*s,u=(n.lon-t.lon)*s,p=Math.atan((1-i)*Math.tan(a)),h=Math.atan((1-i)*Math.tan(c)),y=Math.sin(p),g=Math.cos(p),d=Math.sin(h),f=Math.cos(h);let l=u,m,b=1e3,v,w,I,O,_,E;do{const T=Math.sin(l),P=Math.cos(l);if(v=Math.sqrt(f*T*(f*T)+(g*d-y*f*P)*(g*d-y*f*P)),v===0)return 0;w=y*d+g*f*P,I=Math.atan2(v,w),O=g*f*T/v,_=1-O*O,E=w-2*y*d/_,isNaN(E)&&(E=0);const U=i/16*_*(4+i*(4-3*_));m=l,l=u+(1-U)*i*O*(I+U*v*(E+U*w*(-1+2*E*E)))}while(Math.abs(l-m)>1e-12&&--b>0);if(b===0)return NaN;const A=_*(6378137*6378137-o*o)/(o*o),C=1+A/16384*(4096+A*(-768+A*(320-175*A))),L=A/1024*(256+A*(-128+A*(74-47*A))),z=L*v*(E+L/4*(w*(-1+2*E*E)-L/6*E*(-3+4*v*v)*(-3+4*E*E)));return o*C*(I-z)}}class tt{true;false;constructor(){this.true=new Set,this.false=new Set}insert(t,n){n?this.true.add(t):this.false.add(t)}delete(t,n){n?this.true.delete(t):this.false.delete(t)}getSize(){return this.true.size+this.false.size}toJSON(){return{true:Array.from(this.true),false:Array.from(this.false)}}static fromJSON(t){const n=new tt;return n.true=new Set(t.true),n.false=new Set(t.false),n}}function Ho(e,t,n,r,i,{k:o,b:s,d:a}){return Math.log(1+(n-t+.5)/(t+.5))*(a+e*(o+1))/(e+o*(1-s+s*r/i))}const Ko=.8;class nt{size;vectors=new Map;constructor(t){this.size=t}add(t,n){n instanceof Float32Array||(n=new Float32Array(n));const r=Xr(n,this.size);this.vectors.set(t,[r,n])}remove(t){this.vectors.delete(t)}find(t,n,r){return t instanceof Float32Array||(t=new Float32Array(t)),Yo(t,r,this.vectors,this.size,n)}toJSON(){const t=[];for(const[n,[r,i]]of this.vectors)t.push([n,[r,Array.from(i)]]);return{size:this.size,vectors:t}}static fromJSON(t){const n=t,r=new nt(n.size);for(const[i,[o,s]]of n.vectors)r.vectors.set(i,[o,new Float32Array(s)]);return r}}function Xr(e,t){let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}function Yo(e,t,n,r,i){const o=Xr(e,r),s=[],a=t||n.keys();for(const c of a){const u=n.get(c);if(!u)continue;const p=u[0],h=u[1];let y=0;for(let d=0;d<r;d++)y+=e[d]*h[d];const g=y/(o*p);g>=i&&s.push([c,g])}return s}function Jo(e,t,n,r,i){const o=$(e.sharedInternalDocumentStore,n);e.avgFieldLength[t]=((e.avgFieldLength[t]??0)*(i-1)+r.length)/i,e.fieldLengths[t][o]=r.length,e.frequencies[t][o]={}}function Qo(e,t,n,r,i){let o=0;for(const c of r)c===i&&o++;const s=$(e.sharedInternalDocumentStore,n),a=o/r.length;e.frequencies[t][s][i]=a,i in e.tokenOccurrences[t]||(e.tokenOccurrences[t][i]=0),e.tokenOccurrences[t][i]=(e.tokenOccurrences[t][i]??0)+1}function Xo(e,t,n,r){const i=$(e.sharedInternalDocumentStore,n);r>1?e.avgFieldLength[t]=(e.avgFieldLength[t]*r-e.fieldLengths[t][i])/(r-1):e.avgFieldLength[t]=void 0,e.fieldLengths[t][i]=void 0,e.frequencies[t][i]=void 0}function Zo(e,t,n){e.tokenOccurrences[t][n]--}function Zr(e,t,n,r,i=""){r||(r={sharedInternalDocumentStore:t,indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},frequencies:{},tokenOccurrences:{},avgFieldLength:{},fieldLengths:{}});for(const[o,s]of Object.entries(n)){const a=`${i}${i?".":""}${o}`;if(typeof s=="object"&&!Array.isArray(s)){Zr(e,t,s,r,a);continue}if(_e(s))r.searchableProperties.push(a),r.searchablePropertiesWithTypes[a]=s,r.vectorIndexes[a]={type:"Vector",node:new nt(mn(s)),isArray:!1};else{const c=/\[/.test(s);switch(s){case"boolean":case"boolean[]":r.indexes[a]={type:"Bool",node:new tt,isArray:c};break;case"number":case"number[]":r.indexes[a]={type:"AVL",node:new Xe(0,[]),isArray:c};break;case"string":case"string[]":r.indexes[a]={type:"Radix",node:new et,isArray:c},r.avgFieldLength[a]=0,r.frequencies[a]={},r.tokenOccurrences[a]={},r.fieldLengths[a]={};break;case"enum":case"enum[]":r.indexes[a]={type:"Flat",node:new Ze,isArray:c};break;case"geopoint":r.indexes[a]={type:"BKD",node:new q,isArray:c};break;default:throw N("INVALID_SCHEMA_TYPE",Array.isArray(s)?"array":s,a)}r.searchableProperties.push(a),r.searchablePropertiesWithTypes[a]=s}}return r}function es(e,t,n,r,i,o,s,a){return c=>{const{type:u,node:p}=t.indexes[n];switch(u){case"Bool":{p[c?"true":"false"].add(r);break}case"AVL":{const h=a?.avlRebalanceThreshold??1;p.insert(c,r,h);break}case"Radix":{const h=o.tokenize(c,i,n,!1);e.insertDocumentScoreParameters(t,n,r,h,s);for(const y of h)e.insertTokenScoreParameters(t,n,r,h,y),p.insert(y,r);break}case"Flat":{p.insert(c,r);break}case"BKD":{p.insert(c,[r]);break}}}}function ei(e,t,n,r,i,o,s,a,c,u,p){if(_e(s))return ts(t,n,o,r,i);const h=es(e,t,n,i,a,c,u,p);if(!Ot(s))return h(o);const y=o,g=y.length;for(let d=0;d<g;d++)h(y[d])}function ts(e,t,n,r,i){e.vectorIndexes[t].node.add(i,n)}function Qn(e,t,n,r,i,o,s,a,c,u){if(_e(s))return t.vectorIndexes[n].node.remove(i),!0;const{type:p,node:h}=t.indexes[n];switch(p){case"AVL":return h.removeDocument(o,i),!0;case"Bool":return h[o?"true":"false"].delete(i),!0;case"Radix":{const y=c.tokenize(o,a,n);e.removeDocumentScoreParameters(t,n,r,u);for(const g of y)e.removeTokenScoreParameters(t,n,g),h.removeDocumentByWord(g,i);return!0}case"Flat":return h.removeDocument(i,o),!0;case"BKD":return h.removeDocByID(o,i),!1}}function ti(e,t,n,r,i,o,s,a,c,u){if(!Ot(s))return Qn(e,t,n,r,i,o,s,a,c,u);const p=Jr(s),h=o,y=h.length;for(let g=0;g<y;g++)Qn(e,t,n,r,i,h[g],p,a,c,u);return!0}function ni(e,t,n,r,i,o,s,a,c,u){const p=Array.from(r),h=e.avgFieldLength[t],y=e.fieldLengths[t],g=e.tokenOccurrences[t],d=e.frequencies[t],f=typeof g[n]=="number"?g[n]??0:0,l=p.length;for(let m=0;m<l;m++){const b=p[m];if(c&&!c.has(b))continue;u.has(b)||u.set(b,new Map);const v=u.get(b);v.set(t,(v.get(t)||0)+1);const w=d?.[b]?.[n]??0,I=Ho(w,f,i,y[b],h,o);s.has(b)?s.set(b,s.get(b)+I*a):s.set(b,I*a)}}function ns(e,t,n,r,i,o,s,a,c,u,p,h=0){const y=n.tokenize(t,r),g=y.length||1,d=new Map,f=new Map,l=new Map;for(const v of i){if(!(v in e.indexes))continue;const w=e.indexes[v],{type:I}=w;if(I!=="Radix")throw N("WRONG_SEARCH_PROPERTY_TYPE",v);const O=a[v]??1;if(O<=0)throw N("INVALID_BOOST_VALUE",O);y.length===0&&!t&&y.push("");const _=y.length;for(let E=0;E<_;E++){const A=y[E],C=w.node.find({term:A,exact:o,tolerance:s}),L=Object.keys(C);L.length>0&&f.set(A,!0);const z=L.length;for(let K=0;K<z;K++){const T=L[K],P=C[T];ni(e,v,T,P,u,c,l,O,p,d)}}}const m=Array.from(l.entries()).map(([v,w])=>[v,w]).sort((v,w)=>w[1]-v[1]);if(m.length===0)return[];if(h===1)return m;if(h===0){if(g===1)return m;for(const w of y)if(!f.get(w))return[];return m.filter(([w])=>{const I=d.get(w);return I?Array.from(I.values()).some(O=>O===g):!1})}const b=m.filter(([v])=>{const w=d.get(v);return w?Array.from(w.values()).some(I=>I===g):!1});if(b.length>0){const v=m.filter(([I])=>!b.some(([O])=>O===I)),w=Math.ceil(v.length*h);return[...b,...v.slice(0,w)]}return m}function Te(e,t,n,r){if("and"in n&&n.and&&Array.isArray(n.and)){const s=n.and;if(s.length===0)return new Set;const a=s.map(c=>Te(e,t,c,r));return ht(...a)}if("or"in n&&n.or&&Array.isArray(n.or)){const s=n.or;return s.length===0?new Set:s.map(c=>Te(e,t,c,r)).reduce((c,u)=>at(c,u),new Set)}if("not"in n&&n.not){const s=n.not,a=new Set,c=e.sharedInternalDocumentStore;for(let p=1;p<=c.internalIdToId.length;p++)a.add(p);const u=Te(e,t,s,r);return bo(a,u)}const i=Object.keys(n),o=i.reduce((s,a)=>({[a]:new Set,...s}),{});for(const s of i){const a=n[s];if(typeof e.indexes[s]>"u")throw N("UNKNOWN_FILTER_PROPERTY",s);const{node:c,type:u,isArray:p}=e.indexes[s];if(u==="Bool"){const y=c,g=a?y.true:y.false;o[s]=at(o[s],g);continue}if(u==="BKD"){let y;if("radius"in a)y="radius";else if("polygon"in a)y="polygon";else throw new Error(`Invalid operation ${a}`);if(y==="radius"){const{value:g,coordinates:d,unit:f="m",inside:l=!0,highPrecision:m=!1}=a[y],b=Gr(g,f),v=c.searchByRadius(d,b,l,void 0,m);o[s]=Xn(o[s],v)}else{const{coordinates:g,inside:d=!0,highPrecision:f=!1}=a[y],l=c.searchByPolygon(g,d,void 0,f);o[s]=Xn(o[s],l)}continue}if(u==="Radix"&&(typeof a=="string"||Array.isArray(a))){for(const y of[a].flat()){const g=t.tokenize(y,r,s);for(const d of g){const f=c.find({term:d,exact:!0});o[s]=cs(o[s],f)}}continue}const h=Object.keys(a);if(h.length>1)throw N("INVALID_FILTER_OPERATION",h.length);if(u==="Flat"){const y=new Set(p?c.filterArr(a):c.filter(a));o[s]=at(o[s],y);continue}if(u==="AVL"){const y=h[0],g=a[y];let d;switch(y){case"gt":{d=c.greaterThan(g,!1);break}case"gte":{d=c.greaterThan(g,!0);break}case"lt":{d=c.lessThan(g,!1);break}case"lte":{d=c.lessThan(g,!0);break}case"eq":{d=c.find(g)??new Set;break}case"between":{const[f,l]=g;d=c.rangeSearch(f,l);break}default:throw N("INVALID_FILTER_OPERATION",y)}o[s]=at(o[s],d)}}return ht(...Object.values(o))}function rs(e){return e.searchableProperties}function is(e){return e.searchablePropertiesWithTypes}function ri(e,t){const{indexes:n,vectorIndexes:r,searchableProperties:i,searchablePropertiesWithTypes:o,frequencies:s,tokenOccurrences:a,avgFieldLength:c,fieldLengths:u}=t,p={},h={};for(const y of Object.keys(n)){const{node:g,type:d,isArray:f}=n[y];switch(d){case"Radix":p[y]={type:"Radix",node:et.fromJSON(g),isArray:f};break;case"Flat":p[y]={type:"Flat",node:Ze.fromJSON(g),isArray:f};break;case"AVL":p[y]={type:"AVL",node:Xe.fromJSON(g),isArray:f};break;case"BKD":p[y]={type:"BKD",node:q.fromJSON(g),isArray:f};break;case"Bool":p[y]={type:"Bool",node:tt.fromJSON(g),isArray:f};break;default:p[y]=n[y]}}for(const y of Object.keys(r))h[y]={type:"Vector",isArray:!1,node:nt.fromJSON(r[y])};return{sharedInternalDocumentStore:e,indexes:p,vectorIndexes:h,searchableProperties:i,searchablePropertiesWithTypes:o,frequencies:s,tokenOccurrences:a,avgFieldLength:c,fieldLengths:u}}function ii(e){const{indexes:t,vectorIndexes:n,searchableProperties:r,searchablePropertiesWithTypes:i,frequencies:o,tokenOccurrences:s,avgFieldLength:a,fieldLengths:c}=e,u={};for(const h of Object.keys(n))u[h]=n[h].node.toJSON();const p={};for(const h of Object.keys(t)){const{type:y,node:g,isArray:d}=t[h];y==="Flat"||y==="Radix"||y==="AVL"||y==="BKD"||y==="Bool"?p[h]={type:y,node:g.toJSON(),isArray:d}:(p[h]=t[h],p[h].node=p[h].node.toJSON())}return{indexes:p,vectorIndexes:u,searchableProperties:r,searchablePropertiesWithTypes:i,frequencies:o,tokenOccurrences:s,avgFieldLength:a,fieldLengths:c}}function os(){return{create:Zr,insert:ei,remove:ti,insertDocumentScoreParameters:Jo,insertTokenScoreParameters:Qo,removeDocumentScoreParameters:Xo,removeTokenScoreParameters:Zo,calculateResultScores:ni,search:ns,searchByWhereClause:Te,getSearchableProperties:rs,getSearchablePropertiesWithTypes:is,load:ri,save:ii}}function Xn(e,t){e||(e=new Set);const n=t.length;for(let r=0;r<n;r++){const i=t[r].docIDs,o=i.length;for(let s=0;s<o;s++)e.add(i[s])}return e}function Zn(e,t,n=!1){const r=n?q.vincentyDistance:q.haversineDistance,i=[],o=[];for(const{point:c}of e)o.push(r(t,c));const s=Math.max(...o);let a=0;for(const{docIDs:c}of e){const u=o[a],p=s-u+1;for(const h of c)i.push([h,p]);a++}return i.sort((c,u)=>u[1]-c[1]),i}function ss(e,t){const n=Object.keys(e);if(n.length!==1)return{isGeoOnly:!1};const r=n[0],i=e[r];if(typeof t.indexes[r]>"u")return{isGeoOnly:!1};const{type:o}=t.indexes[r];return o==="BKD"&&i&&("radius"in i||"polygon"in i)?{isGeoOnly:!0,geoProperty:r,geoOperation:i}:{isGeoOnly:!1}}function as(e,t){const n=e,r=ss(t,n);if(!r.isGeoOnly||!r.geoProperty||!r.geoOperation)return null;const{node:i}=n.indexes[r.geoProperty],o=r.geoOperation,s=i;let a;if("radius"in o){const{value:c,coordinates:u,unit:p="m",inside:h=!0,highPrecision:y=!1}=o.radius,g=u,d=Gr(c,p);return a=s.searchByRadius(g,d,h,"asc",y),Zn(a,g,y)}else if("polygon"in o){const{coordinates:c,inside:u=!0,highPrecision:p=!1}=o.polygon;a=s.searchByPolygon(c,u,"asc",p);const h=q.calculatePolygonCentroid(c);return Zn(a,h,p)}return null}function cs(e,t){e||(e=new Set);const n=Object.keys(t),r=n.length;for(let i=0;i<r;i++){const o=t[n[i]],s=o.length;for(let a=0;a<s;a++)e.add(o[a])}return e}function oi(e,t,n,r,i){const o={language:e.tokenizer.language,sharedInternalDocumentStore:t,enabled:!0,isSorted:!0,sortableProperties:[],sortablePropertiesWithTypes:{},sorts:{}};for(const[s,a]of Object.entries(n)){const c=`${i}${i?".":""}${s}`;if(!r.includes(c)){if(typeof a=="object"&&!Array.isArray(a)){const u=oi(e,t,a,r,c);jr(o.sortableProperties,u.sortableProperties),o.sorts={...o.sorts,...u.sorts},o.sortablePropertiesWithTypes={...o.sortablePropertiesWithTypes,...u.sortablePropertiesWithTypes};continue}if(!_e(a))switch(a){case"boolean":case"number":case"string":o.sortableProperties.push(c),o.sortablePropertiesWithTypes[c]=a,o.sorts[c]={docs:new Map,orderedDocsToRemove:new Map,orderedDocs:[],type:a};break;case"geopoint":case"enum":continue;case"enum[]":case"boolean[]":case"number[]":case"string[]":continue;default:throw N("INVALID_SORT_SCHEMA_TYPE",Array.isArray(a)?"array":a,c)}}}return o}function us(e,t,n,r){return r?.enabled!==!1?oi(e,t,n,(r||{}).unsortableProperties||[],""):{disabled:!0}}function ls(e,t,n,r){if(!e.enabled)return;e.isSorted=!1;const i=$(e.sharedInternalDocumentStore,n),o=e.sorts[t];o.orderedDocsToRemove.has(i)&&bn(e,t),o.docs.set(i,o.orderedDocs.length),o.orderedDocs.push([i,r])}function si(e){if(e.isSorted||!e.enabled)return;const t=Object.keys(e.sorts);for(const n of t)ps(e,n);e.isSorted=!0}function fs(e,t,n){return t[1].localeCompare(n[1],uo(e))}function ds(e,t){return e[1]-t[1]}function hs(e,t){return t[1]?-1:1}function ps(e,t){const n=e.sorts[t];let r;switch(n.type){case"string":r=fs.bind(null,e.language);break;case"number":r=ds.bind(null);break;case"boolean":r=hs.bind(null);break}n.orderedDocs.sort(r);const i=n.orderedDocs.length;for(let o=0;o<i;o++){const s=n.orderedDocs[o][0];n.docs.set(s,o)}}function ys(e){const t=Object.keys(e.sorts);for(const n of t)bn(e,n)}function bn(e,t){const n=e.sorts[t];n.orderedDocsToRemove.size&&(n.orderedDocs=n.orderedDocs.filter(r=>!n.orderedDocsToRemove.has(r[0])),n.orderedDocsToRemove.clear())}function ms(e,t,n){if(!e.enabled)return;const r=e.sorts[t],i=$(e.sharedInternalDocumentStore,n);r.docs.get(i)&&(r.docs.delete(i),r.orderedDocsToRemove.set(i,!0))}function gs(e,t,n){if(!e.enabled)throw N("SORT_DISABLED");const r=n.property,i=n.order==="DESC",o=e.sorts[r];if(!o)throw N("UNABLE_TO_SORT_ON_UNKNOWN_FIELD",r,e.sortableProperties.join(", "));return bn(e,r),si(e),t.sort((s,a)=>{const c=o.docs.get($(e.sharedInternalDocumentStore,s[0])),u=o.docs.get($(e.sharedInternalDocumentStore,a[0])),p=typeof c<"u",h=typeof u<"u";return!p&&!h?0:p?h?i?u-c:c-u:-1:1}),t}function vs(e){return e.enabled?e.sortableProperties:[]}function bs(e){return e.enabled?e.sortablePropertiesWithTypes:{}}function ws(e,t){const n=t;if(!n.enabled)return{enabled:!1};const r=Object.keys(n.sorts).reduce((i,o)=>{const{docs:s,orderedDocs:a,type:c}=n.sorts[o];return i[o]={docs:new Map(Object.entries(s).map(([u,p])=>[+u,p])),orderedDocsToRemove:new Map,orderedDocs:a,type:c},i},{});return{sharedInternalDocumentStore:e,language:n.language,sortableProperties:n.sortableProperties,sortablePropertiesWithTypes:n.sortablePropertiesWithTypes,sorts:r,enabled:!0,isSorted:n.isSorted}}function _s(e){if(!e.enabled)return{enabled:!1};ys(e),si(e);const t=Object.keys(e.sorts).reduce((n,r)=>{const{docs:i,orderedDocs:o,type:s}=e.sorts[r];return n[r]={docs:Object.fromEntries(i.entries()),orderedDocs:o,type:s},n},{});return{language:e.language,sortableProperties:e.sortableProperties,sortablePropertiesWithTypes:e.sortablePropertiesWithTypes,sorts:t,enabled:e.enabled,isSorted:e.isSorted}}function Ss(){return{create:us,insert:ls,remove:ms,save:_s,load:ws,sortBy:gs,getSortableProperties:vs,getSortablePropertiesWithTypes:bs}}const er=192,Is=383,Es=[65,65,65,65,65,65,65,67,69,69,69,69,73,73,73,73,69,78,79,79,79,79,79,null,79,85,85,85,85,89,80,115,97,97,97,97,97,97,97,99,101,101,101,101,105,105,105,105,101,110,111,111,111,111,111,null,111,117,117,117,117,121,112,121,65,97,65,97,65,97,67,99,67,99,67,99,67,99,68,100,68,100,69,101,69,101,69,101,69,101,69,101,71,103,71,103,71,103,71,103,72,104,72,104,73,105,73,105,73,105,73,105,73,105,73,105,74,106,75,107,107,76,108,76,108,76,108,76,108,76,108,78,110,78,110,78,110,110,78,110,79,111,79,111,79,111,79,111,82,114,82,114,82,114,83,115,83,115,83,115,83,115,84,116,84,116,84,116,85,117,85,117,85,117,85,117,85,117,85,117,87,119,89,121,89,90,122,90,122,90,122,115];function Os(e){return e<er||e>Is?e:Es[e-er]||e}function Ts(e){const t=[];for(let n=0;n<e.length;n++)t[n]=Os(e.charCodeAt(n));return String.fromCharCode(...t)}const As={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},Rs={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},xs="[^aeiou]",yt="[aeiouy]",se=xs+"[^aeiouy]*",Be=yt+"[aeiou]*",Vt="^("+se+")?"+Be+se,Ps="^("+se+")?"+Be+se+"("+Be+")?$",ct="^("+se+")?"+Be+se+Be+se,tr="^("+se+")?"+yt;function ks(e){let t,n,r,i,o,s;if(e.length<3)return e;const a=e.substring(0,1);if(a=="y"&&(e=a.toUpperCase()+e.substring(1)),r=/^(.+?)(ss|i)es$/,i=/^(.+?)([^s])s$/,r.test(e)?e=e.replace(r,"$1$2"):i.test(e)&&(e=e.replace(i,"$1$2")),r=/^(.+?)eed$/,i=/^(.+?)(ed|ing)$/,r.test(e)){const c=r.exec(e);r=new RegExp(Vt),r.test(c[1])&&(r=/.$/,e=e.replace(r,""))}else i.test(e)&&(t=i.exec(e)[1],i=new RegExp(tr),i.test(t)&&(e=t,i=/(at|bl|iz)$/,o=new RegExp("([^aeiouylsz])\\1$"),s=new RegExp("^"+se+yt+"[^aeiouwxy]$"),i.test(e)?e=e+"e":o.test(e)?(r=/.$/,e=e.replace(r,"")):s.test(e)&&(e=e+"e")));if(r=/^(.+?)y$/,r.test(e)&&(t=r.exec(e)?.[1],r=new RegExp(tr),t&&r.test(t)&&(e=t+"i")),r=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,r.test(e)){const c=r.exec(e);t=c?.[1],n=c?.[2],r=new RegExp(Vt),t&&r.test(t)&&(e=t+As[n])}if(r=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,r.test(e)){const c=r.exec(e);t=c?.[1],n=c?.[2],r=new RegExp(Vt),t&&r.test(t)&&(e=t+Rs[n])}if(r=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,i=/^(.+?)(s|t)(ion)$/,r.test(e))t=r.exec(e)?.[1],r=new RegExp(ct),t&&r.test(t)&&(e=t);else if(i.test(e)){const c=i.exec(e);t=c?.[1]??""+c?.[2]??"",i=new RegExp(ct),i.test(t)&&(e=t)}return r=/^(.+?)e$/,r.test(e)&&(t=r.exec(e)?.[1],r=new RegExp(ct),i=new RegExp(Ps),o=new RegExp("^"+se+yt+"[^aeiouwxy]$"),t&&(r.test(t)||i.test(t)&&!o.test(t))&&(e=t)),r=/ll$/,i=new RegExp(ct),r.test(e)&&i.test(e)&&(r=/.$/,e=e.replace(r,"")),a=="y"&&(e=a.toLowerCase()+e.substring(1)),e}function nr(e,t,n=!0){const r=`${this.language}:${e}:${t}`;return n&&this.normalizationCache.has(r)?this.normalizationCache.get(r):this.stopWords?.includes(t)?(n&&this.normalizationCache.set(r,""),""):(this.stemmer&&!this.stemmerSkipProperties.has(e)&&(t=this.stemmer(t)),t=Ts(t),n&&this.normalizationCache.set(r,t),t)}function Ns(e){for(;e[e.length-1]==="";)e.pop();for(;e[0]==="";)e.shift();return e}function rr(e,t,n,r=!0){if(t&&t!==this.language)throw N("LANGUAGE_NOT_SUPPORTED",t);if(typeof e!="string")return[e];const i=this.normalizeToken.bind(this,n??"");let o;if(n&&this.tokenizeSkipProperties.has(n))o=[i(e,r)];else{const a=co[this.language];o=e.toLowerCase().split(a).map(c=>i(c,r)).filter(Boolean)}const s=Ns(o);return this.allowDuplicates?s:Array.from(new Set(s))}function ir(e={}){if(!e.language)e.language="english";else if(!hn.includes(e.language))throw N("LANGUAGE_NOT_SUPPORTED",e.language);let t;if(e.stemming||e.stemmer&&!("stemming"in e))if(e.stemmer){if(typeof e.stemmer!="function")throw N("INVALID_STEMMER_FUNCTION_TYPE");t=e.stemmer}else if(e.language==="english")t=ks;else throw N("MISSING_STEMMER",e.language);let n;if(e.stopWords!==!1){if(n=[],Array.isArray(e.stopWords))n=e.stopWords;else if(typeof e.stopWords=="function")n=e.stopWords(n);else if(e.stopWords)throw N("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");if(!Array.isArray(n))throw N("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");for(const i of n)if(typeof i!="string")throw N("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY")}const r={tokenize:rr,language:e.language,stemmer:t,stemmerSkipProperties:new Set(e.stemmerSkipProperties?[e.stemmerSkipProperties].flat():[]),tokenizeSkipProperties:new Set(e.tokenizeSkipProperties?[e.tokenizeSkipProperties].flat():[]),stopWords:n,allowDuplicates:!!e.allowDuplicates,normalizeToken:nr,normalizationCache:new Map};return r.tokenize=rr.bind(r),r.normalizeToken=nr,r}function Ds(e){return{sharedInternalDocumentStore:e,rules:new Map}}function Ms(e,t){if(e.rules.has(t.id))throw new Error(`PINNING_RULE_ALREADY_EXISTS: A pinning rule with id "${t.id}" already exists. Use updateRule to modify it.`);e.rules.set(t.id,t)}function Ls(e,t){if(!e.rules.has(t.id))throw new Error(`PINNING_RULE_NOT_FOUND: Cannot update pinning rule with id "${t.id}" because it does not exist. Use addRule to create it.`);e.rules.set(t.id,t)}function Cs(e,t){return e.rules.delete(t)}function zs(e,t){return e.rules.get(t)}function Us(e){return Array.from(e.rules.values())}function Fs(e,t){const n=e.toLowerCase().trim(),r=t.pattern.toLowerCase().trim();switch(t.anchoring){case"is":return n===r;case"starts_with":return n.startsWith(r);case"contains":return n.includes(r);default:return!1}}function Vs(e,t){return e?t.conditions.every(n=>Fs(e,n)):!1}function ai(e,t){if(!t)return[];const n=[];for(const r of e.rules.values())Vs(t,r)&&n.push(r);return n}function $s(e,t){const n=t;return{sharedInternalDocumentStore:e,rules:new Map(n?.rules??[])}}function js(e){return{rules:Array.from(e.rules.entries())}}function Bs(){return{create:Ds,addRule:Ms,updateRule:Ls,removeRule:Cs,getRule:zs,getAllRules:Us,getMatchingRules:ai,load:$s,save:js}}function Ws(e){const t={formatElapsedTime:So,getDocumentIndexId:Io,getDocumentProperties:qr,validateSchema:Yr};for(const n of Yn){const r=n;if(e[r]){if(typeof e[r]!="function")throw N("COMPONENT_MUST_BE_FUNCTION",r)}else e[r]=t[r]}for(const n of Object.keys(e))if(!jo.includes(n)&&!Yn.includes(n))throw N("UNSUPPORTED_COMPONENT",n)}function qs({schema:e,sort:t,language:n,components:r,id:i,plugins:o}){r||(r={});for(const b of o??[]){if(!("getComponents"in b)||typeof b.getComponents!="function")continue;const v=b.getComponents(e),w=Object.keys(v);for(const I of w)if(r[I])throw N("PLUGIN_COMPONENT_CONFLICT",I,b.name);r={...r,...v}}i||(i=Br());let s=r.tokenizer,a=r.index,c=r.documentsStore,u=r.sorter,p=r.pinning;if(s?s.tokenize?s=s:s=ir(s):s=ir({language:n??"english"}),r.tokenizer&&n)throw N("NO_LANGUAGE_WITH_CUSTOM_TOKENIZER");const h=Ao();a||=os(),u||=Ss(),c||=Fo(),p||=Bs(),Ws(r);const{getDocumentProperties:y,getDocumentIndexId:g,validateSchema:d,formatElapsedTime:f}=r,l={data:{},caches:{},schema:e,tokenizer:s,index:a,sorter:u,documentsStore:c,pinning:p,internalDocumentIDStore:h,getDocumentProperties:y,getDocumentIndexId:g,validateSchema:d,beforeInsert:[],afterInsert:[],beforeRemove:[],afterRemove:[],beforeUpdate:[],afterUpdate:[],beforeUpsert:[],afterUpsert:[],beforeSearch:[],afterSearch:[],beforeInsertMultiple:[],afterInsertMultiple:[],beforeRemoveMultiple:[],afterRemoveMultiple:[],beforeUpdateMultiple:[],afterUpdateMultiple:[],beforeUpsertMultiple:[],afterUpsertMultiple:[],afterCreate:[],formatElapsedTime:f,id:i,plugins:o,version:Gs()};l.data={index:l.index.create(l,h,e),docs:l.documentsStore.create(l,h),sorting:l.sorter.create(l,h,e,t),pinning:l.pinning.create(h)};for(const b of Vo)l[b]=(l[b]??[]).concat($o(l,b));const m=l.afterCreate;return m&&Bo(m,l),l}function Gs(){return"{{VERSION}}"}function Hs(e){return e.documentsStore.count(e.data.docs)}function wn(e,t,n,r,i){const o=e.validateSchema(t,e.schema);if(o)throw N("SCHEMA_VALIDATION_FAILURE",o);return V(e.beforeInsert)||V(e.afterInsert)||V(e.index.beforeInsert)||V(e.index.insert)||V(e.index.afterInsert)?Js(e,t,n,r,i):Qs(e,t,n,r,i)}const Ks=new Set(["enum","enum[]"]),Ys=new Set(["string","number"]);async function Js(e,t,n,r,i){const{index:o,docs:s}=e.data,a=e.getDocumentIndexId(t);if(typeof a!="string")throw N("DOCUMENT_ID_MUST_BE_STRING",typeof a);const c=$(e.internalDocumentIDStore,a);if(await pt(e.beforeInsert,e,a,t),!e.documentsStore.store(s,a,c,t))throw N("DOCUMENT_ALREADY_EXISTS",a);const u=e.documentsStore.count(s),p=e.index.getSearchableProperties(o),h=e.index.getSearchablePropertiesWithTypes(o),y=e.getDocumentProperties(t,p);for(const[g,d]of Object.entries(y)){if(typeof d>"u")continue;const f=typeof d,l=h[g];ci(f,l,g,d)}return await Xs(e,a,p,y,u,n,t,i),await pt(e.afterInsert,e,a,t),a}function Qs(e,t,n,r,i){const{index:o,docs:s}=e.data,a=e.getDocumentIndexId(t);if(typeof a!="string")throw N("DOCUMENT_ID_MUST_BE_STRING",typeof a);const c=$(e.internalDocumentIDStore,a);if(pt(e.beforeInsert,e,a,t),!e.documentsStore.store(s,a,c,t))throw N("DOCUMENT_ALREADY_EXISTS",a);const u=e.documentsStore.count(s),p=e.index.getSearchableProperties(o),h=e.index.getSearchablePropertiesWithTypes(o),y=e.getDocumentProperties(t,p);for(const[g,d]of Object.entries(y)){if(typeof d>"u")continue;const f=typeof d,l=h[g];ci(f,l,g,d)}return Zs(e,a,p,y,u,n,t,i),pt(e.afterInsert,e,a,t),a}function ci(e,t,n,r){if(!(To(t)&&typeof r=="object"&&typeof r.lon=="number"&&typeof r.lat=="number")&&!(_e(t)&&Array.isArray(r))&&!(Ot(t)&&Array.isArray(r))&&!(Ks.has(t)&&Ys.has(e))&&e!==t)throw N("INVALID_DOCUMENT_PROPERTY",n,t,e)}async function Xs(e,t,n,r,i,o,s,a){for(const p of n){const h=r[p];if(typeof h>"u")continue;const y=e.index.getSearchablePropertiesWithTypes(e.data.index)[p];await e.index.beforeInsert?.(e.data.index,p,t,h,y,o,e.tokenizer,i);const g=e.internalDocumentIDStore.idToInternalId.get(t);await e.index.insert(e.index,e.data.index,p,t,g,h,y,o,e.tokenizer,i,a),await e.index.afterInsert?.(e.data.index,p,t,h,y,o,e.tokenizer,i)}const c=e.sorter.getSortableProperties(e.data.sorting),u=e.getDocumentProperties(s,c);for(const p of c){const h=u[p];if(typeof h>"u")continue;const y=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[p];e.sorter.insert(e.data.sorting,p,t,h,y,o)}}function Zs(e,t,n,r,i,o,s,a){for(const p of n){const h=r[p];if(typeof h>"u")continue;const y=e.index.getSearchablePropertiesWithTypes(e.data.index)[p],g=$(e.internalDocumentIDStore,t);e.index.beforeInsert?.(e.data.index,p,t,h,y,o,e.tokenizer,i),e.index.insert(e.index,e.data.index,p,t,g,h,y,o,e.tokenizer,i,a),e.index.afterInsert?.(e.data.index,p,t,h,y,o,e.tokenizer,i)}const c=e.sorter.getSortableProperties(e.data.sorting),u=e.getDocumentProperties(s,c);for(const p of c){const h=u[p];if(typeof h>"u")continue;const y=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[p];e.sorter.insert(e.data.sorting,p,t,h,y,o)}}function ea(e,t,n,r,i,o){return V(e.afterInsertMultiple)||V(e.beforeInsertMultiple)||V(e.index.beforeInsert)||V(e.index.insert)||V(e.index.afterInsert)?ta(e,t,n,r,i,o):na(e,t,n,r,i,o)}async function ta(e,t,n=1e3,r,i,o=0){const s=[],a=async u=>{const p=Math.min(u+n,t.length),h=t.slice(u,p);for(const y of h){const g={avlRebalanceThreshold:h.length},d=await wn(e,y,r,i,g);s.push(d)}return p};return await(async()=>{let u=0;for(;u<t.length;){const p=Date.now();if(u=await a(u),o>0){const h=Date.now()-p,y=o-h;y>0&&Kr(y)}}})(),await Qr(e.afterInsertMultiple,e,t),s}function na(e,t,n=1e3,r,i,o=0){const s=[];let a=0;function c(){const p=t.slice(a*n,(a+1)*n);if(p.length===0)return!1;for(const h of p){const y={avlRebalanceThreshold:p.length},g=wn(e,h,r,i,y);s.push(g)}return a++,!0}function u(){const p=Date.now();for(;c();)if(o>0){const y=Date.now()-p;if(y>=o){const g=o-y%o;g>0&&Kr(g)}}}return u(),Qr(e.afterInsertMultiple,e,t),s}const or="fulltext",ra="hybrid",ia="vector";function oa(e,t){return e[1]-t[1]}function sa(e,t){return t[1]-e[1]}function aa(e="desc"){return e.toLowerCase()==="asc"?oa:sa}function _n(e,t,n){const r={},i=t.map(([u])=>u),o=e.documentsStore.getMultiple(e.data.docs,i),s=Object.keys(n),a=e.index.getSearchablePropertiesWithTypes(e.data.index);for(const u of s){let p;if(a[u]==="number"){const{ranges:h}=n[u],y=h.length,g=Array.from({length:y});for(let d=0;d<y;d++){const f=h[d];g[d]=[`${f.from}-${f.to}`,0]}p=Object.fromEntries(g)}r[u]={count:0,values:p??{}}}const c=o.length;for(let u=0;u<c;u++){const p=o[u];for(const h of s){const y=h.includes(".")?yn(p,h):p[h],g=a[h],d=r[h].values;switch(g){case"number":{const f=n[h].ranges;sr(f,d)(y);break}case"number[]":{const f=new Set,l=n[h].ranges,m=sr(l,d,f);for(const b of y)m(b);break}case"boolean":case"enum":case"string":{ar(d,g)(y);break}case"boolean[]":case"enum[]":case"string[]":{const m=ar(d,g==="boolean[]"?"boolean":"string",new Set);for(const b of y)m(b);break}default:throw N("FACET_NOT_SUPPORTED",g)}}}for(const u of s){const p=r[u];if(p.count=Object.keys(p.values).length,a[u]==="string"){const h=n[u],y=aa(h.sort);p.values=Object.fromEntries(Object.entries(p.values).sort(y).slice(h.offset??0,h.limit??10))}}return r}function sr(e,t,n){return r=>{for(const i of e){const o=`${i.from}-${i.to}`;n?.has(o)||r>=i.from&&r<=i.to&&(t[o]===void 0?t[o]=1:(t[o]++,n?.add(o)))}}}function ar(e,t,n){const r=t==="boolean"?"false":"";return i=>{const o=i?.toString()??r;n?.has(o)||(e[o]=(e[o]??0)+1,n?.add(o))}}const ca={reducer:(e,t,n,r)=>(t[r]=n,t),getInitialValue:e=>Array.from({length:e})},cr=["string","number","boolean"];function Sn(e,t,n){const r=n.properties,i=r.length,o=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let m=0;m<i;m++){const b=r[m];if(typeof o[b]>"u")throw N("UNKNOWN_GROUP_BY_PROPERTY",b);if(!cr.includes(o[b]))throw N("INVALID_GROUP_BY_PROPERTY",b,cr.join(", "),o[b])}const s=t.map(([m])=>Tt(e.internalDocumentIDStore,m)),a=e.documentsStore.getMultiple(e.data.docs,s),c=a.length,u=n.maxResult||Number.MAX_SAFE_INTEGER,p=[],h={};for(let m=0;m<i;m++){const b=r[m],v={property:b,perValue:{}},w=new Set;for(let I=0;I<c;I++){const O=a[I],_=yn(O,b);if(typeof _>"u")continue;const E=typeof _!="boolean"?_:""+_,A=v.perValue[E]??{indexes:[],count:0};A.count>=u||(A.indexes.push(I),A.count++,v.perValue[E]=A,w.add(_))}p.push(Array.from(w)),h[b]=v}const y=ui(p),g=y.length,d=[];for(let m=0;m<g;m++){const b=y[m],v=b.length,w={values:[],indexes:[]},I=[];for(let O=0;O<v;O++){const _=b[O],E=r[O];I.push(h[E].perValue[typeof _!="boolean"?_:""+_].indexes),w.values.push(_)}w.indexes=mo(I).sort((O,_)=>O-_),w.indexes.length!==0&&d.push(w)}const f=d.length,l=Array.from({length:f});for(let m=0;m<f;m++){const b=d[m],v=n.reduce||ca,w=b.indexes.map(E=>({id:s[E],score:t[E][1],document:a[E]})),I=v.reducer.bind(null,b.values),O=v.getInitialValue(b.indexes.length),_=w.reduce(I,O);l[m]={values:b.values,result:_}}return l}function ui(e,t=0){if(t+1===e.length)return e[t].map(o=>[o]);const n=e[t],r=ui(e,t+1),i=[];for(const o of n)for(const s of r){const a=[o];jr(a,s),i.push(a)}return i}function In(e,t,n,r){const i=ai(t,r);if(i.length===0)return n;const o=i.flatMap(l=>l.consequence.promote);o.sort((l,m)=>l.position-m.position);const s=new Set,a=new Map,c=new Set;for(const l of o){const m=$(e.internalDocumentIDStore,l.doc_id);if(m!==void 0){if(a.has(m)){const b=a.get(m);l.position<b&&a.set(m,l.position);continue}c.has(l.position)||(s.add(m),a.set(m,l.position),c.add(l.position))}}if(a.size===0)return n;const u=n.filter(([l])=>!s.has(l)),p=1e6,h=[];for(const[l,m]of a.entries())n.find(([v])=>v===l)?h.push([l,p-m]):e.documentsStore.get(e.data.docs,l)&&h.push([l,0]);h.sort((l,m)=>{const b=a.get(l[0])??1/0,v=a.get(m[0])??1/0;return b-v});const y=[],g=new Map;for(const l of h){const m=a.get(l[0]);g.set(m,l)}let d=0,f=0;for(;f<u.length+h.length;)if(g.has(f))y.push(g.get(f)),f++;else if(d<u.length)y.push(u[d]),d++,f++;else break;for(const[l,m]of g.entries())l>=y.length&&y.push(m);return y}function li(e,t,n){const{term:r,properties:i}=t,o=e.data.index;let s=e.caches.propertiesToSearch;if(!s){const h=e.index.getSearchablePropertiesWithTypes(o);s=e.index.getSearchableProperties(o),s=s.filter(y=>h[y].startsWith("string")),e.caches.propertiesToSearch=s}if(i&&i!=="*"){for(const h of i)if(!s.includes(h))throw N("UNKNOWN_INDEX",h,s.join(", "));s=s.filter(h=>i.includes(h))}const a=Object.keys(t.where??{}).length>0;let c;a&&(c=e.index.searchByWhereClause(o,e.tokenizer,t.where,n));let u;const p=t.threshold!==void 0&&t.threshold!==null?t.threshold:1;if(r||i){const h=Hs(e);if(u=e.index.search(o,r||"",e.tokenizer,n,s,t.exact||!1,t.tolerance||0,t.boost||{},da(t.relevance),h,c,p),t.exact&&r){const y=r.trim().split(/\s+/);u=u.filter(([g])=>{const d=e.documentsStore.get(e.data.docs,g);if(!d)return!1;for(const f of s){const l=la(d,f);if(typeof l=="string"&&y.every(b=>new RegExp(`\\b${ua(b)}\\b`).test(l)))return!0}return!1})}}else if(a){const h=as(o,t.where);h?u=h:u=(c?Array.from(c):[]).map(g=>[+g,0])}else u=Object.keys(e.documentsStore.getAll(e.data.docs)).map(y=>[+y,0]);return u}function ua(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function la(e,t){const n=t.split(".");let r=e;for(const i of n)if(r&&typeof r=="object"&&i in r)r=r[i];else return;return r}function fa(e,t,n){const r=xe();function i(){const a=Object.keys(e.data.index.vectorIndexes),c=t.facets&&Object.keys(t.facets).length>0,{limit:u=10,offset:p=0,distinctOn:h,includeVectors:y=!1}=t,g=t.preflight===!0;let d=li(e,t,n);if(t.sortBy)if(typeof t.sortBy=="function"){const m=d.map(([w])=>w),v=e.documentsStore.getMultiple(e.data.docs,m).map((w,I)=>[d[I][0],d[I][1],w]);v.sort(t.sortBy),d=v.map(([w,I])=>[w,I])}else d=e.sorter.sortBy(e.data.sorting,d,t.sortBy).map(([m,b])=>[$(e.internalDocumentIDStore,m),b]);else d=d.sort(Wr);d=In(e,e.data.pinning,d,t.term);let f;g||(f=h?_a(e,d,p,u,h):di(e,d,p,u));const l={elapsed:{formatted:"",raw:0},hits:[],count:d.length};if(typeof f<"u"&&(l.hits=f.filter(Boolean),y||Hr(l,a)),c){const m=_n(e,d,t.facets);l.facets=m}return t.groupBy&&(l.groups=Sn(e,d,t.groupBy)),l.elapsed=e.formatElapsedTime(xe()-r),l}async function o(){e.beforeSearch&&await vn(e.beforeSearch,e,t,n);const a=i();return e.afterSearch&&await gn(e.afterSearch,e,t,n,a),a}return e.beforeSearch?.length||e.afterSearch?.length?o():i()}const $t={k:1.2,b:.75,d:.5};function da(e){const t=e??{};return t.k=t.k??$t.k,t.b=t.b??$t.b,t.d=t.d??$t.d,t}function fi(e,t,n){const r=t.vector;if(r&&(!("value"in r)||!("property"in r)))throw N("INVALID_VECTOR_INPUT",Object.keys(r).join(", "));const i=e.data.index.vectorIndexes[r.property];if(!i)throw N("UNKNOWN_VECTOR_PROPERTY",r.property);const o=i.node.size;if(r?.value.length!==o)throw r?.property===void 0||r?.value.length===void 0?N("INVALID_INPUT_VECTOR","undefined",o,"undefined"):N("INVALID_INPUT_VECTOR",r.property,o,r.value.length);const s=e.data.index;let a;return Object.keys(t.where??{}).length>0&&(a=e.index.searchByWhereClause(s,e.tokenizer,t.where,n)),i.node.find(r.value,t.similarity??Ko,a)}function ha(e,t,n="english"){const r=xe();function i(){let a=fi(e,t,n).sort(Wr);a=In(e,e.data.pinning,a,void 0);let c=[];t.facets&&Object.keys(t.facets).length>0&&(c=_n(e,a,t.facets));const p=t.vector.property,h=t.includeVectors??!1,y=t.limit??10,g=t.offset??0,d=Array.from({length:y});for(let b=0;b<y;b++){const v=a[b+g];if(!v)break;const w=e.data.docs.docs[v[0]];if(w){h||(w[p]=null);const I={id:Tt(e.internalDocumentIDStore,v[0]),score:v[1],document:w};d[b]=I}}let f=[];t.groupBy&&(f=Sn(e,a,t.groupBy));const m=xe()-r;return{count:a.length,hits:d.filter(Boolean),elapsed:{raw:Number(m),formatted:pn(m)},...c?{facets:c}:{},...f?{groups:f}:{}}}async function o(){e.beforeSearch&&await vn(e.beforeSearch,e,t,n);const a=i();return e.afterSearch&&await gn(e.afterSearch,e,t,n,a),a}return e.beforeSearch?.length||e.afterSearch?.length?o():i()}function pa(e,t,n){const r=ma(li(e,t,n)),i=fi(e,t,n),o=t.hybridWeights;return va(r,i,t.term??"",o)}function ya(e,t,n){const r=xe();function i(){let a=pa(e,t,n);a=In(e,e.data.pinning,a,t.term);let c;t.facets&&Object.keys(t.facets).length>0&&(c=_n(e,a,t.facets));let p;t.groupBy&&(p=Sn(e,a,t.groupBy));const h=t.offset??0,y=t.limit??10,g=di(e,a,h,y).filter(Boolean),d=xe(),f={count:a.length,elapsed:{raw:Number(d-r),formatted:pn(d-r)},hits:g,...c?{facets:c}:{},...p?{groups:p}:{}};if(!(t.includeVectors??!1)){const m=Object.keys(e.data.index.vectorIndexes);Hr(f,m)}return f}async function o(){e.beforeSearch&&await vn(e.beforeSearch,e,t,n);const a=i();return e.afterSearch&&await gn(e.afterSearch,e,t,n,a),a}return e.beforeSearch?.length||e.afterSearch?.length?o():i()}function Xt(e){return e[1]}function ma(e){const t=Math.max.apply(Math,e.map(Xt));return e.map(([n,r])=>[n,r/t])}function ur(e,t){return e/t}function ga(e,t){return(n,r)=>n*e+r*t}function va(e,t,n,r){const i=Math.max.apply(Math,e.map(Xt)),o=Math.max.apply(Math,t.map(Xt)),s=r&&r.text&&r.vector,{text:a,vector:c}=s?r:ba(),u=new Map,p=e.length,h=ga(a,c);for(let g=0;g<p;g++){const[d,f]=e[g],l=ur(f,i),m=h(l,0);u.set(d,m)}const y=t.length;for(let g=0;g<y;g++){const[d,f]=t[g],l=ur(f,o),m=u.get(d)??0;u.set(d,m+h(0,l))}return[...u].sort((g,d)=>d[1]-g[1])}function ba(e){return{text:.5,vector:.5}}function wa(e,t,n){const r=t.mode??or;if(r===or)return fa(e,t,n);if(r===ia)return ha(e,t);if(r===ra)return ya(e,t);throw N("INVALID_SEARCH_MODE",r)}function _a(e,t,n,r,i){const o=e.data.docs,s=new Map,a=[],c=new Set,u=t.length;let p=0;for(let h=0;h<u;h++){const y=t[h];if(typeof y>"u")continue;const[g,d]=y;if(c.has(g))continue;const f=e.documentsStore.get(o,g),l=yn(f,i);if(!(typeof l>"u"||s.has(l))&&(s.set(l,!0),p++,!(p<=n)&&(a.push({id:Tt(e.internalDocumentIDStore,g),score:d,document:f}),c.add(g),p>=n+r)))break}return a}function di(e,t,n,r){const i=e.data.docs,o=Array.from({length:r}),s=new Set;for(let a=n;a<r+n;a++){const c=t[a];if(typeof c>"u")break;const[u,p]=c;if(!s.has(u)){const h=e.documentsStore.get(i,u);o[a]={id:Tt(e.internalDocumentIDStore,u),score:p,document:h},s.add(u)}}return o}function Sa(e,t){e.internalDocumentIDStore.load(e,t.internalDocumentIDStore),e.data.index=e.index.load(e.internalDocumentIDStore,t.index),e.data.docs=e.documentsStore.load(e.internalDocumentIDStore,t.docs),e.data.sorting=e.sorter.load(e.internalDocumentIDStore,t.sorting),e.data.pinning=e.pinning.load(e.internalDocumentIDStore,t.pinning),e.tokenizer.language=t.language}function Ia(e){return{internalDocumentIDStore:e.internalDocumentIDStore.save(e.internalDocumentIDStore),index:e.index.save(e.data.index),docs:e.documentsStore.save(e.data.docs),sorting:e.sorter.save(e.data.sorting),pinning:e.pinning.save(e.data.pinning),language:e.tokenizer.language}}let Ea={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},Oa={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},mt="[aeiouy]",ae="[^aeiou][^aeiouy]*",We=mt+"[aeiou]*",jt="^("+ae+")?"+We+ae,Ta="^("+ae+")?"+We+ae+"("+We+")?$",ut="^("+ae+")?"+We+ae+We+ae,lr="^("+ae+")?"+mt;function Aa(e){let t,n,r,i,o,s;if(e.length<3)return e;let a=e.substring(0,1);if(a=="y"&&(e=a.toUpperCase()+e.substring(1)),i=/^(.+?)([^s])s$/,(r=/^(.+?)(ss|i)es$/).test(e)?e=e.replace(r,"$1$2"):i.test(e)&&(e=e.replace(i,"$1$2")),i=/^(.+?)(ed|ing)$/,(r=/^(.+?)eed$/).test(e)){let c=r.exec(e);(r=new RegExp(jt)).test(c[1])&&(r=/.$/,e=e.replace(r,""))}else i.test(e)&&(t=i.exec(e)[1],(i=new RegExp(lr)).test(t)&&(e=t,i=/(at|bl|iz)$/,o=RegExp("([^aeiouylsz])\\1$"),s=RegExp("^"+ae+mt+"[^aeiouwxy]$"),i.test(e)?e+="e":o.test(e)?(r=/.$/,e=e.replace(r,"")):s.test(e)&&(e+="e")));if((r=/^(.+?)y$/).test(e)&&(t=r.exec(e)?.[1],r=new RegExp(lr),t&&r.test(t)&&(e=t+"i")),(r=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/).test(e)){let c=r.exec(e);t=c?.[1],n=c?.[2],r=new RegExp(jt),t&&r.test(t)&&(e=t+Ea[n])}if((r=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/).test(e)){let c=r.exec(e);t=c?.[1],n=c?.[2],r=new RegExp(jt),t&&r.test(t)&&(e=t+Oa[n])}if(i=/^(.+?)(s|t)(ion)$/,(r=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/).test(e))t=r.exec(e)?.[1],r=new RegExp(ut),t&&r.test(t)&&(e=t);else if(i.test(e)){let c=i.exec(e);t=c?.[1]??""+c?.[2]??"",(i=new RegExp(ut)).test(t)&&(e=t)}return(r=/^(.+?)e$/).test(e)&&(t=r.exec(e)?.[1],r=new RegExp(ut),i=new RegExp(Ta),o=RegExp("^"+ae+mt+"[^aeiouwxy]$"),t&&(r.test(t)||i.test(t)&&!o.test(t))&&(e=t)),r=/ll$/,i=new RegExp(ut),r.test(e)&&i.test(e)&&(r=/.$/,e=e.replace(r,"")),a=="y"&&(e=a.toLowerCase()+e.substring(1)),e}const Ra=["i","me","my","myself","we","us","our","ours","ourselves","you","your","yours","yourself","yourselves","he","him","his","himself","she","her","hers","herself","it","its","itself","they","them","their","theirs","themselves","what","which","who","whom","this","that","these","those","am","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","will","would","shall","should","can","could","may","might","must","ought","i'm","you're","he's","she's","it's","we're","they're","i've","you've","we've","they've","i'd","you'd","he'd","she'd","we'd","they'd","i'll","you'll","he'll","she'll","we'll","they'll","isn't","aren't","wasn't","weren't","hasn't","haven't","hadn't","doesn't","don't","didn't","won't","wouldn't","shan't","shouldn't","can't","cannot","couldn't","mustn't","let's","that's","who's","what's","here's","there's","when's","where's","why's","how's","an","the","and","but","if","or","because","as","until","while","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","further","then","once","here","there","when","where","why","how","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very"];function hi(e,t,n){for(let r of Object.entries(t)){let i=r[0],o=r[1],s=`${n}${n?".":""}${i}`;if(typeof o=="object"&&!Array.isArray(o)){hi(e,o,s);continue}if(_e(o))e.searchableProperties.push(s),e.searchablePropertiesWithTypes[s]=o,e.vectorIndexes[s]={type:"Vector",node:new nt(mn(o)),isArray:!1};else{let a=/\[/.test(o);switch(o){case"boolean":case"boolean[]":e.indexes[s]={type:"Bool",node:new tt,isArray:a};break;case"number":case"number[]":e.indexes[s]={type:"AVL",node:new Xe(0,[]),isArray:a};break;case"string":case"string[]":e.indexes[s]={type:"Radix",node:new et,isArray:a};break;case"enum":case"enum[]":e.indexes[s]={type:"Flat",node:new Ze,isArray:a};break;case"geopoint":e.indexes[s]={type:"BKD",node:new q,isArray:a};break;default:throw new Error("INVALID_SCHEMA_TYPE: "+s)}e.searchableProperties.push(s),e.searchablePropertiesWithTypes[s]=o}}}var xa=1048575;function Pa(e,t){let n=yi(e),r=pi(e)|1<<t;return n+1<<20|r}function fr(e,t,n,r,i,o,s){let a=e.split(/\.|\?|!/),c=0,u=0;for(let p of a){let h=s.tokenize(p,o,r);for(let y of h){u++,n[y]||(n[y]=0);let g=Math.min(c,20);n.tokenQuantums[i][y]=Pa(n.tokenQuantums[i][y],g),t.insert(y,i)}h.length>1&&c++}n.tokensLength.set(i,u)}function ka(e){let t=e.tokens,n=e.radixNode,r=e.exact,i=e.tolerance,o=e.stats,s=e.boostPerProp,a=e.resultMap,c=e.whereFiltersIDs,u=o.tokensLength,p=o.tokenQuantums,h={term:"",exact:r,tolerance:i},y={},g=t.length;for(let l=0;l<g;l++){let m=t[l];h.term=m;let b=n.find(h);y={...y,...b}}let d=Object.keys(y),f=d.length;for(let l=0;l<f;l++){let m=d[l],b=y[m],v=b.length,w=t.includes(m);for(let I=0;I<v;I++){let O=b[I];if(c&&!c.has(O))continue;let _=u.get(O),E=p[O][m],A=yi(E),C=pi(E),L=(A*A/_+(w?1:0))*s;if(!a.has(O)){a.set(O,[L,C]);continue}let z=a.get(O),K=z[0]+Na(z[1]&C)*2+L;z[0]=K,z[1]=z[1]|C}}}function pi(e){return e&xa}function yi(e){return e>>20}function Na(e){let t=0;do e&1&&++t;while(e>>=1);return t}function dr(e,t,n,r,i,o,s){let a=s.tokensLength,c=s.tokenQuantums,u=i.tokenize(e,o,n);for(let p of u)t.removeDocumentByWord(p,r,!0);a.delete(r),delete c[r]}var Da=new oe("","",!1),Ma={tokenQuantums:{},tokensLength:new Map};function La(e,t,n,r,i,o,s,a,c,u,p){let h=new Map,y={tokens:n.tokenize(t,r),radixNode:Da,exact:o,tolerance:s,stats:Ma,boostPerProp:0,resultMap:h,whereFiltersIDs:p},g=i.length;for(let m=0;m<g;m++){let b=i[m],v=e.stats[b],w=a[b]??1;y.radixNode=e.indexes[b].node,y.stats=v,y.boostPerProp=w,ka(y)}let d=Array.from(h),f=d.length,l=[];for(let m=0;m<f;m++){let b=d[m],v=b[0],w=b[1][0];l.push([v,w])}return l}function Ca(){return{name:"qps",getComponents(e){return za(e)}}}function za(e){return{index:{create:function(){let t={indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},stats:{}};return hi(t,e,""),t},insert:function(t,n,r,i,o,s,a,c,u,p){if(!(a==="string"||a==="string[]"))return ei(t,n,r,i,o,s,a,c,u,p);n.stats[r]||(n.stats[r]={tokenQuantums:{},tokensLength:new Map});let h=n.stats[r],y=n.indexes[r].node;if(h.tokenQuantums[o]={},Array.isArray(s))for(let g of s)fr(g,y,h,r,o,c,u);else fr(s,y,h,r,o,c,u)},remove:function(t,n,r,i,o,s,a,c,u,p){if(!(a==="string"||a==="string[]"))return ti(t,n,r,i,o,s,a,c,u,p);let h=n.stats[r],y=n.indexes[r].node;if(Array.isArray(s))for(let g of s)dr(g,y,r,o,u,c,h);else dr(s,y,r,o,u,c,h)},insertDocumentScoreParameters:()=>{throw new Error},insertTokenScoreParameters:()=>{throw new Error},removeDocumentScoreParameters:()=>{throw new Error},removeTokenScoreParameters:()=>{throw new Error},calculateResultScores:()=>{throw new Error},search:La,searchByWhereClause:function(t,n,r,i){let o=Object.entries(r).filter(([c])=>t.indexes[c].type==="Radix");if(o.length===0)return Te(t,n,r,i);let s;for(let[c,u]of o){let p=[];if(Array.isArray(u))for(let g of u){let d=n.tokenize(g,i)?.[0];p.push(d)}else p=n.tokenize(u,i);let h=t.indexes[c].node,y=new Set;for(let g of p){let d=h.find({term:g,exact:!0})[g];if(d)for(let f of d)y.add(f)}s?s=ht(s,y):s=y}if(Object.entries(r).filter(([c])=>t.indexes[c].type!=="Radix").length===0)return s;let a=Te(t,n,r,i);return ht(s,a)},getSearchableProperties:function(t){return t.searchableProperties},getSearchablePropertiesWithTypes:function(t){return t.searchablePropertiesWithTypes},load:function(t,n){let r=ri(t,n[0]),i=n[1],o={...r.indexes,...Object.fromEntries(i.radixTrees.map(([s,a,c,u])=>[s,{node:oe.fromJSON(u),isArray:a,type:c}]))};return{...r,indexes:o,stats:Object.fromEntries(i.stats.map(([s,{tokenQuantums:a,tokensLength:c}])=>[s,{tokenQuantums:a,tokensLength:new Map(c)}]))}},save:function(t){let n=t,r=Object.entries(n.indexes).filter(([,{type:s}])=>s!=="Radix"),i=ii({...n,indexes:Object.fromEntries(r)}),o={radixTrees:Object.entries(n.indexes).filter(([,{type:s}])=>s==="Radix").map(([s,{node:a,isArray:c,type:u}])=>[s,c,u,a.toJSON()]),stats:Object.entries(t.stats).map(([s,{tokenQuantums:a,tokensLength:c}])=>[s,{tokenQuantums:a,tokensLength:Array.from(c.entries())}])};return[i,o]}}}}const Ua={title:"string",body:"string",url:"string"};function Fa(e,...t){const n=e.docs?.docs;return n&&Object.keys(n).forEach(r=>{for(const i of t)delete n[r][i]}),e}class gt{db;constructor(){this.db=qs({schema:Ua,sort:{unsortableProperties:["body"]},plugins:[Ca()],components:{tokenizer:{stemming:!0,stemmer:Aa,stopWords:Ra}}})}static create(){return new gt}static load(t){const n=new gt;return Sa(n.db,t),n}save(){const t=Ia(this.db);return Fa(t,"body")}insert(t){wn(this.db,t)}insertMultiple(t){ea(this.db,t)}async search(t){return(await wa(this.db,{term:t,boost:{title:2},tolerance:1})).hits.map(r=>r.document)}}let Bt;async function Va(){return Bt===void 0&&(Bt=(async()=>{const t=await(await fetch("/search-index.json")).json();return gt.load(t)})()),await Bt}async function $a(e){const t=await Va();return dn.optionify(e).filter(Boolean).map(async n=>await t.search(n)).unwrapOrElse(async()=>[])}const mi=["shift","alt","meta","mod","ctrl","control"],ja={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function me(e){return(ja[e.trim()]||e.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function gi(e){return mi.includes(e)}function Wt(e,t=","){return e.toLowerCase().split(t)}function qt(e,t="+",n=">",r=!1,i){let o=[],s=!1;e=e.trim(),e.includes(n)?(s=!0,o=e.toLocaleLowerCase().split(n).map(u=>me(u))):o=e.toLocaleLowerCase().split(t).map(u=>me(u));const a={alt:o.includes("alt"),ctrl:o.includes("ctrl")||o.includes("control"),shift:o.includes("shift"),meta:o.includes("meta"),mod:o.includes("mod"),useKey:r},c=o.filter(u=>!mi.includes(u));return{...a,keys:c,description:i,isSequence:s,hotkey:e}}typeof document<"u"&&(document.addEventListener("keydown",e=>{e.code!==void 0&&vi([me(e.code)])}),document.addEventListener("keyup",e=>{e.code!==void 0&&bi([me(e.code)])})),typeof window<"u"&&(window.addEventListener("blur",()=>{fe.clear()}),window.addEventListener("contextmenu",()=>{setTimeout(()=>{fe.clear()},0)}));const fe=new Set;function En(e){return Array.isArray(e)}function Ba(e,t=","){return(En(e)?e:e.split(t)).every(n=>fe.has(n.trim().toLowerCase()))}function vi(e){const t=Array.isArray(e)?e:[e];fe.has("meta")&&fe.forEach(n=>!gi(n)&&fe.delete(n.toLowerCase())),t.forEach(n=>fe.add(n.toLowerCase()))}function bi(e){const t=Array.isArray(e)?e:[e];e==="meta"?fe.clear():t.forEach(n=>fe.delete(n.toLowerCase()))}function Wa(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function qa(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}const Ga=["input","textarea","select","searchbox","slider","spinbutton","menuitem","menuitemcheckbox","menuitemradio","option","radio","textbox"];function Ha(e){return wi(e,Ga)}function wi(e,t=!1){const{target:n,composed:r}=e;let i,o;return Ka(n)&&r?(i=e.composedPath()[0]&&e.composedPath()[0].tagName,o=e.composedPath()[0]&&e.composedPath()[0].role):(i=n&&n.tagName,o=n&&n.role),En(t)?!!(i&&t&&t.some(s=>s.toLowerCase()===i.toLowerCase()||s===o)):!!(i&&t&&t)}function Ka(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}function Ya(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(n=>t.includes(n))||e.includes("*"):!0}const Ja=(e,t,n=!1)=>{const{alt:r,meta:i,mod:o,shift:s,ctrl:a,keys:c,useKey:u}=t,{code:p,key:h,ctrlKey:y,metaKey:g,shiftKey:d,altKey:f}=e,l=me(p);if(u&&c?.length===1&&c.includes(h))return!0;if(!c?.includes(l)&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(l))return!1;if(!n){if(r!==f&&l!=="alt"||s!==d&&l!=="shift")return!1;if(o){if(!g&&!y)return!1}else if(i!==g&&l!=="meta"&&l!=="os"||a!==y&&l!=="ctrl"&&l!=="control")return!1}return c&&c.length===1&&c.includes(l)?!0:c?Ba(c):!c},Qa=R.createContext(void 0),Xa=()=>R.useContext(Qa);function _i(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce((n,r)=>n&&_i(e[r],t[r]),!0):e===t}const Za=R.createContext({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),ec=()=>R.useContext(Za);function tc(e){const t=R.useRef(void 0);return _i(t.current,e)||(t.current=e),t.current}const hr=e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},nc=typeof window<"u"?R.useLayoutEffect:R.useEffect;function Zt(e,t,n,r){const i=R.useRef(null),o=R.useRef(!1),s=Array.isArray(n)?Array.isArray(r)?void 0:r:n,a=En(e)?e.join(s?.delimiter):e,c=Array.isArray(n)?n:Array.isArray(r)?r:void 0,u=R.useCallback(t,c??[]),p=R.useRef(u);c?p.current=u:p.current=t;const h=tc(s),{activeScopes:y}=ec(),g=Xa();return nc(()=>{if(h?.enabled===!1||!Ya(y,h?.scopes))return;let d=[],f;const l=(w,I=!1)=>{if(!(Ha(w)&&!wi(w,h?.enableOnFormTags))){if(i.current!==null){const O=i.current.getRootNode();if((O instanceof Document||O instanceof ShadowRoot)&&O.activeElement!==i.current&&!i.current.contains(O.activeElement)){hr(w);return}}w.target?.isContentEditable&&!h?.enableOnContentEditable||Wt(a,h?.delimiter).forEach(O=>{if(O.includes(h?.splitKey??"+")&&O.includes(h?.sequenceSplitKey??">")){console.warn(`Hotkey ${O} contains both ${h?.splitKey??"+"} and ${h?.sequenceSplitKey??">"} which is not supported.`);return}const _=qt(O,h?.splitKey,h?.sequenceSplitKey,h?.useKey,h?.description);if(_.isSequence){f=setTimeout(()=>{d=[]},h?.sequenceTimeoutMs??1e3);const E=_.useKey?w.key:me(w.code);if(gi(E.toLowerCase()))return;d.push(E);const A=_.keys?.[d.length-1];if(E!==A){d=[],f&&clearTimeout(f);return}d.length===_.keys?.length&&(p.current(w,_),f&&clearTimeout(f),d=[])}else if(Ja(w,_,h?.ignoreModifiers)||_.keys?.includes("*")){if(h?.ignoreEventWhen?.(w)||I&&o.current)return;if(Wa(w,_,h?.preventDefault),!qa(w,_,h?.enabled)){hr(w);return}p.current(w,_),I||(o.current=!0)}})}},m=w=>{w.code!==void 0&&(vi(me(w.code)),(h?.keydown===void 0&&h?.keyup!==!0||h?.keydown)&&l(w))},b=w=>{w.code!==void 0&&(bi(me(w.code)),o.current=!1,h?.keyup&&l(w,!0))},v=i.current||s?.document||document;return v.addEventListener("keyup",b,s?.eventListenerOptions),v.addEventListener("keydown",m,s?.eventListenerOptions),g&&Wt(a,h?.delimiter).forEach(w=>g.addHotkey(qt(w,h?.splitKey,h?.sequenceSplitKey,h?.useKey,h?.description))),()=>{v.removeEventListener("keyup",b,s?.eventListenerOptions),v.removeEventListener("keydown",m,s?.eventListenerOptions),g&&Wt(a,h?.delimiter).forEach(w=>g.removeHotkey(qt(w,h?.splitKey,h?.sequenceSplitKey,h?.useKey,h?.description))),d=[],f&&clearTimeout(f)}},[a,h,y]),i}function rc(e){return t=>{for(const n of e)en(n,t)}}function ic(e){return t=>{const n=[];for(const r of e){const i=en(r,t),o=typeof i=="function";n.push(o?i:()=>en(r,null))}return()=>{for(const r of n)r()}}}function en(e,t){if(typeof e=="function")return e(t);e&&(e.current=t)}var oc=parseInt(R.version.split(".")[0],10)>=19?ic:rc;function Me(e,t){var n=t===void 0?{type:e}:{type:e,payload:t};return n}function sc(e){window.location.assign(e)}var be=(e=>(e.SET_QUERY="SET_QUERY",e.SET_RESULTS="SET_RESULTS",e.NEXT_SELECTION="NEXT_SELECTION",e.PREVIOUS_SELECTION="PREVIOUS_SELECTION",e.RESET="RESET",e))(be||{});const Ie={setQuery:e=>Me("SET_QUERY",e),setResults:e=>Me("SET_RESULTS",e),nextSelection:()=>Me("NEXT_SELECTION"),previousSelection:()=>Me("PREVIOUS_SELECTION"),reset:()=>Me("RESET")};function ac(e,t){dn.optionify(t[e.current]).map(n=>sc(n.url))}class cc{constructor(t,n){this.dispatch=t,this.api=n}query=async t=>{this.dispatch(Ie.setQuery(t)),(await dn.resultify(this.api(t))).ok().map(n=>this.dispatch(Ie.setResults(n)))}}function On(e,t){return(n=t,r=void 0)=>{const i=r===void 0?void 0:e[r.type];return r!==void 0&&i!==null&&i!==void 0?i(n,r):n}}function uc(e){return(t,n)=>{const r=t??{},i={};let o=!1;for(const s in e)if(Object.hasOwn(e,s)){const a=r[s],c=e[s](a,n);i[s]=c,o=o||a!==c}return o?i:r}}const lc=On({[be.SET_QUERY]:(e,t)=>t.payload},""),fc=On({[be.SET_RESULTS]:(e,t)=>t.payload},[]),dc=On({[be.NEXT_SELECTION]:e=>({...e,current:Math.min(e.current+1,e.max)}),[be.PREVIOUS_SELECTION]:e=>({...e,current:Math.max(e.current-1,0)}),[be.SET_RESULTS]:(e,t)=>{const n=t?Math.max(t.payload.length-1,0):0;return{...e,current:Math.min(e.current,n),max:n}}},{current:0,max:0}),hc=uc({query:lc,results:fc,selection:dc});function pc(e,t){return t&&t.type===be.RESET?void 0:e}function pr(e,t){const n=pc(e,t);return hc(n,t)}const yc=({value:e,onChange:t})=>{const n=R.useRef(null);return Zt("mod+k",()=>n.current?.focus()),X.jsx("input",{className:`
        w-full
        bg-transparent
        border
        border-accent
        rounded-sm
        text-background
        m-0
        outline-none
        py-1
        px-3
        transition-colors
        duration-500
        focus:bg-background
        focus:border-transparent
        focus:text-primary
        hover:bg-background
        hover:border-transparent
        hover:text-primary
        not-placeholder-shown:bg-background
        not-placeholder-shown:text-primary
      `,ref:n,type:"search",name:"query",placeholder:"Search",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:e,onChange:r=>t(r.target.value),onFocus:()=>setTimeout(()=>n.current?.select())})};var Si=(function(){if(typeof Map<"u")return Map;function e(t,n){var r=-1;return t.some(function(i,o){return i[0]===n?(r=o,!0):!1}),r}return(function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(n,r){var i=e(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,i=e(r,n);~i&&r.splice(i,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var s=o[i];n.call(r,s[1],s[0])}},t})()})(),tn=typeof window<"u"&&typeof document<"u"&&window.document===document,vt=(function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()})(),mc=(function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(vt):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}})(),gc=2;function vc(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&a()}function s(){mc(o)}function a(){var c=Date.now();if(n){if(c-i<gc)return;r=!0}else n=!0,r=!1,setTimeout(s,t);i=c}return a}var bc=20,wc=["top","right","bottom","left","width","height","size","weight"],_c=typeof MutationObserver<"u",Sc=(function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=vc(this.refresh.bind(this),bc)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,r=n.indexOf(t);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!tn||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),_c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!tn||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,r=n===void 0?"":n,i=wc.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e})(),Ii=(function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e}),Pe=(function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||vt}),Ei=At(0,0,0,0);function bt(e){return parseFloat(e)||0}function yr(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(r,i){var o=e["border-"+i+"-width"];return r+bt(o)},0)}function Ic(e){for(var t=["top","right","bottom","left"],n={},r=0,i=t;r<i.length;r++){var o=i[r],s=e["padding-"+o];n[o]=bt(s)}return n}function Ec(e){var t=e.getBBox();return At(0,0,t.width,t.height)}function Oc(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Ei;var r=Pe(e).getComputedStyle(e),i=Ic(r),o=i.left+i.right,s=i.top+i.bottom,a=bt(r.width),c=bt(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+o)!==t&&(a-=yr(r,"left","right")+o),Math.round(c+s)!==n&&(c-=yr(r,"top","bottom")+s)),!Ac(e)){var u=Math.round(a+o)-t,p=Math.round(c+s)-n;Math.abs(u)!==1&&(a-=u),Math.abs(p)!==1&&(c-=p)}return At(i.left,i.top,a,c)}var Tc=(function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Pe(e).SVGGraphicsElement}:function(e){return e instanceof Pe(e).SVGElement&&typeof e.getBBox=="function"}})();function Ac(e){return e===Pe(e).document.documentElement}function Rc(e){return tn?Tc(e)?Ec(e):Oc(e):Ei}function xc(e){var t=e.x,n=e.y,r=e.width,i=e.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(o.prototype);return Ii(s,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),s}function At(e,t,n,r){return{x:e,y:t,width:n,height:r}}var Pc=(function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=At(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=Rc(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e})(),kc=(function(){function e(t,n){var r=xc(n);Ii(this,{target:t,contentRect:r})}return e})(),Nc=(function(){function e(t,n,r){if(this.activeObservations_=[],this.observations_=new Si,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Pe(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new Pc(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Pe(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new kc(r.target,r.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e})(),Oi=typeof WeakMap<"u"?new WeakMap:new Si,Ti=(function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Sc.getInstance(),r=new Nc(t,n,this);Oi.set(this,r)}return e})();["observe","unobserve","disconnect"].forEach(function(e){Ti.prototype[e]=function(){var t;return(t=Oi.get(this))[e].apply(t,arguments)}});var Dc=(function(){return typeof vt.ResizeObserver<"u"?vt.ResizeObserver:Ti})();function Mc(){const e=R.useRef(null),[t,n]=R.useState({left:0,top:0,width:0,height:0}),[r]=R.useState(()=>new Dc(([i])=>n(i.contentRect)));return R.useEffect(()=>(e.current&&r.observe(e.current),()=>r.disconnect()),[r]),[{ref:e},t]}var Tn=it(),x=e=>rt(e,Tn),An=it();x.write=e=>rt(e,An);var Rt=it();x.onStart=e=>rt(e,Rt);var Rn=it();x.onFrame=e=>rt(e,Rn);var xn=it();x.onFinish=e=>rt(e,xn);var Ae=[];x.setTimeout=(e,t)=>{const n=x.now()+t,r=()=>{const o=Ae.findIndex(s=>s.cancel==r);~o&&Ae.splice(o,1),ye-=~o?1:0},i={time:n,handler:e,cancel:r};return Ae.splice(Ai(n),0,i),ye+=1,Ri(),i};var Ai=e=>~(~Ae.findIndex(t=>t.time>e)||~Ae.length);x.cancel=e=>{Rt.delete(e),Rn.delete(e),xn.delete(e),Tn.delete(e),An.delete(e)};x.sync=e=>{nn=!0,x.batchedUpdates(e),nn=!1};x.throttle=e=>{let t;function n(){try{e(...t)}finally{t=null}}function r(...i){t=i,x.onStart(n)}return r.handler=e,r.cancel=()=>{Rt.delete(n),t=null},r};var Pn=typeof window<"u"?window.requestAnimationFrame:(()=>{});x.use=e=>Pn=e;x.now=typeof performance<"u"?()=>performance.now():Date.now;x.batchedUpdates=e=>e();x.catch=console.error;x.frameLoop="always";x.advance=()=>{x.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Pi()};var pe=-1,ye=0,nn=!1;function rt(e,t){nn?(t.delete(e),e(0)):(t.add(e),Ri())}function Ri(){pe<0&&(pe=0,x.frameLoop!=="demand"&&Pn(xi))}function Lc(){pe=-1}function xi(){~pe&&(Pn(xi),x.batchedUpdates(Pi))}function Pi(){const e=pe;pe=x.now();const t=Ai(pe);if(t&&(ki(Ae.splice(0,t),n=>n.handler()),ye-=t),!ye){Lc();return}Rt.flush(),Tn.flush(e?Math.min(64,pe-e):16.667),Rn.flush(),An.flush(),xn.flush()}function it(){let e=new Set,t=e;return{add(n){ye+=t==e&&!e.has(n)?1:0,e.add(n)},delete(n){return ye-=t==e&&e.has(n)?1:0,e.delete(n)},flush(n){t.size&&(e=new Set,ye-=t.size,ki(t,r=>r(n)&&e.add(r)),ye+=e.size,t=e)}}}function ki(e,t){e.forEach(n=>{try{t(n)}catch(r){x.catch(r)}})}var Cc=Object.defineProperty,zc=(e,t)=>{for(var n in t)Cc(e,n,{get:t[n],enumerable:!0})},re={};zc(re,{assign:()=>Fc,colors:()=>ge,createStringInterpolator:()=>Nn,skipAnimation:()=>Di,to:()=>Ni,willAdvance:()=>Dn});function rn(){}var Uc=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}),S={arr:Array.isArray,obj:e=>!!e&&e.constructor.name==="Object",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",und:e=>e===void 0};function le(e,t){if(S.arr(e)){if(!S.arr(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e===t}var k=(e,t)=>e.forEach(t);function ce(e,t,n){if(S.arr(e)){for(let r=0;r<e.length;r++)t.call(n,e[r],`${r}`);return}for(const r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r)}var W=e=>S.und(e)?[]:S.arr(e)?e:[e];function Fe(e,t){if(e.size){const n=Array.from(e);e.clear(),k(n,t)}}var Ue=(e,...t)=>Fe(e,n=>n(...t)),kn=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Nn,Ni,ge=null,Di=!1,Dn=rn,Fc=e=>{e.to&&(Ni=e.to),e.now&&(x.now=e.now),e.colors!==void 0&&(ge=e.colors),e.skipAnimation!=null&&(Di=e.skipAnimation),e.createStringInterpolator&&(Nn=e.createStringInterpolator),e.requestAnimationFrame&&x.use(e.requestAnimationFrame),e.batchedUpdates&&(x.batchedUpdates=e.batchedUpdates),e.willAdvance&&(Dn=e.willAdvance),e.frameLoop&&(x.frameLoop=e.frameLoop)},Ve=new Set,Q=[],Gt=[],wt=0,xt={get idle(){return!Ve.size&&!Q.length},start(e){wt>e.priority?(Ve.add(e),x.onStart(Vc)):(Mi(e),x(on))},advance:on,sort(e){if(wt)x.onFrame(()=>xt.sort(e));else{const t=Q.indexOf(e);~t&&(Q.splice(t,1),Li(e))}},clear(){Q=[],Ve.clear()}};function Vc(){Ve.forEach(Mi),Ve.clear(),x(on)}function Mi(e){Q.includes(e)||Li(e)}function Li(e){Q.splice($c(Q,t=>t.priority>e.priority),0,e)}function on(e){const t=Gt;for(let n=0;n<Q.length;n++){const r=Q[n];wt=r.priority,r.idle||(Dn(r),r.advance(e),r.idle||t.push(r))}return wt=0,Gt=Q,Gt.length=0,Q=t,Q.length>0}function $c(e,t){const n=e.findIndex(t);return n<0?e.length:n}var jc={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},ne="[-+]?\\d*\\.?\\d+",_t=ne+"%";function Pt(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var Bc=new RegExp("rgb"+Pt(ne,ne,ne)),Wc=new RegExp("rgba"+Pt(ne,ne,ne,ne)),qc=new RegExp("hsl"+Pt(ne,_t,_t)),Gc=new RegExp("hsla"+Pt(ne,_t,_t,ne)),Hc=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Kc=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Yc=/^#([0-9a-fA-F]{6})$/,Jc=/^#([0-9a-fA-F]{8})$/;function Qc(e){let t;return typeof e=="number"?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=Yc.exec(e))?parseInt(t[1]+"ff",16)>>>0:ge&&ge[e]!==void 0?ge[e]:(t=Bc.exec(e))?(Se(t[1])<<24|Se(t[2])<<16|Se(t[3])<<8|255)>>>0:(t=Wc.exec(e))?(Se(t[1])<<24|Se(t[2])<<16|Se(t[3])<<8|vr(t[4]))>>>0:(t=Hc.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=Jc.exec(e))?parseInt(t[1],16)>>>0:(t=Kc.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=qc.exec(e))?(mr(gr(t[1]),lt(t[2]),lt(t[3]))|255)>>>0:(t=Gc.exec(e))?(mr(gr(t[1]),lt(t[2]),lt(t[3]))|vr(t[4]))>>>0:null}function Ht(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function mr(e,t,n){const r=n<.5?n*(1+t):n+t-n*t,i=2*n-r,o=Ht(i,r,e+1/3),s=Ht(i,r,e),a=Ht(i,r,e-1/3);return Math.round(o*255)<<24|Math.round(s*255)<<16|Math.round(a*255)<<8}function Se(e){const t=parseInt(e,10);return t<0?0:t>255?255:t}function gr(e){return(parseFloat(e)%360+360)%360/360}function vr(e){const t=parseFloat(e);return t<0?0:t>1?255:Math.round(t*255)}function lt(e){const t=parseFloat(e);return t<0?0:t>100?1:t/100}function br(e){let t=Qc(e);if(t===null)return e;t=t||0;const n=(t&4278190080)>>>24,r=(t&16711680)>>>16,i=(t&65280)>>>8,o=(t&255)/255;return`rgba(${n}, ${r}, ${i}, ${o})`}var qe=(e,t,n)=>{if(S.fun(e))return e;if(S.arr(e))return qe({range:e,output:t,extrapolate:n});if(S.str(e.output[0]))return Nn(e);const r=e,i=r.output,o=r.range||[0,1],s=r.extrapolateLeft||r.extrapolate||"extend",a=r.extrapolateRight||r.extrapolate||"extend",c=r.easing||(u=>u);return u=>{const p=Zc(u,o);return Xc(u,o[p],o[p+1],i[p],i[p+1],c,s,a,r.map)}};function Xc(e,t,n,r,i,o,s,a,c){let u=c?c(e):e;if(u<t){if(s==="identity")return u;s==="clamp"&&(u=t)}if(u>n){if(a==="identity")return u;a==="clamp"&&(u=n)}return r===i?r:t===n?e<=t?r:i:(t===-1/0?u=-u:n===1/0?u=u-t:u=(u-t)/(n-t),u=o(u),r===-1/0?u=-u:i===1/0?u=u+r:u=u*(i-r)+r,u)}function Zc(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}var eu={linear:e=>e},Ge=Symbol.for("FluidValue.get"),ke=Symbol.for("FluidValue.observers"),J=e=>!!(e&&e[Ge]),G=e=>e&&e[Ge]?e[Ge]():e,wr=e=>e[ke]||null;function tu(e,t){e.eventObserved?e.eventObserved(t):e(t)}function He(e,t){const n=e[ke];n&&n.forEach(r=>{tu(r,t)})}var Ci=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");nu(this,e)}},nu=(e,t)=>zi(e,Ge,t);function Ne(e,t){if(e[Ge]){let n=e[ke];n||zi(e,ke,n=new Set),n.has(t)||(n.add(t),e.observerAdded&&e.observerAdded(n.size,t))}return t}function Ke(e,t){const n=e[ke];if(n&&n.has(t)){const r=n.size-1;r?n.delete(t):e[ke]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var zi=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}),ft=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,ru=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,_r=new RegExp(`(${ft.source})(%|[a-z]+)`,"i"),iu=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,kt=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Ui=e=>{const[t,n]=ou(e);if(!t||kn())return e;const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(r)return r.trim();if(n&&n.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(n);return i||e}else{if(n&&kt.test(n))return Ui(n);if(n)return n}return e},ou=e=>{const t=kt.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]},Kt,su=(e,t,n,r,i)=>`rgba(${Math.round(t)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,Fi=e=>{Kt||(Kt=ge?new RegExp(`(${Object.keys(ge).join("|")})(?!\\w)`,"g"):/^\b$/);const t=e.output.map(o=>G(o).replace(kt,Ui).replace(ru,br).replace(Kt,br)),n=t.map(o=>o.match(ft).map(Number)),i=n[0].map((o,s)=>n.map(a=>{if(!(s in a))throw Error('The arity of each "output" value must be equal');return a[s]})).map(o=>qe({...e,output:o}));return o=>{const s=!_r.test(t[0])&&t.find(c=>_r.test(c))?.replace(ft,"");let a=0;return t[0].replace(ft,()=>`${i[a++](o)}${s||""}`).replace(iu,su)}},Mn="react-spring: ",Vi=e=>{const t=e;let n=!1;if(typeof t!="function")throw new TypeError(`${Mn}once requires a function parameter`);return(...r)=>{n||(t(...r),n=!0)}},au=Vi(console.warn);function cu(){au(`${Mn}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var uu=Vi(console.warn);function lu(){uu(`${Mn}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function Nt(e){return S.str(e)&&(e[0]=="#"||/\d/.test(e)||!kn()&&kt.test(e)||e in(ge||{}))}var Ee=kn()?R.useEffect:R.useLayoutEffect,fu=()=>{const e=R.useRef(!1);return Ee(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function $i(){const e=R.useState()[1],t=fu();return()=>{t.current&&e(Math.random())}}var ji=e=>R.useEffect(e,du),du=[];function hu(e){const t=R.useRef(void 0);return R.useEffect(()=>{t.current=e}),t.current}var Ye=Symbol.for("Animated:node"),pu=e=>!!e&&e[Ye]===e,ie=e=>e&&e[Ye],Ln=(e,t)=>Uc(e,Ye,t),Dt=e=>e&&e[Ye]&&e[Ye].getPayload(),Bi=class{constructor(){Ln(this,this)}getPayload(){return this.payload||[]}},Mt=class Wi extends Bi{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,S.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new Wi(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,n){return S.num(t)&&(this.lastPosition=t,n&&(t=Math.round(t/n)*n,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,S.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},St=class qi extends Mt{constructor(t){super(0),this._string=null,this._toString=qe({output:[t,t]})}static create(t){return new qi(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(S.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=qe({output:[this.getValue(),t]})),this._value=0,super.reset()}},It={dependencies:null},Lt=class extends Bi{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const t={};return ce(this.source,(n,r)=>{pu(n)?t[r]=n.getValue(e):J(n)?t[r]=G(n):e||(t[r]=n)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&k(this.payload,e=>e.reset())}_makePayload(e){if(e){const t=new Set;return ce(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){It.dependencies&&J(e)&&It.dependencies.add(e);const t=Dt(e);t&&k(t,n=>this.add(n))}},yu=class Gi extends Lt{constructor(t){super(t)}static create(t){return new Gi(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const n=this.getPayload();return t.length==n.length?n.map((r,i)=>r.setValue(t[i])).some(Boolean):(super.setValue(t.map(mu)),!0)}};function mu(e){return(Nt(e)?St:Mt).create(e)}function sn(e){const t=ie(e);return t?t.constructor:S.arr(e)?yu:Nt(e)?St:Mt}var Sr=(e,t)=>{const n=!S.fun(e)||e.prototype&&e.prototype.isReactComponent;return R.forwardRef((r,i)=>{const o=R.useRef(null),s=n&&R.useCallback(d=>{o.current=bu(i,d)},[i]),[a,c]=vu(r,t),u=$i(),p=()=>{const d=o.current;if(n&&!d)return;(d?t.applyAnimatedValues(d,a.getValue(!0)):!1)===!1&&u()},h=new gu(p,c),y=R.useRef(void 0);Ee(()=>(y.current=h,k(c,d=>Ne(d,h)),()=>{y.current&&(k(y.current.deps,d=>Ke(d,y.current)),x.cancel(y.current.update))})),R.useEffect(p,[]),ji(()=>()=>{const d=y.current;k(d.deps,f=>Ke(f,d))});const g=t.getComponentProps(a.getValue());return R.createElement(e,{...g,ref:s})})},gu=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){e.type=="change"&&x.write(this.update)}};function vu(e,t){const n=new Set;return It.dependencies=n,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new Lt(e),It.dependencies=null,[e,n]}function bu(e,t){return e&&(S.fun(e)?e(t):e.current=t),t}var Ir=Symbol.for("AnimatedComponent"),wu=(e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:n=i=>new Lt(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:t,createAnimatedStyle:n,getComponentProps:r},o=s=>{const a=Er(s)||"Anonymous";return S.str(s)?s=o[s]||(o[s]=Sr(s,i)):s=s[Ir]||(s[Ir]=Sr(s,i)),s.displayName=`Animated(${a})`,s};return ce(e,(s,a)=>{S.arr(e)&&(a=Er(s)),o[a]=o(s)}),{animated:o}},Er=e=>S.str(e)?e:e&&S.str(e.displayName)?e.displayName:S.fun(e)&&e.name||null;function H(e,...t){return S.fun(e)?e(...t):e}var $e=(e,t)=>e===!0||!!(t&&e&&(S.fun(e)?e(t):W(e).includes(t))),Hi=(e,t)=>S.obj(e)?t&&e[t]:e,Ki=(e,t)=>e.default===!0?e[t]:e.default?e.default[t]:void 0,_u=e=>e,Cn=(e,t=_u)=>{let n=Su;e.default&&e.default!==!0&&(e=e.default,n=Object.keys(e));const r={};for(const i of n){const o=t(e[i],i);S.und(o)||(r[i]=o)}return r},Su=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Iu={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Eu(e){const t={};let n=0;if(ce(e,(r,i)=>{Iu[i]||(t[i]=r,n++)}),n)return t}function zn(e){const t=Eu(e);if(t){const n={to:t};return ce(e,(r,i)=>i in t||(n[i]=r)),n}return{...e}}function Je(e){return e=G(e),S.arr(e)?e.map(Je):Nt(e)?re.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function Ou(e){for(const t in e)return!0;return!1}function an(e){return S.fun(e)||S.arr(e)&&S.obj(e[0])}function Or(e,t){e.ref?.delete(e),t?.delete(e)}function Tu(e,t){t&&e.ref!==t&&(e.ref?.delete(e),t.add(e),e.ref=t)}var Au={default:{tension:170,friction:26}},cn={...Au.default,mass:1,damping:1,easing:eu.linear,clamp:!1},Ru=class{constructor(){this.velocity=0,Object.assign(this,cn)}};function xu(e,t,n){n&&(n={...n},Tr(n,t),t={...n,...t}),Tr(e,t),Object.assign(e,t);for(const s in cn)e[s]==null&&(e[s]=cn[s]);let{frequency:r,damping:i}=e;const{mass:o}=e;return S.und(r)||(r<.01&&(r=.01),i<0&&(i=0),e.tension=Math.pow(2*Math.PI/r,2)*o,e.friction=4*Math.PI*i*o/r),e}function Tr(e,t){if(!S.und(t.decay))e.duration=void 0;else{const n=!S.und(t.tension)||!S.und(t.friction);(n||!S.und(t.frequency)||!S.und(t.damping)||!S.und(t.mass))&&(e.duration=void 0,e.decay=void 0),n&&(e.frequency=void 0)}}var Ar=[],Pu=class{constructor(){this.changed=!1,this.values=Ar,this.toValues=null,this.fromValues=Ar,this.config=new Ru,this.immediate=!1}};function Yi(e,{key:t,props:n,defaultProps:r,state:i,actions:o}){return new Promise((s,a)=>{let c,u,p=$e(n.cancel??r?.cancel,t);if(p)g();else{S.und(n.pause)||(i.paused=$e(n.pause,t));let d=r?.pause;d!==!0&&(d=i.paused||$e(d,t)),c=H(n.delay||0,t),d?(i.resumeQueue.add(y),o.pause()):(o.resume(),y())}function h(){i.resumeQueue.add(y),i.timeouts.delete(u),u.cancel(),c=u.time-x.now()}function y(){c>0&&!re.skipAnimation?(i.delayed=!0,u=x.setTimeout(g,c),i.pauseQueue.add(h),i.timeouts.add(u)):g()}function g(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(h),i.timeouts.delete(u),e<=(i.cancelId||0)&&(p=!0);try{o.start({...n,callId:e,cancel:p},s)}catch(d){a(d)}}})}var Un=(e,t)=>t.length==1?t[0]:t.some(n=>n.cancelled)?Re(e.get()):t.every(n=>n.noop)?Ji(e.get()):te(e.get(),t.every(n=>n.finished)),Ji=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),te=(e,t,n=!1)=>({value:e,finished:t,cancelled:n}),Re=e=>({value:e,cancelled:!0,finished:!1});function Qi(e,t,n,r){const{callId:i,parentId:o,onRest:s}=t,{asyncTo:a,promise:c}=n;return!o&&e===a&&!t.reset?c:n.promise=(async()=>{n.asyncId=i,n.asyncTo=e;const u=Cn(t,(l,m)=>m==="onRest"?void 0:l);let p,h;const y=new Promise((l,m)=>(p=l,h=m)),g=l=>{const m=i<=(n.cancelId||0)&&Re(r)||i!==n.asyncId&&te(r,!1);if(m)throw l.result=m,h(l),l},d=(l,m)=>{const b=new Rr,v=new xr;return(async()=>{if(re.skipAnimation)throw Qe(n),v.result=te(r,!1),h(v),v;g(b);const w=S.obj(l)?{...l}:{...m,to:l};w.parentId=i,ce(u,(O,_)=>{S.und(w[_])&&(w[_]=O)});const I=await r.start(w);return g(b),n.paused&&await new Promise(O=>{n.resumeQueue.add(O)}),I})()};let f;if(re.skipAnimation)return Qe(n),te(r,!1);try{let l;S.arr(e)?l=(async m=>{for(const b of m)await d(b)})(e):l=Promise.resolve(e(d,r.stop.bind(r))),await Promise.all([l.then(p),y]),f=te(r.get(),!0,!1)}catch(l){if(l instanceof Rr)f=l.result;else if(l instanceof xr)f=l.result;else throw l}finally{i==n.asyncId&&(n.asyncId=o,n.asyncTo=o?a:void 0,n.promise=o?c:void 0)}return S.fun(s)&&x.batchedUpdates(()=>{s(f,r,r.item)}),f})()}function Qe(e,t){Fe(e.timeouts,n=>n.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var Rr=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},xr=class extends Error{constructor(){super("SkipAnimationSignal")}},un=e=>e instanceof Fn,ku=1,Fn=class extends Ci{constructor(){super(...arguments),this.id=ku++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=ie(this);return e&&e.getValue()}to(...e){return re.to(this,e)}interpolate(...e){return cu(),re.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){He(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||xt.sort(this),He(this,{type:"priority",parent:this,priority:e})}},we=Symbol.for("SpringPhase"),Xi=1,ln=2,fn=4,Yt=e=>(e[we]&Xi)>0,he=e=>(e[we]&ln)>0,Le=e=>(e[we]&fn)>0,Pr=(e,t)=>t?e[we]|=ln|Xi:e[we]&=~ln,kr=(e,t)=>t?e[we]|=fn:e[we]&=~fn,Nu=class extends Fn{constructor(e,t){if(super(),this.animation=new Pu,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!S.und(e)||!S.und(t)){const n=S.obj(e)?{...e}:{...t,from:e};S.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(he(this)||this._state.asyncTo)||Le(this)}get goal(){return G(this.animation.to)}get velocity(){const e=ie(this);return e instanceof Mt?e.lastVelocity||0:e.getPayload().map(t=>t.lastVelocity||0)}get hasAnimated(){return Yt(this)}get isAnimating(){return he(this)}get isPaused(){return Le(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,n=!1;const r=this.animation;let{toValues:i}=r;const{config:o}=r,s=Dt(r.to);!s&&J(r.to)&&(i=W(G(r.to))),r.values.forEach((u,p)=>{if(u.done)return;const h=u.constructor==St?1:s?s[p].lastPosition:i[p];let y=r.immediate,g=h;if(!y){if(g=u.lastPosition,o.tension<=0){u.done=!0;return}let d=u.elapsedTime+=e;const f=r.fromValues[p],l=u.v0!=null?u.v0:u.v0=S.arr(o.velocity)?o.velocity[p]:o.velocity;let m;const b=o.precision||(f==h?.005:Math.min(1,Math.abs(h-f)*.001));if(S.und(o.duration))if(o.decay){const v=o.decay===!0?.998:o.decay,w=Math.exp(-(1-v)*d);g=f+l/(1-v)*(1-w),y=Math.abs(u.lastPosition-g)<=b,m=l*w}else{m=u.lastVelocity==null?l:u.lastVelocity;const v=o.restVelocity||b/10,w=o.clamp?0:o.bounce,I=!S.und(w),O=f==h?u.v0>0:f<h;let _,E=!1;const A=1,C=Math.ceil(e/A);for(let L=0;L<C&&(_=Math.abs(m)>v,!(!_&&(y=Math.abs(h-g)<=b,y)));++L){I&&(E=g==h||g>h==O,E&&(m=-m*w,g=h));const z=-o.tension*1e-6*(g-h),K=-o.friction*.001*m,T=(z+K)/o.mass;m=m+T*A,g=g+m*A}}else{let v=1;o.duration>0&&(this._memoizedDuration!==o.duration&&(this._memoizedDuration=o.duration,u.durationProgress>0&&(u.elapsedTime=o.duration*u.durationProgress,d=u.elapsedTime+=e)),v=(o.progress||0)+d/this._memoizedDuration,v=v>1?1:v<0?0:v,u.durationProgress=v),g=f+o.easing(v)*(h-f),m=(g-u.lastPosition)/e,y=v==1}u.lastVelocity=m,Number.isNaN(g)&&(console.warn("Got NaN while animating:",this),y=!0)}s&&!s[p].done&&(y=!1),y?u.done=!0:t=!1,u.setValue(g,o.round)&&(n=!0)});const a=ie(this),c=a.getValue();if(t){const u=G(r.to);(c!==u||n)&&!o.decay?(a.setValue(u),this._onChange(u)):n&&o.decay&&this._onChange(c),this._stop()}else n&&this._onChange(c)}set(e){return x.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(he(this)){const{to:e,config:t}=this.animation;x.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let n;return S.und(e)?(n=this.queue||[],this.queue=[]):n=[S.obj(e)?e:{...t,to:e}],Promise.all(n.map(r=>this._update(r))).then(r=>Un(this,r))}stop(e){const{to:t}=this.animation;return this._focus(this.get()),Qe(this._state,e&&this._lastCallId),x.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){e.type=="change"?this._start():e.type=="priority"&&(this.priority=e.priority+1)}_prepareNode(e){const t=this.key||"";let{to:n,from:r}=e;n=S.obj(n)?n[t]:n,(n==null||an(n))&&(n=void 0),r=S.obj(r)?r[t]:r,r==null&&(r=void 0);const i={to:n,from:r};return Yt(this)||(e.reverse&&([n,r]=[r,n]),r=G(r),S.und(r)?ie(this)||this._set(n):this._set(r)),i}_update({...e},t){const{key:n,defaultProps:r}=this;e.default&&Object.assign(r,Cn(e,(s,a)=>/^on/.test(a)?Hi(s,n):s)),Dr(this,e,"onProps"),ze(this,"onProps",e,this);const i=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const o=this._state;return Yi(++this._lastCallId,{key:n,props:e,defaultProps:r,state:o,actions:{pause:()=>{Le(this)||(kr(this,!0),Ue(o.pauseQueue),ze(this,"onPause",te(this,Ce(this,this.animation.to)),this))},resume:()=>{Le(this)&&(kr(this,!1),he(this)&&this._resume(),Ue(o.resumeQueue),ze(this,"onResume",te(this,Ce(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then(s=>{if(e.loop&&s.finished&&!(t&&s.noop)){const a=Zi(e);if(a)return this._update(a,!0)}return s})}_merge(e,t,n){if(t.cancel)return this.stop(!0),n(Re(this));const r=!S.und(e.to),i=!S.und(e.from);if(r||i)if(t.callId>this._lastToId)this._lastToId=t.callId;else return n(Re(this));const{key:o,defaultProps:s,animation:a}=this,{to:c,from:u}=a;let{to:p=c,from:h=u}=e;i&&!r&&(!t.default||S.und(p))&&(p=h),t.reverse&&([p,h]=[h,p]);const y=!le(h,u);y&&(a.from=h),h=G(h);const g=!le(p,c);g&&this._focus(p);const d=an(t.to),{config:f}=a,{decay:l,velocity:m}=f;(r||i)&&(f.velocity=0),t.config&&!d&&xu(f,H(t.config,o),t.config!==s.config?H(s.config,o):void 0);let b=ie(this);if(!b||S.und(p))return n(te(this,!0));const v=S.und(t.reset)?i&&!t.default:!S.und(h)&&$e(t.reset,o),w=v?h:this.get(),I=Je(p),O=S.num(I)||S.arr(I)||Nt(I),_=!d&&(!O||$e(s.immediate||t.immediate,o));if(g){const L=sn(p);if(L!==b.constructor)if(_)b=this._set(I);else throw Error(`Cannot animate between ${b.constructor.name} and ${L.name}, as the "to" prop suggests`)}const E=b.constructor;let A=J(p),C=!1;if(!A){const L=v||!Yt(this)&&y;(g||L)&&(C=le(Je(w),I),A=!C),(!le(a.immediate,_)&&!_||!le(f.decay,l)||!le(f.velocity,m))&&(A=!0)}if(C&&he(this)&&(a.changed&&!v?A=!0:A||this._stop(c)),!d&&((A||J(c))&&(a.values=b.getPayload(),a.toValues=J(p)?null:E==St?[1]:W(I)),a.immediate!=_&&(a.immediate=_,!_&&!v&&this._set(c)),A)){const{onRest:L}=a;k(Du,K=>Dr(this,t,K));const z=te(this,Ce(this,c));Ue(this._pendingCalls,z),this._pendingCalls.add(n),a.changed&&x.batchedUpdates(()=>{a.changed=!v,L?.(z,this),v?H(s.onRest,z):a.onStart?.(z,this)})}v&&this._set(w),d?n(Qi(t.to,t,this._state,this)):A?this._start():he(this)&&!g?this._pendingCalls.add(n):n(Ji(w))}_focus(e){const t=this.animation;e!==t.to&&(wr(this)&&this._detach(),t.to=e,wr(this)&&this._attach())}_attach(){let e=0;const{to:t}=this.animation;J(t)&&(Ne(t,this),un(t)&&(e=t.priority+1)),this.priority=e}_detach(){const{to:e}=this.animation;J(e)&&Ke(e,this)}_set(e,t=!0){const n=G(e);if(!S.und(n)){const r=ie(this);if(!r||!le(n,r.getValue())){const i=sn(n);!r||r.constructor!=i?Ln(this,i.create(n)):r.setValue(n),r&&x.batchedUpdates(()=>{this._onChange(n,t)})}}return ie(this)}_onStart(){const e=this.animation;e.changed||(e.changed=!0,ze(this,"onStart",te(this,Ce(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),H(this.animation.onChange,e,this)),H(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){const e=this.animation;ie(this).reset(G(e.to)),e.immediate||(e.fromValues=e.values.map(t=>t.lastPosition)),he(this)||(Pr(this,!0),Le(this)||this._resume())}_resume(){re.skipAnimation?this.finish():xt.start(this)}_stop(e,t){if(he(this)){Pr(this,!1);const n=this.animation;k(n.values,i=>{i.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),He(this,{type:"idle",parent:this});const r=t?Re(this.get()):te(this.get(),Ce(this,e??n.to));Ue(this._pendingCalls,r),n.changed&&(n.changed=!1,ze(this,"onRest",r,this))}}};function Ce(e,t){const n=Je(t),r=Je(e.get());return le(r,n)}function Zi(e,t=e.loop,n=e.to){const r=H(t);if(r){const i=r!==!0&&zn(r),o=(i||e).reverse,s=!i||i.reset;return Et({...e,loop:t,default:!1,pause:void 0,to:!o||an(n)?n:void 0,from:s?e.from:void 0,reset:s,...i})}}function Et(e){const{to:t,from:n}=e=zn(e),r=new Set;return S.obj(t)&&Nr(t,r),S.obj(n)&&Nr(n,r),e.keys=r.size?Array.from(r):null,e}function Nr(e,t){ce(e,(n,r)=>n!=null&&t.add(r))}var Du=["onStart","onRest","onChange","onPause","onResume"];function Dr(e,t,n){e.animation[n]=t[n]!==Ki(t,n)?Hi(t[n],e.key):void 0}function ze(e,t,...n){e.animation[t]?.(...n),e.defaultProps[t]?.(...n)}var Mu=["onStart","onChange","onRest"],Lu=1,Cu=class{constructor(e,t){this.id=Lu++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){const e={};return this.each((t,n)=>e[n]=t.get()),e}set(e){for(const t in e){const n=e[t];S.und(n)||this.springs[t].set(n)}}update(e){return e&&this.queue.push(Et(e)),this}start(e){let{queue:t}=this;return e?t=W(e).map(Et):this.queue=[],this._flush?this._flush(this,t):(ro(this,t),zu(this,t))}stop(e,t){if(e!==!!e&&(t=e),t){const n=this.springs;k(W(t),r=>n[r].stop(!!e))}else Qe(this._state,this._lastAsyncId),this.each(n=>n.stop(!!e));return this}pause(e){if(S.und(e))this.start({pause:!0});else{const t=this.springs;k(W(e),n=>t[n].pause())}return this}resume(e){if(S.und(e))this.start({pause:!1});else{const t=this.springs;k(W(e),n=>t[n].resume())}return this}each(e){ce(this.springs,e)}_onFrame(){const{onStart:e,onChange:t,onRest:n}=this._events,r=this._active.size>0,i=this._changed.size>0;(r&&!this._started||i&&!this._started)&&(this._started=!0,Fe(e,([a,c])=>{c.value=this.get(),a(c,this,this._item)}));const o=!r&&this._started,s=i||o&&n.size?this.get():null;i&&t.size&&Fe(t,([a,c])=>{c.value=s,a(c,this,this._item)}),o&&(this._started=!1,Fe(n,([a,c])=>{c.value=s,a(c,this,this._item)}))}eventObserved(e){if(e.type=="change")this._changed.add(e.parent),e.idle||this._active.add(e.parent);else if(e.type=="idle")this._active.delete(e.parent);else return;x.onFrame(this._onFrame)}};function zu(e,t){return Promise.all(t.map(n=>eo(e,n))).then(n=>Un(e,n))}async function eo(e,t,n){const{keys:r,to:i,from:o,loop:s,onRest:a,onResolve:c}=t,u=S.obj(t.default)&&t.default;s&&(t.loop=!1),i===!1&&(t.to=null),o===!1&&(t.from=null);const p=S.arr(i)||S.fun(i)?i:void 0;p?(t.to=void 0,t.onRest=void 0,u&&(u.onRest=void 0)):k(Mu,f=>{const l=t[f];if(S.fun(l)){const m=e._events[f];t[f]=({finished:b,cancelled:v})=>{const w=m.get(l);w?(b||(w.finished=!1),v&&(w.cancelled=!0)):m.set(l,{value:null,finished:b||!1,cancelled:v||!1})},u&&(u[f]=t[f])}});const h=e._state;t.pause===!h.paused?(h.paused=t.pause,Ue(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);const y=(r||Object.keys(e.springs)).map(f=>e.springs[f].start(t)),g=t.cancel===!0||Ki(t,"cancel")===!0;(p||g&&h.asyncId)&&y.push(Yi(++e._lastAsyncId,{props:t,state:h,actions:{pause:rn,resume:rn,start(f,l){g?(Qe(h,e._lastAsyncId),l(Re(e))):(f.onRest=a,l(Qi(p,f,h,e)))}}})),h.paused&&await new Promise(f=>{h.resumeQueue.add(f)});const d=Un(e,await Promise.all(y));if(s&&d.finished&&!(n&&d.noop)){const f=Zi(t,s,i);if(f)return ro(e,[f]),eo(e,f,!0)}return c&&x.batchedUpdates(()=>c(d,e,e.item)),d}function Uu(e,t){const n={...e.springs};return t&&k(W(t),r=>{S.und(r.keys)&&(r=Et(r)),S.obj(r.to)||(r={...r,to:void 0}),no(n,r,i=>to(i))}),Fu(e,n),n}function Fu(e,t){ce(t,(n,r)=>{e.springs[r]||(e.springs[r]=n,Ne(n,e))})}function to(e,t){const n=new Nu;return n.key=e,t&&Ne(n,t),n}function no(e,t,n){t.keys&&k(t.keys,r=>{(e[r]||(e[r]=n(r)))._prepareNode(t)})}function ro(e,t){k(t,n=>{no(e.springs,n,r=>to(r,e))})}var Vu=R.createContext({pause:!1,immediate:!1}),$u=()=>{const e=[],t=function(r){lu();const i=[];return k(e,(o,s)=>{if(S.und(r))i.push(o.start());else{const a=n(r,o,s);a&&i.push(o.start(a))}}),i};t.current=e,t.add=function(r){e.includes(r)||e.push(r)},t.delete=function(r){const i=e.indexOf(r);~i&&e.splice(i,1)},t.pause=function(){return k(e,r=>r.pause(...arguments)),this},t.resume=function(){return k(e,r=>r.resume(...arguments)),this},t.set=function(r){k(e,(i,o)=>{const s=S.fun(r)?r(o,i):r;s&&i.set(s)})},t.start=function(r){const i=[];return k(e,(o,s)=>{if(S.und(r))i.push(o.start());else{const a=this._getProps(r,o,s);a&&i.push(o.start(a))}}),i},t.stop=function(){return k(e,r=>r.stop(...arguments)),this},t.update=function(r){return k(e,(i,o)=>i.update(this._getProps(r,i,o))),this};const n=function(r,i,o){return S.fun(r)?r(o,i):r};return t._getProps=n,t};function ju(e,t,n){const r=S.fun(t)&&t,{reset:i,sort:o,trail:s=0,expires:a=!0,exitBeforeEnter:c=!1,onDestroyed:u,ref:p,config:h}=r?r():t,y=R.useMemo(()=>r||arguments.length==3?$u():void 0,[]),g=W(e),d=[],f=R.useRef(null),l=i?null:f.current;Ee(()=>{f.current=d}),ji(()=>(k(d,T=>{y?.add(T.ctrl),T.ctrl.ref=y}),()=>{k(f.current,T=>{T.expired&&clearTimeout(T.expirationId),Or(T.ctrl,y),T.ctrl.stop(!0)})}));const m=Wu(g,r?r():t,l),b=i&&f.current||[];Ee(()=>k(b,({ctrl:T,item:P,key:U})=>{Or(T,y),H(u,P,U)}));const v=[];if(l&&k(l,(T,P)=>{T.expired?(clearTimeout(T.expirationId),b.push(T)):(P=v[P]=m.indexOf(T.key),~P&&(d[P]=T))}),k(g,(T,P)=>{d[P]||(d[P]={key:m[P],item:T,phase:"mount",ctrl:new Cu},d[P].ctrl.item=T)}),v.length){let T=-1;const{leave:P}=r?r():t;k(v,(U,j)=>{const F=l[j];~U?(T=d.indexOf(F),d[T]={...F,item:g[U]}):P&&d.splice(++T,0,F)})}S.fun(o)&&d.sort((T,P)=>o(T.item,P.item));let w=-s;const I=$i(),O=Cn(t),_=new Map,E=R.useRef(new Map),A=R.useRef(!1);k(d,(T,P)=>{const U=T.key,j=T.phase,F=r?r():t;let B,Z;const ot=H(F.delay||0,U);if(j=="mount")B=F.enter,Z="enter";else{const ee=m.indexOf(U)<0;if(j!="leave")if(ee)B=F.leave,Z="leave";else if(B=F.update)Z="update";else return;else if(!ee)B=F.enter,Z="enter";else return}if(B=H(B,T.item,P),B=S.obj(B)?zn(B):{to:B},!B.config){const ee=h||O.config;B.config=H(ee,T.item,P,Z)}w+=s;const ue={...O,delay:ot+w,ref:p,immediate:F.immediate,reset:!1,...B};if(Z=="enter"&&S.und(ue.from)){const ee=r?r():t,De=S.und(ee.initial)||l?ee.from:ee.initial;ue.from=H(De,T.item,P)}const{onResolve:oo}=ue;ue.onResolve=ee=>{H(oo,ee);const De=f.current,de=De.find(st=>st.key===U);if(de&&!(ee.cancelled&&de.phase!="update")&&de.ctrl.idle){const st=De.every(ve=>ve.ctrl.idle);if(de.phase=="leave"){const ve=H(a,de.item);if(ve!==!1){const Ct=ve===!0?0:ve;if(de.expired=!0,!st&&Ct>0){Ct<=2147483647&&(de.expirationId=setTimeout(I,Ct));return}}}st&&De.some(ve=>ve.expired)&&(E.current.delete(de),c&&(A.current=!0),I())}};const Vn=Uu(T.ctrl,ue);Z==="leave"&&c?E.current.set(T,{phase:Z,springs:Vn,payload:ue}):_.set(T,{phase:Z,springs:Vn,payload:ue})});const C=R.useContext(Vu),L=hu(C),z=C!==L&&Ou(C);Ee(()=>{z&&k(d,T=>{T.ctrl.start({default:C})})},[C]),k(_,(T,P)=>{if(E.current.size){const U=d.findIndex(j=>j.key===P.key);d.splice(U,1)}}),Ee(()=>{k(E.current.size?E.current:_,({phase:T,payload:P},U)=>{const{ctrl:j}=U;U.phase=T,y?.add(j),z&&T=="enter"&&j.start({default:C}),P&&(Tu(j,P.ref),(j.ref||y)&&!A.current?j.update(P):(j.start(P),A.current&&(A.current=!1)))})},i?void 0:n);const K=T=>R.createElement(R.Fragment,null,d.map((P,U)=>{const{springs:j}=_.get(P)||P.ctrl,F=T({...j},P.item,P,U),B=S.str(P.key)||S.num(P.key)?P.key:P.ctrl.id,Z=R.version<"19.0.0",ot=F?.props??{},ue=Z?F?.ref:ot?.ref;return F&&F.type?R.createElement(F.type,{...ot,key:B,ref:ue}):F}));return y?[K,y]:K}var Bu=1;function Wu(e,{key:t,keys:n=t},r){if(n===null){const i=new Set;return e.map(o=>{const s=r&&r.find(a=>a.item===o&&a.phase!=="leave"&&!i.has(a));return s?(i.add(s),s.key):Bu++})}return S.und(n)?e:S.fun(n)?e.map(n):W(n)}var qu=class extends Fn{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=qe(...t);const n=this._get(),r=sn(n);Ln(this,r.create(n))}advance(e){const t=this._get(),n=this.get();le(t,n)||(ie(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&Mr(this._active)&&Jt(this)}_get(){const e=S.arr(this.source)?this.source.map(G):W(G(this.source));return this.calc(...e)}_start(){this.idle&&!Mr(this._active)&&(this.idle=!1,k(Dt(this),e=>{e.done=!1}),re.skipAnimation?(x.batchedUpdates(()=>this.advance()),Jt(this)):xt.start(this))}_attach(){let e=1;k(W(this.source),t=>{J(t)&&Ne(t,this),un(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){k(W(this.source),e=>{J(e)&&Ke(e,this)}),this._active.clear(),Jt(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=W(this.source).reduce((t,n)=>Math.max(t,(un(n)?n.priority:0)+1),0))}};function Gu(e){return e.idle!==!1}function Mr(e){return!e.size||Array.from(e).every(Gu)}function Jt(e){e.idle||(e.idle=!0,k(Dt(e),t=>{t.done=!0}),He(e,{type:"idle",parent:e}))}re.assign({createStringInterpolator:Fi,to:(e,t)=>new qu(e,t)});var Hu=so(),io=/^--/;function Ku(e,t){return t==null||typeof t=="boolean"||t===""?"":typeof t=="number"&&t!==0&&!io.test(e)&&!(je.hasOwnProperty(e)&&je[e])?t+"px":(""+t).trim()}var Lr={};function Yu(e,t){if(!e.nodeType||!e.setAttribute)return!1;const n=e.nodeName==="filter"||e.parentNode&&e.parentNode.nodeName==="filter",{className:r,style:i,children:o,scrollTop:s,scrollLeft:a,viewBox:c,...u}=t,p=Object.values(u),h=Object.keys(u).map(y=>n||e.hasAttribute(y)?y:Lr[y]||(Lr[y]=y.replace(/([A-Z])/g,g=>"-"+g.toLowerCase())));o!==void 0&&(e.textContent=o);for(const y in i)if(i.hasOwnProperty(y)){const g=Ku(y,i[y]);io.test(y)?e.style.setProperty(y,g):e.style[y]=g}h.forEach((y,g)=>{e.setAttribute(y,p[g])}),r!==void 0&&(e.className=r),s!==void 0&&(e.scrollTop=s),a!==void 0&&(e.scrollLeft=a),c!==void 0&&e.setAttribute("viewBox",c)}var je={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ju=(e,t)=>e+t.charAt(0).toUpperCase()+t.substring(1),Qu=["Webkit","Ms","Moz","O"];je=Object.keys(je).reduce((e,t)=>(Qu.forEach(n=>e[Ju(n,t)]=e[t]),e),je);var Xu=/^(matrix|translate|scale|rotate|skew)/,Zu=/^(translate)/,el=/^(rotate|skew)/,Qt=(e,t)=>S.num(e)&&e!==0?e+t:e,dt=(e,t)=>S.arr(e)?e.every(n=>dt(n,t)):S.num(e)?e===t:parseFloat(e)===t,tl=class extends Lt{constructor({x:e,y:t,z:n,...r}){const i=[],o=[];(e||t||n)&&(i.push([e||0,t||0,n||0]),o.push(s=>[`translate3d(${s.map(a=>Qt(a,"px")).join(",")})`,dt(s,0)])),ce(r,(s,a)=>{if(a==="transform")i.push([s||""]),o.push(c=>[c,c===""]);else if(Xu.test(a)){if(delete r[a],S.und(s))return;const c=Zu.test(a)?"px":el.test(a)?"deg":"";i.push(W(s)),o.push(a==="rotate3d"?([u,p,h,y])=>[`rotate3d(${u},${p},${h},${Qt(y,c)})`,dt(y,0)]:u=>[`${a}(${u.map(p=>Qt(p,c)).join(",")})`,dt(u,a.startsWith("scale")?1:0)])}}),i.length&&(r.transform=new nl(i,o)),super(r)}},nl=class extends Ci{constructor(e,t){super(),this.inputs=e,this.transforms=t,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let e="",t=!0;return k(this.inputs,(n,r)=>{const i=G(n[0]),[o,s]=this.transforms[r](S.arr(i)?i:n.map(G));e+=" "+o,t=t&&s}),t?"none":e}observerAdded(e){e==1&&k(this.inputs,t=>k(t,n=>J(n)&&Ne(n,this)))}observerRemoved(e){e==0&&k(this.inputs,t=>k(t,n=>J(n)&&Ke(n,this)))}eventObserved(e){e.type=="change"&&(this._value=null),He(this,e)}},rl=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];re.assign({batchedUpdates:Hu.unstable_batchedUpdates,createStringInterpolator:Fi,colors:jc});var il=wu(rl,{applyAnimatedValues:Yu,createAnimatedStyle:e=>new tl(e),getComponentProps:({scrollTop:e,scrollLeft:t,...n})=>n}),Cr=il.animated;function ol({height:e,children:t,...n}){const[{ref:r},{height:i}]=Mc();return X.jsx(Cr.div,{style:{height:e.to({output:[0,i]})},...n,children:X.jsx(Cr.div,{ref:r,children:t})})}function sl(e,t,n){const r=ju(e,{keys:t,enter:{height:1},from:{height:0},leave:{height:0},trail:50});return i=>r((o,s,a,c)=>X.jsx(ol,{...n,...o,children:i(s,c)}))}const al=({selected:e,result:t,...n})=>X.jsx("li",{className:`w-full m-0 p-3 ${e?"bg-primary/20":"bg-background"}`,...n,children:X.jsx("a",{href:t.url,className:"text-primary",children:t.title})});function cl({results:e,selection:t}){const n=sl(e,r=>r.url,{});return X.jsx("ul",{className:"absolute w-full mt-1 overflow-hidden list-none p-0 bg-background rounded-md shadow-lg z-50",children:n((r,i)=>X.jsx(al,{selected:i===t,result:r},r.url))})}const zr={enableOnFormTags:!0,preventDefault:!0};function ul({api:e}){const[{query:t,results:n,selection:r},i]=R.useReducer(pr,pr(void 0,Ie.reset())),o=R.useMemo(()=>new cc(i,e),[e]);R.useEffect(()=>{const p=()=>i(Ie.reset());return document.addEventListener("astro:page-load",p),()=>document.removeEventListener("astro:page-load",p)},[]);const s=p=>{p.preventDefault(),ac(r,n)},a=Zt("up",()=>i(Ie.previousSelection()),zr),c=Zt("down",()=>i(Ie.nextSelection()),zr),u=oc([a,c]);return X.jsxs("form",{className:"relative w-full m-0",onSubmit:s,ref:u,children:[X.jsx(yc,{value:t,onChange:o.query}),X.jsx(cl,{results:n,selection:r.current})]})}const ll=Ur($a,100),pl=()=>X.jsx(ul,{api:ll});export{pl as default};
