{"version":3,"sources":["webpack:///./search/actions.js","webpack:///./search/components/input.js","webpack:///./search/components/result.js","webpack:///./search/components/results.js","webpack:///./search/components/form.js","webpack:///./search/reducers.js","webpack:///./search/store.js","webpack:///./search/api.js","webpack:///./search/app.js"],"names":["setResults","createAction","nextSelection","previousSelection","setQuery","api","query","dispatch","search","then","results","input","_ref","value","onChange","ref","React","useRef","react_default","a","createElement","type","name","placeholder","autoComplete","autoCorrect","autoCapitalize","spellCheck","className","classNames","is-active","Boolean","event","target","onFocus","setTimeout","current","select","components_result","selected","result","href","fields","url","title","components_results","selection","map","index","key","connect","state","fn","_this","this","_len","arguments","length","args","Array","_key","_len2","nArgs","_key2","apply","concat","curry","baseSetQuery","onKeyUp","which","preventDefault","getState","_getState","window","location","assign","onSubmit","queryReducer","handleActions","SET_QUERY","action","payload","resultsReducer","SET_RESULTS","selectionReducer","max","Math","_objectSpread","min","PREVIOUS_SELECTION","NEXT_SELECTION","combineReducers","createStoreWithMiddleware","applyMiddleware","thunk","createStore","reducers","promises","SearchAPI","_classCallCheck","indexUrl","fetch","response","status","error","Error","statusText","json","data","lunr","Index","load","root","document","querySelector","ReactDOM","render","es","store","components_form","API","dataset"],"mappings":"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","file":"search.1f82199c9b87bdbbc671.js","sourcesContent":["import {createAction} from 'redux-actions';\n\nexport const setResults = createAction('SET_RESULTS');\nexport const nextSelection = createAction('NEXT_SELECTION');\nexport const previousSelection = createAction('PREVIOUS_SELECTION');\n\nexport function activateSelection() {\n  return function(dispatch, getState) {\n    const {selection, results} = getState();\n\n    if (!results[selection.current]) {\n      return;\n    }\n\n    window.location.assign(results[selection.current].fields.url);\n  };\n}\n\nexport function setQuery(api, query) {\n  return function(dispatch) {\n    dispatch(createAction('SET_QUERY')(query));\n\n    api.search(query).then(results => dispatch(setResults(results)));\n  };\n}\n","import React from 'react';\nimport classNames from 'classnames';\n\nexport default function({value, onChange}) {\n  const ref = React.useRef(null);\n\n  return (\n    <input\n      ref={ref}\n      type=\"search\"\n      name=\"query\"\n      placeholder=\"Search\"\n      autoComplete=\"off\"\n      autoCorrect=\"off\"\n      autoCapitalize=\"off\"\n      spellCheck=\"false\"\n      className={classNames({'is-active': Boolean(value)})}\n      value={value}\n      onChange={event => onChange(event.target.value)}\n      onFocus={() => setTimeout(() => ref.current && ref.current.select())}\n    />\n  );\n}\n","import React from 'react';\nimport classNames from 'classnames';\n\nexport default function({selected, result}) {\n  return (\n    <li className={classNames({'is-active': selected})}>\n      <a href={result.fields.url}>{result.fields.title}</a>\n    </li>\n  );\n}\n","import React from 'react';\nimport Result from './result';\n\nexport default function({results, selection}) {\n  return (\n    <ul className=\"search-results\">\n      {results.map((result, index) => (\n        <Result\n          key={result.ref}\n          selected={index === selection}\n          result={result}\n        />\n      ))}\n    </ul>\n  );\n}\n","import React from 'react';\nimport {connect} from 'react-redux';\n\nimport {\n  setQuery as baseSetQuery,\n  activateSelection,\n  nextSelection,\n  previousSelection,\n} from '../actions';\n\nimport Input from './input';\nimport Results from './results';\n\nfunction curry(fn, ...args) {\n  return (...nArgs) => fn.apply(this, [...args, ...nArgs]);\n}\n\nfunction SearchForm({dispatch, query, results, api, selection}) {\n  const setQuery = curry(baseSetQuery, api);\n\n  const onSubmit = event => {\n    event.preventDefault();\n    return false;\n  };\n\n  const onKeyUp = event => {\n    switch (event.which) {\n      case 13:\n        event.preventDefault();\n        dispatch(activateSelection());\n        break;\n      case 38:\n        event.preventDefault();\n        dispatch(previousSelection());\n        break;\n      case 40:\n        event.preventDefault();\n        dispatch(nextSelection());\n        break;\n\n      default:\n      // Do nothing\n    }\n  };\n\n  return (\n    <div onKeyUp={onKeyUp}>\n      <form className=\"search-and-submit\" onSubmit={onSubmit}>\n        <Input value={query} onChange={value => dispatch(setQuery(value))} />\n      </form>\n      <Results results={results} selection={selection.current} />\n    </div>\n  );\n}\n\nexport default connect(state => state)(SearchForm);\n","import {combineReducers} from 'redux';\nimport {handleActions} from 'redux-actions';\n\nconst queryReducer = handleActions(\n  {\n    SET_QUERY: (state, action) => (action ? action.payload : state),\n  },\n  '',\n);\n\nconst resultsReducer = handleActions(\n  {\n    SET_RESULTS: (state, action) => (action ? action.payload : state),\n  },\n  [],\n);\n\nconst selectionReducer = handleActions(\n  {\n    SET_RESULTS: (state, action) => {\n      const max = action ? Math.max(action.payload.length - 1, 0) : 0;\n\n      return {\n        ...state,\n        max,\n        current: Math.min(state.current, max),\n      };\n    },\n    PREVIOUS_SELECTION: state => ({\n      ...state,\n      current: Math.max(state.current - 1, 0),\n    }),\n    NEXT_SELECTION: state => ({\n      ...state,\n      current: Math.min(state.current + 1, state.max),\n    }),\n  },\n  {\n    current: 0,\n    max: 0,\n  },\n);\n\nexport default combineReducers({\n  query: queryReducer,\n  results: resultsReducer,\n  selection: selectionReducer,\n});\n","import {createStore, applyMiddleware} from 'redux';\nimport thunk from 'redux-thunk';\n\nimport reducers from './reducers';\n\nconst createStoreWithMiddleware = applyMiddleware(thunk)(createStore);\n\nexport default createStoreWithMiddleware(reducers);\n","// eslint-disable-next-line import/no-unassigned-import\nimport 'whatwg-fetch';\n\nimport lunr from 'lunr';\n\nconst promises = {};\n\nfunction getIndex(url) {\n  if (promises[url]) {\n    return promises[url];\n  }\n\n  promises[url] = fetch(url)\n    .then(response => {\n      if (response.status >= 200 && response.status < 300) {\n        return response;\n      }\n\n      const error = new Error(response.statusText);\n\n      error.response = response;\n      throw error;\n    })\n    .then(response => response.json())\n    .then(data => lunr.Index.load(data));\n\n  return promises[url];\n}\n\nexport default class SearchAPI {\n  constructor(url) {\n    this.indexUrl = url;\n  }\n\n  search(query) {\n    return getIndex(this.indexUrl).then(index => index.search(query));\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport {Provider} from 'react-redux';\n\nimport SearchForm from './components/form';\nimport store from './store';\nimport API from './api';\n\nconst root = document.querySelector('#search-form');\nif (root) {\n  ReactDOM.render(\n    <Provider store={store}>\n      <SearchForm api={new API(root.dataset.indexUrl)} />\n    </Provider>,\n    root,\n  );\n}\n"],"sourceRoot":""}