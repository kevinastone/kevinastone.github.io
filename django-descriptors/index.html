<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.8"><link rel="alternate" type="application/rss+xml" title="Kevin Stone" href="/rss.xml"><title>Django Model Descriptors</title><link rel="canonical" href="https://blog.kevinastone.com/django-descriptors/"><meta name="description" content="Personal blog for Kevin Stone."><meta name="robots" content="index, follow"><meta property="og:title" content="Django Model Descriptors"><meta property="og:type" content="article"><meta property="og:image" content><meta property="og:url" content="https://blog.kevinastone.com/django-descriptors/"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@kevinastone"><meta name="keywords"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/assets/ClientRouter.astro_astro_type_script_index_0_lang.CDGfc0hd.js"></script><style>code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.property,.token.tag,.token.constant,.token.symbol,.token.deleted{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#a6e22e}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.function,.token.class-name{color:#e6db74}.token.keyword{color:#66d9ef}.token.regex,.token.important{color:#fd971f}.token.important,.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.img-wrapper[data-astro-cid-3eui6wlw]{background-color:var(--base);display:flex;position:absolute;overflow:hidden;width:100%;height:100%}.img-wrapper[data-astro-cid-3eui6wlw] .duotone-img{filter:grayscale(100%) contrast(1);mix-blend-mode:multiply;opacity:var(--opacity);object-fit:cover;width:100%;height:100%;display:block}.img-wrapper[data-astro-cid-3eui6wlw]:before{content:"";position:absolute;inset:0;background-color:var(--foreground);mix-blend-mode:overlay;z-index:1;pointer-events:none}/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-font-weight:initial}}}.wrapper[data-astro-cid-vva3ln22]{justify-content:center;align-items:center;width:100%;display:flex;position:relative}.hero[data-astro-cid-vva3ln22]{color:#fff;margin-bottom:var(--spacing-rhythm-1\.5,calc(1.5*var(--spacing-rhythm)));padding-block:var(--spacing-rhythm-2,calc(2*var(--spacing-rhythm)));text-align:center}.hero[data-astro-cid-vva3ln22] h1{margin-top:var(--spacing-rhythm-2,calc(2*var(--spacing-rhythm)));margin-bottom:calc(var(--spacing,.25rem)*8);font-size:var(--text-4xl,2.25rem);line-height:var(--tw-leading,var(--text-4xl--line-height,calc(2.5/2.25)));--tw-font-weight:var(--font-weight-bold,700);font-weight:var(--font-weight-bold,700)}.bg[data-astro-cid-vva3ln22]{z-index:1;object-fit:cover;object-position:center;width:100%;height:100%;position:absolute;inset:0}.content[data-astro-cid-vva3ln22]{z-index:3;position:relative}@property --tw-font-weight{syntax:"*";inherits:false}
</style>
<link rel="stylesheet" href="/assets/_id_.B4ukCGuY.css"></head> <body> <header class="brand-bg-gradient" data-astro-cid-3ef6ksr2> <div class="navbar" data-astro-cid-3ef6ksr2> <div class="fixed-width">  <div class="row" data-astro-cid-3ef6ksr2> <div class="brand" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Kevin Stone</a> </div> <div class="search" data-astro-cid-3ef6ksr2> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2nfyNG" prefix="r2" component-url="/assets/app.B4Zbbe-O.js" component-export="default" renderer-url="/assets/client.Bfkaqq2T.js" props="{&quot;data-astro-cid-3ef6ksr2&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true}" await-children><form class="relative w-full m-0"><input class="
        w-full
        bg-transparent
        border
        border-accent
        rounded-sm
        text-background
        m-0
        outline-none
        py-1
        px-3
        transition-colors
        duration-500
        focus:bg-background
        focus:border-transparent
        focus:text-primary
        hover:bg-background
        hover:border-transparent
        hover:text-primary
        not-placeholder-shown:bg-background
        not-placeholder-shown:text-primary
      " type="search" placeholder="Search" autoComplete="off" autoCorrect="off" autoCapitalize="off" spellCheck="false" name="query" value=""/><ul class="absolute w-full mt-1 overflow-hidden list-none p-0 bg-background rounded-md shadow-lg z-50"></ul></form><!--astro:end--></astro-island> </div> </div>  </div> </div> </header>  <div class="wrapper hero" data-astro-cid-vva3ln22> <div class="img-wrapper bg" style="--base: var(--color-primary); --foreground: var(--color-accent); --opacity: 0.8;" data-astro-cid-3eui6wlw> <picture data-astro-cid-3eui6wlw="true"> <source srcset="/assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_1gj32D.avif 400w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Z1Y3GWW.avif 800w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_2GcW.avif 1200w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_1h8P7T.avif 1600w" type="image/avif" sizes="100vw"><source srcset="/assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Z1JY9Uj.webp 400w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_4PdS2.webp 800w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Z27Ci0H.webp 1200w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_ZPw95K.webp 1600w" type="image/webp" sizes="100vw">  <img src="/assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Z297ucl.jpg" srcset="/assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Za9wNp.jpg 400w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_1EEPYV.jpg 800w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_1jiL7P.jpg 1200w, /assets/gradient-patterns-simple-background-widescreen-798987-1920x1080.Bl_plNtM_Z2tMdL9.jpg 1600w" sizes="100vw" alt="Hero background image" loading="eager" data-astro-cid-3eui6wlw="true" decoding="async" fetchpriority="auto" width="1920" height="1080" class="duotone-img"> </picture> </div>  <div class="content" data-astro-cid-vva3ln22>  <div class="fixed-width">  <h1>Django Model Descriptors</h1> <p class="sub-heading"> <time datetime="2014-11-26T00:00:00.000Z"> November 26, 2014 </time> </p>  </div>  </div> </div>  <main> <div class="fixed-width">    <article class="prose max-w-none"> <p>How can we enhance our Django model fields to act beyond simple database types
to encapsulate their associated business logic? Leveraging Python’s
descriptor protocol, we provide additional processing on retrieval and update
to allow more re-usable fields.</p>
<h2 id="python-descriptors">Python Descriptors</h2>
<p>What are <a href="https://docs.python.org/2/howto/descriptor.html">Python Descriptors</a>? They’re one of the least
understood aspects of the language, but I think of them like class-based
<a href="https://docs.python.org/2/library/functions.html#property">properties</a>. Just as you can provide a <code>__call__</code> method on a
class so that it acts like a function, you can supply a <code>__get__</code> (or
<code>__set__</code> or <code>__delete__</code>) and the class will similarly act more like a
property.</p>
<p>This allows us to capture common property definitions in a re-usable construct
that we can apply as generic functionality to our models. If you’re read the
post on <a href="/django-model-behaviors">Django Model Behaviors</a>, you understand how
to package common field definitions into a shared model behavior that you can
combine to assemble your models from more atomic functionality. Leveraging
descriptors, you can perform a similar deconstruction but this time by
creating re-usable fields with enhanced logic without being tied to a given
model definition.</p>
<h4 id="sample-code">Sample Code</h4>
<p>All the sample code for this project is available on a <a href="https://github.com/kevinastone/django-descriptors">GitHub
repository</a>. Feel free to use it as the basis for your own
experimentation.</p>
<h2 id="enhance-your-models-with-properties">Enhance your Models with Properties</h2>
<p>A common use of properties is to perform calculations or manipulations on a
given field and provide that as additional information.</p>
<p>For example, let’s start with this Bookmark model that features a <code>url</code> field:</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token keyword">class</span> <span class="token class-name">Bookmark</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> models<span class="token punctuation">.</span>URLField<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>It’s very simple and straightforward. Now let’s say we want to extract some
additional information about the stored url, say it’s domain/hostname so we
can show a favicon on our listing. Since the url already contains the
hostname, we can add a method or a property to our model which retrieves the
url, and then parses out the hostname.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> urlparse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token keyword">class</span> <span class="token class-name">Bookmark</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> models<span class="token punctuation">.</span>URLField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">hostname</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> urlparse<span class="token punctuation">.</span>urlparse<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>hostname
</code></pre>
<p>Now, when we’re accessing our bookmark model instances, we can simple refer to
<code>obj.hostname</code>. This pattern works great for many common derived or computed
values. No reason to store redundant information when we can calculate it on
the fly from other model attributes.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> boomark <span class="token operator">=</span> Bookmark<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">'http://example.com/abcd'</span><span class="token punctuation">)</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Let's access our hostname property</span>
<span class="token operator">>></span><span class="token operator">></span> bookmark<span class="token punctuation">.</span>hostname
'example<span class="token punctuation">.</span>com`
</code></pre>
<p>But as we add more and more computed values, these properties tend to overload
our models, cluttering our codebase. Plus, we are frequently adding the same
properties again and again, repeating the same functionality for each field.
What we’d like is a way to associate a given property with the model field
that derives it.</p>
<h2 id="descriptors-as-reusable-properties">Descriptors as Reusable Properties</h2>
<p>Rather than define a bunch of properties, what we’d rather do is something
like: <code>obj.url.hostname</code>, and encapsulate all the derived logic on the url
field. Yet when you access a model instance’s field, it’s simply returned
just like the original python type (str/unicode in the case of a <em>URLField</em>).
These additional properties would be transparent to the rest of the code.</p>
<p>So, we need to intercept the value returned by accessing the field on the
instance and <strong>enhance</strong> it with our custom properties. This is where the
descriptor protocol comes into play. It gives us a chance to intercept and
substitute the value returned when an attribute is accessed on a given class
instance.</p>
<p>To make this work, we actually need two components. First, we need our
descriptor which performs the intercept and substitution. Second, we need a
proxy model that acts like the original datatype, but is augmented with the
additional custom properties.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">URLFieldProxy</span><span class="token punctuation">(</span><span class="token builtin">unicode</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">hostname</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> urlparse<span class="token punctuation">.</span>urlparse<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span>hostname


<span class="token keyword">class</span> <span class="token class-name">ProxyFieldDescriptor</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> field_name<span class="token punctuation">,</span> proxy_class<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>field_name <span class="token operator">=</span> field_name
        self<span class="token punctuation">.</span>proxy_class <span class="token operator">=</span> proxy_class

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> owner<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># grab the original value before we proxy</span>
        value <span class="token operator">=</span> instance<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>self<span class="token punctuation">.</span>field_name<span class="token punctuation">]</span>
        <span class="token keyword">if</span> value <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token comment"># We can't proxy a None through a unicode sub-class</span>
            <span class="token keyword">return</span> value
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>proxy_class<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__set__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        instance<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>self<span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">=</span> value
</code></pre>
<p>Our <em>Proxy</em> class, <code>URLFieldProxy</code>, sub-classes the base type that the field
would return (<code>unicode</code> in this case). That ensures we have the same base
datatype. And then it adds a property for calculating the derived value(s).</p>
<p>Our <em>Descriptor</em> class, <code>ProxyFieldDescriptor</code>, is a regular python object,
with the magic methods <code>__get__</code> and <code>__set__</code> that define a descriptor. It
features a constructor that takes a two arguments, the name of the field we
want to intercept, and the proxy class we want to substitute. The <code>__get__</code>
implementation looks up the original value of the intercepted field using
<code>instance.__dict__</code> and then instantiates our proxy class passing in that
original value. We special case <code>None</code> since our proxy can’t handle that type
directly (<em>None</em> values can’t have properties). <code>__set__</code> simply stores the
value directly without modification.</p>
<p>Before we talk through how to attach this descriptor to your django model
field, let’s put our implementation through some paces to show how a
descriptor operates.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">SomeObject</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Let's add our descriptor on the `url` field substituting `URLFieldProxy`</span>
    wormhole <span class="token operator">=</span> ProxyFieldDescriptor<span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">,</span> URLFieldProxy<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> url
</code></pre>
<p>Remember that we defined our descriptor to look up it’s real value from the
passed in argument name. It then returns the <em>Proxy</em> model that adds the
computed properties. Let’s see it in action:</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> obj <span class="token operator">=</span> SomeObject<span class="token punctuation">(</span><span class="token string">'http://example.com/asdf'</span><span class="token punctuation">)</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Normal attribute access still works</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>url
<span class="token string">'http://example.com/asdf'</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Does obj.url have a hostname property?</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>url<span class="token punctuation">.</span>hostname
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
AttributeError                            Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># What about accessing our descriptor field?</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>wormhole
<span class="token string">u'http://example.com/asdf'</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Let's access the descriptor's property</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>wormhole<span class="token punctuation">.</span>hostname
<span class="token string">u'example.com'</span>

<span class="token comment"># As you can see, the descriptor returns our proxy</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>wormhole<span class="token punctuation">)</span>
__main__<span class="token punctuation">.</span>URLFieldProxy

<span class="token comment"># But the proxy still *acts* like our original url attribute</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>wormhole <span class="token operator">==</span> obj<span class="token punctuation">.</span>url
<span class="token boolean">True</span>
</code></pre>
<h3 id="customize-django-model-fields-with-descriptors">Customize Django Model Fields with Descriptors</h3>
<p>Now, we need to customize the Django <code>URLField</code> to hook in to the descriptor
class. Thankfully, django provides an accessible mechanism under a method
named <code>contribute_to_class</code> that allows you to customize how a field class is
attached to its model instance. The specifics of how this method works are
convoluted and related to the metaclass magic that django model definitions
perform.</p>
<p>Since <code>contribute_to_class</code> is used by django when building the model
instance, we simply attach our descriptor in the place of the field’s name on
our constructed model instance using <code>setattr()</code> with <code>self.name</code> representing
the name of the field (“url” in our case).</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">HostnamedURLField</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>URLField<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">contribute_to_class</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cls<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>HostnamedURLField<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>contribute_to_class<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
        <span class="token comment"># Add our descriptor to this field in place of of the normal attribute</span>
        <span class="token builtin">setattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> ProxyFieldDescriptor<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> URLFieldProxy<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Finally, let’s update our model to use our customized url field. Notice our
model definition knows nothing about hostnames, it’s all encapsulated in our
customized <em>URLField</em>.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">Bookmark</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> HostnamedURLField<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>With the model all wired up with our descriptor wielding field, let’s
see if it works.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> bookmark <span class="token operator">=</span> Bookmark<span class="token punctuation">(</span>url<span class="token operator">=</span><span class="token string">'http://example.com/asdf'</span><span class="token punctuation">)</span>

<span class="token operator">>></span><span class="token operator">></span> bookmark<span class="token punctuation">.</span>url
<span class="token string">u'http://example.com/asdf'</span>

<span class="token operator">>></span><span class="token operator">></span> bookmark<span class="token punctuation">.</span>url<span class="token punctuation">.</span>hostname
<span class="token string">u'example.com'</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># You can assign to the descriptor field too</span>
<span class="token operator">>></span><span class="token operator">></span> bookmark<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">u'http://somewhere.com/else'</span>

<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># And it still keeps all the same semantics</span>
<span class="token operator">>></span><span class="token operator">></span> bookmark<span class="token punctuation">.</span>url<span class="token punctuation">.</span>hostname
<span class="token string">u'somewhere.com'</span>
</code></pre>
<p>There you go, we have a successfully migrated a computed property from the
model definition to the field definition. This helps keep common
functionality encapsulated, allowing greater re-use and cleaner separation of
concerns.</p>
<h2 id="descriptors-for-alternative-representations">Descriptors for Alternative Representations</h2>
<p>Besides just augmenting fields with computed properties, descriptors can also
be used to provide additional representations for your model data.</p>
<p>One of my favorite database modeling patterns is to use timestamps for boolean
flags. If a timestamp is NULL, it’s off (or disabled). When a timestamp is
set, the flag is enabled. This gives you both a status (on/off) as well as a
history of when the flag was enabled.</p>
<p>In most uses, we’re only concerned with the status, so a boolean data type is
more representative. But certain views would like to know this date
information (for say a management overview).</p>
<p>Let’s create another simple model to walk through such a use case:</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token keyword">class</span> <span class="token class-name">BlogPost</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    published_at <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre>
<p>With a <code>published_at</code> field, we can show visitors posts that have been marked
ready for publication, as well as sort our blog posts based on their
publication date. This same pattern works great for any moderation task,
including comments, account setup, or content release.</p>
<p>With our model, we can create a few posts and then publish them by setting our
timestamp field to a non-NULL value.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> django<span class="token punctuation">.</span>utils <span class="token keyword">import</span> timezone
<span class="token operator">>></span><span class="token operator">></span> post <span class="token operator">=</span> BlogPost<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>published_at <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
<span class="token boolean">False</span>
<span class="token operator">>></span><span class="token operator">></span> BlogPost<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>published_at__isnull<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token comment"># Now let's set our published flag</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>published_at <span class="token operator">=</span> timezone<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>published_at <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
<span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> BlogPost<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>published_at__isnull<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">&#x3C;</span>BlogPost<span class="token punctuation">:</span> BlogPost <span class="token builtin">object</span><span class="token operator">></span><span class="token punctuation">]</span>
</code></pre>
<h3 id="creating-a-hybrid-booleantimestamp-descriptor">Creating a Hybrid Boolean/Timestamp Descriptor</h3>
<p>Using a datetime field gives us that extra information, but it makes working
with such fields less intuitive. You have to know it’s a datetime value
rather than a boolean. What if we could use descriptors to modify the
returned field to act like a boolean?</p>
<p>Let’s create a descriptor class that proxies our datetime value, but acts like
a boolean.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">TimestampedBooleanDescriptor</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> owner<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>self<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">__set__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value <span class="token operator">=</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token keyword">if</span> value <span class="token operator">!=</span> self<span class="token punctuation">.</span>__get__<span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> value<span class="token punctuation">:</span>
                instance<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>self<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> timezone<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                instance<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span>self<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
</code></pre>
<p>It handles two cases, the first is on <code>__get__</code> where it checks its stored
timestamp against None. The other case is when <code>__set__</code> is called, it checks
the input value (a boolean) and if it’s changed, either sets or clears the
internal datetime representation.</p>
<p>Let’s build an example to use this descriptor.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">SomeObject</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Let's add our descriptor on the `timestamp` field</span>
    boolean <span class="token operator">=</span> TimestampedBooleanDescriptor<span class="token punctuation">(</span><span class="token string">'timestamp'</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> timestamp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>timestamp <span class="token operator">=</span> timestamp
</code></pre>
<p>And let’s put our sample object through some paces:</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> obj <span class="token operator">=</span> SomeObject<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>timestamp <span class="token keyword">is</span> <span class="token boolean">None</span>
<span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>boolean
<span class="token boolean">False</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>timestamp <span class="token operator">=</span> timezone<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>boolean
<span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>boolean <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>timestamp <span class="token keyword">is</span> <span class="token boolean">None</span>
<span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>boolean <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> obj<span class="token punctuation">.</span>timestamp
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">872457</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&#x3C;</span>UTC<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre>
<p>Through the descriptor protocol, we were able to extend the functionality of
our fields to both support a datetime and a boolean interface.</p>
<p>Now, let’s extend the built-in <code>DateTimeField</code> to use our descriptor class to
provide both interfaces. Our field adds two capabilities: first, we want to
add a second property on the given model for the boolean access (it defaults
to <code>is_&#x3C;field_name></code>). Second, we again use <code>contribute_to_class</code> to add our
additional boolean property on the model class.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">TimestampedBooleanField</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A Boolean field that also captures the timestamp when the value was set.

    This field stores a timestamp in the database when set.  It can be accessed
    as a boolean using the property argument (when not provided, it defaults to
    is_{field_name}).
    """</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>property_name <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'property'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        kwargs<span class="token punctuation">[</span><span class="token string">'null'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>TimestampedBooleanField<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">contribute_to_class</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cls<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>TimestampedBooleanField<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>contribute_to_class<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
        <span class="token comment"># Use the defined boolean property name or pick a default</span>
        property_name <span class="token operator">=</span> self<span class="token punctuation">.</span>property_name <span class="token keyword">or</span> <span class="token string">'is_{0}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token builtin">setattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> property_name<span class="token punctuation">,</span> TimestampedBooleanDescriptor<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Let’s now update our <code>BlogPost</code> model to use this timestamp field.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">class</span> <span class="token class-name">BlogPost</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    published_at <span class="token operator">=</span> TimestampedBooleanField<span class="token punctuation">(</span><span class="token builtin">property</span><span class="token operator">=</span><span class="token string">'is_published'</span><span class="token punctuation">)</span>
</code></pre>
<p>With the model all wired up with our descriptor wielding field, let’s
see if it works.</p>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token operator">>></span><span class="token operator">></span> post <span class="token operator">=</span> BlogPost<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>published_at <span class="token keyword">is</span> <span class="token boolean">None</span>
<span class="token boolean">True</span>

<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>is_published
<span class="token boolean">False</span>

<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>is_published <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>published_at
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">191879</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&#x3C;</span>UTC<span class="token operator">></span><span class="token punctuation">)</span>

<span class="token comment"># Still works after reloading from the DB</span>
<span class="token operator">>></span><span class="token operator">></span> post<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> post2 <span class="token operator">=</span> BlogPost<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>post<span class="token punctuation">.</span>pk<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> post2<span class="token punctuation">.</span>is_published
<span class="token boolean">True</span>
<span class="token operator">>></span><span class="token operator">></span> post2<span class="token punctuation">.</span>published_at
datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">191879</span><span class="token punctuation">,</span> tzinfo<span class="token operator">=</span><span class="token operator">&#x3C;</span>UTC<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre>
<p>There you go, depending on how you want to access your model, you can choose
to use either the timestamp attribute or the boolean. All of this is
encapsulated in a descriptor class, keeping your model definition clean and
intuitive.</p>
<h2 id="summary">Summary</h2>
<p>There’s numerous opportunities to leverage descriptors to enhance your model
fields. Django itself uses them to handle File Upload fields since they’re
stored in the database as pathnames to the file, but provided as a file-like
proxies to your django code.</p>
<p>There’s plenty of additional uses for descriptors. Please leave a comment (or
tweet, etc) if you have addditional ideas or examples where descriptors can
improve your model code.</p> <section><script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><astro-island uid="1ddNFu" prefix="r3" component-url="/assets/Disqus.ZXPp-emh.js" component-export="default" renderer-url="/assets/client.Bfkaqq2T.js" props="{&quot;id&quot;:[0,&quot;django-descriptors&quot;],&quot;title&quot;:[0,&quot;Django Model Descriptors&quot;],&quot;shortname&quot;:[0,&quot;kevinstone&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;Disqus&quot;,&quot;value&quot;:true}" await-children><div id="disqus_thread"></div><!--astro:end--></astro-island></section> </article>   </div> </main> <footer data-astro-cid-sz7xmlte> <div class="fixed-width">  <p data-astro-cid-sz7xmlte>&copy; Kevin A. Stone 2026, Built with <a href="https://astro.build/" data-astro-cid-sz7xmlte>Astro</a></p>  </div> </footer>  </body></html>