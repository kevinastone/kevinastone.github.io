{"componentChunkName":"component---src-components-blog-post-js","path":"/django-descriptors","webpackCompilationHash":"8b56a345a0379dd2a2ae","result":{"data":{"markdownRemark":{"html":"<p>How can we enhance our Django model fields to act beyond simple database types\nto encapsulate their associated business logic? Leveraging Python's\ndescriptor protocol, we provide additional processing on retrieval and update\nto allow more re-usable fields.</p>\n<h2 id=\"python-descriptors\"><a href=\"#python-descriptors\" aria-label=\"python descriptors permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Python Descriptors</h2>\n<p>What are <a href=\"https://docs.python.org/2/howto/descriptor.html\">Python Descriptors</a>? They're one of the least\nunderstood aspects of the language, but I think of them like class-based\n<a href=\"https://docs.python.org/2/library/functions.html#property\">properties</a>. Just as you can provide a <code>__call__</code> method on a\nclass so that it acts like a function, you can supply a <code>__get__</code> (or\n<code>__set__</code> or <code>__delete__</code>) and the class will similarly act more like a\nproperty.</p>\n<p>This allows us to capture common property definitions in a re-usable construct\nthat we can apply as generic functionality to our models. If you're read the\npost on <a href=\"/django-model-behaviors\">Django Model Behaviors</a>, you understand how\nto package common field definitions into a shared model behavior that you can\ncombine to assemble your models from more atomic functionality. Leveraging\ndescriptors, you can perform a similar deconstruction but this time by\ncreating re-usable fields with enhanced logic without being tied to a given\nmodel definition.</p>\n<h4 id=\"sample-code\"><a href=\"#sample-code\" aria-label=\"sample code permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sample Code</h4>\n<p>All the sample code for this project is available on a <a href=\"https://github.com/kevinastone/django-descriptors\">GitHub\nrepository</a>. Feel free to use it as the basis for your own\nexperimentation.</p>\n<h2 id=\"enhance-your-models-with-properties\"><a href=\"#enhance-your-models-with-properties\" aria-label=\"enhance your models with properties permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enhance your Models with Properties</h2>\n<p>A common use of properties is to perform calculations or manipulations on a\ngiven field and provide that as additional information.</p>\n<p>For example, let's start with this Bookmark model that features a <code>url</code> field:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>db <span class=\"token keyword\">import</span> models\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Bookmark</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    url <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>URLField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>It's very simple and straightforward. Now let's say we want to extract some\nadditional information about the stored url, say it's domain/hostname so we\ncan show a favicon on our listing. Since the url already contains the\nhostname, we can add a method or a property to our model which retrieves the\nurl, and then parses out the hostname.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urlparse\n<span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>db <span class=\"token keyword\">import</span> models\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Bookmark</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    url <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>URLField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    @<span class=\"token builtin\">property</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">hostname</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> urlparse<span class=\"token punctuation\">.</span>urlparse<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hostname</code></pre></div>\n<p>Now, when we're accessing our bookmark model instances, we can simple refer to\n<code>obj.hostname</code>. This pattern works great for many common derived or computed\nvalues. No reason to store redundant information when we can calculate it on\nthe fly from other model attributes.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> boomark <span class=\"token operator\">=</span> Bookmark<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span><span class=\"token string\">'http://example.com/abcd'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Let's access our hostname property</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark<span class=\"token punctuation\">.</span>hostname\n'example<span class=\"token punctuation\">.</span>com`</code></pre></div>\n<p>But as we add more and more computed values, these properties tend to overload\nour models, cluttering our codebase. Plus, we are frequently adding the same\nproperties again and again, repeating the same functionality for each field.\nWhat we'd like is a way to associate a given property with the model field\nthat derives it.</p>\n<h2 id=\"descriptors-as-reusable-properties\"><a href=\"#descriptors-as-reusable-properties\" aria-label=\"descriptors as reusable properties permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Descriptors as Reusable Properties</h2>\n<p>Rather than define a bunch of properties, what we'd rather do is something\nlike: <code>obj.url.hostname</code>, and encapsulate all the derived logic on the url\nfield. Yet when you access a model instance's field, it's simply returned\njust like the original python type (str/unicode in the case of a <em>URLField</em>).\nThese additional properties would be transparent to the rest of the code.</p>\n<p>So, we need to intercept the value returned by accessing the field on the\ninstance and <strong>enhance</strong> it with our custom properties. This is where the\ndescriptor protocol comes into play. It gives us a chance to intercept and\nsubstitute the value returned when an attribute is accessed on a given class\ninstance.</p>\n<p>To make this work, we actually need two components. First, we need our\ndescriptor which performs the intercept and substitution. Second, we need a\nproxy model that acts like the original datatype, but is augmented with the\nadditional custom properties.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">URLFieldProxy</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">unicode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    @<span class=\"token builtin\">property</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">hostname</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> urlparse<span class=\"token punctuation\">.</span>urlparse<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hostname\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ProxyFieldDescriptor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> field_name<span class=\"token punctuation\">,</span> proxy_class<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>field_name <span class=\"token operator\">=</span> field_name\n        self<span class=\"token punctuation\">.</span>proxy_class <span class=\"token operator\">=</span> proxy_class\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__get__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> instance<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> owner<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># grab the original value before we proxy</span>\n        value <span class=\"token operator\">=</span> instance<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>field_name<span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">if</span> value <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># We can't proxy a None through a unicode sub-class</span>\n            <span class=\"token keyword\">return</span> value\n        <span class=\"token keyword\">return</span> self<span class=\"token punctuation\">.</span>proxy_class<span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__set__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> instance<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        instance<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>field_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value</code></pre></div>\n<p>Our <em>Proxy</em> class, <code>URLFieldProxy</code>, sub-classes the base type that the field\nwould return (<code>unicode</code> in this case). That ensures we have the same base\ndatatype. And then it adds a property for calculating the derived value(s).</p>\n<p>Our <em>Descriptor</em> class, <code>ProxyFieldDescriptor</code>, is a regular python object,\nwith the magic methods <code>__get__</code> and <code>__set__</code> that define a descriptor. It\nfeatures a constructor that takes a two arguments, the name of the field we\nwant to intercept, and the proxy class we want to substitute. The <code>__get__</code>\nimplementation looks up the original value of the intercepted field using\n<code>instance.__dict__</code> and then instantiates our proxy class passing in that\noriginal value. We special case <code>None</code> since our proxy can't handle that type\ndirectly (<em>None</em> values can't have properties). <code>__set__</code> simply stores the\nvalue directly without modification.</p>\n<p>Before we talk through how to attach this descriptor to your django model\nfield, let's put our implementation through some paces to show how a\ndescriptor operates.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SomeObject</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Let's add our descriptor on the `url` field substituting `URLFieldProxy`</span>\n    wormhole <span class=\"token operator\">=</span> ProxyFieldDescriptor<span class=\"token punctuation\">(</span><span class=\"token string\">'url'</span><span class=\"token punctuation\">,</span> URLFieldProxy<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> url</code></pre></div>\n<p>Remember that we defined our descriptor to look up it's real value from the\npassed in argument name. It then returns the <em>Proxy</em> model that adds the\ncomputed properties. Let's see it in action:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> obj <span class=\"token operator\">=</span> SomeObject<span class=\"token punctuation\">(</span><span class=\"token string\">'http://example.com/asdf'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Normal attribute access still works</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>url\n<span class=\"token string\">'http://example.com/asdf'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Does obj.url have a hostname property?</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">.</span>hostname\n<span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\nAttributeError                            Traceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># What about accessing our descriptor field?</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>wormhole\n<span class=\"token string\">u'http://example.com/asdf'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Let's access the descriptor's property</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>wormhole<span class=\"token punctuation\">.</span>hostname\n<span class=\"token string\">u'example.com'</span>\n\n<span class=\"token comment\"># As you can see, the descriptor returns our proxy</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token builtin\">type</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>wormhole<span class=\"token punctuation\">)</span>\n__main__<span class=\"token punctuation\">.</span>URLFieldProxy\n\n<span class=\"token comment\"># But the proxy still *acts* like our original url attribute</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>wormhole <span class=\"token operator\">==</span> obj<span class=\"token punctuation\">.</span>url\n<span class=\"token boolean\">True</span></code></pre></div>\n<h3 id=\"customize-django-model-fields-with-descriptors\"><a href=\"#customize-django-model-fields-with-descriptors\" aria-label=\"customize django model fields with descriptors permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Customize Django Model Fields with Descriptors</h3>\n<p>Now, we need to customize the Django <code>URLField</code> to hook in to the descriptor\nclass. Thankfully, django provides an accessible mechanism under a method\nnamed <code>contribute_to_class</code> that allows you to customize how a field class is\nattached to its model instance. The specifics of how this method works are\nconvoluted and related to the metaclass magic that django model definitions\nperform.</p>\n<p>Since <code>contribute_to_class</code> is used by django when building the model\ninstance, we simply attach our descriptor in the place of the field's name on\nour constructed model instance using <code>setattr()</code> with <code>self.name</code> representing\nthe name of the field (\"url\" in our case).</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">HostnamedURLField</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>URLField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">contribute_to_class</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>HostnamedURLField<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>contribute_to_class<span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># Add our descriptor to this field in place of of the normal attribute</span>\n        <span class=\"token builtin\">setattr</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> ProxyFieldDescriptor<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> URLFieldProxy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Finally, let's update our model to use our customized url field. Notice our\nmodel definition knows nothing about hostnames, it's all encapsulated in our\ncustomized <em>URLField</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Bookmark</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    url <span class=\"token operator\">=</span> HostnamedURLField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>With the model all wired up with our descriptor wielding field, let's\nsee if it works.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark <span class=\"token operator\">=</span> Bookmark<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span><span class=\"token string\">'http://example.com/asdf'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark<span class=\"token punctuation\">.</span>url\n<span class=\"token string\">u'http://example.com/asdf'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">.</span>hostname\n<span class=\"token string\">u'example.com'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># You can assign to the descriptor field too</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark<span class=\"token punctuation\">.</span>url <span class=\"token operator\">=</span> <span class=\"token string\">u'http://somewhere.com/else'</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># And it still keeps all the same semantics</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> bookmark<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">.</span>hostname\n<span class=\"token string\">u'somewhere.com'</span></code></pre></div>\n<p>There you go, we have a successfully migrated a computed property from the\nmodel definition to the field definition. This helps keep common\nfunctionality encapsulated, allowing greater re-use and cleaner separation of\nconcerns.</p>\n<h2 id=\"descriptors-for-alternative-representations\"><a href=\"#descriptors-for-alternative-representations\" aria-label=\"descriptors for alternative representations permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Descriptors for Alternative Representations</h2>\n<p>Besides just augmenting fields with computed properties, descriptors can also\nbe used to provide additional representations for your model data.</p>\n<p>One of my favorite database modeling patterns is to use timestamps for boolean\nflags. If a timestamp is NULL, it's off (or disabled). When a timestamp is\nset, the flag is enabled. This gives you both a status (on/off) as well as a\nhistory of when the flag was enabled.</p>\n<p>In most uses, we're only concerned with the status, so a boolean data type is\nmore representative. But certain views would like to know this date\ninformation (for say a management overview).</p>\n<p>Let's create another simple model to walk through such a use case:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>db <span class=\"token keyword\">import</span> models\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BlogPost</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    content <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>TextField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    published_at <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>DateTimeField<span class=\"token punctuation\">(</span>null<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>With a <code>published_at</code> field, we can show visitors posts that have been marked\nready for publication, as well as sort our blog posts based on their\npublication date. This same pattern works great for any moderation task,\nincluding comments, account setup, or content release.</p>\n<p>With our model, we can create a few posts and then publish them by setting our\ntimestamp field to a non-NULL value.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> timezone\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post <span class=\"token operator\">=</span> BlogPost<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>create<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>published_at <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span>\n<span class=\"token boolean\">False</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> BlogPost<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span>published_at__isnull<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\"># Now let's set our published flag</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>published_at <span class=\"token operator\">=</span> timezone<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>published_at <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> BlogPost<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token builtin\">filter</span><span class=\"token punctuation\">(</span>published_at__isnull<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>BlogPost<span class=\"token punctuation\">:</span> BlogPost <span class=\"token builtin\">object</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span></code></pre></div>\n<h3 id=\"creating-a-hybrid-booleantimestamp-descriptor\"><a href=\"#creating-a-hybrid-booleantimestamp-descriptor\" aria-label=\"creating a hybrid booleantimestamp descriptor permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating a Hybrid Boolean/Timestamp Descriptor</h3>\n<p>Using a datetime field gives us that extra information, but it makes working\nwith such fields less intuitive. You have to know it's a datetime value\nrather than a boolean. What if we could use descriptors to modify the\nreturned field to act like a boolean?</p>\n<p>Let's create a descriptor class that proxies our datetime value, but acts like\na boolean.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TimestampedBooleanDescriptor</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__get__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> instance<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> owner<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__set__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> instance<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        value <span class=\"token operator\">=</span> <span class=\"token builtin\">bool</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> value <span class=\"token operator\">!=</span> self<span class=\"token punctuation\">.</span>__get__<span class=\"token punctuation\">(</span>instance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> value<span class=\"token punctuation\">:</span>\n                instance<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> timezone<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                instance<span class=\"token punctuation\">.</span>__dict__<span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span></code></pre></div>\n<p>It handles two cases, the first is on <code>__get__</code> where it checks its stored\ntimestamp against None. The other case is when <code>__set__</code> is called, it checks\nthe input value (a boolean) and if it's changed, either sets or clears the\ninternal datetime representation.</p>\n<p>Let's build an example to use this descriptor.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SomeObject</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Let's add our descriptor on the `timestamp` field</span>\n    boolean <span class=\"token operator\">=</span> TimestampedBooleanDescriptor<span class=\"token punctuation\">(</span><span class=\"token string\">'timestamp'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> timestamp<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>timestamp <span class=\"token operator\">=</span> timestamp</code></pre></div>\n<p>And let's put our sample object through some paces:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> obj <span class=\"token operator\">=</span> SomeObject<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>timestamp <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>boolean\n<span class=\"token boolean\">False</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>timestamp <span class=\"token operator\">=</span> timezone<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>boolean\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>boolean <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>timestamp <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>boolean <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> obj<span class=\"token punctuation\">.</span>timestamp\ndatetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">(</span><span class=\"token number\">2014</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">872457</span><span class=\"token punctuation\">,</span> tzinfo<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>UTC<span class=\"token operator\">></span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Through the descriptor protocol, we were able to extend the functionality of\nour fields to both support a datetime and a boolean interface.</p>\n<p>Now, let's extend the built-in <code>DateTimeField</code> to use our descriptor class to\nprovide both interfaces. Our field adds two capabilities: first, we want to\nadd a second property on the given model for the boolean access (it defaults\nto <code>is_&#x3C;field_name></code>). Second, we again use <code>contribute_to_class</code> to add our\nadditional boolean property on the model class.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TimestampedBooleanField</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>DateTimeField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    A Boolean field that also captures the timestamp when the value was set.\n\n    This field stores a timestamp in the database when set.  It can be accessed\n    as a boolean using the property argument (when not provided, it defaults to\n    is_{field_name}).\n    \"\"\"</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>property_name <span class=\"token operator\">=</span> kwargs<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token string\">'property'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n        kwargs<span class=\"token punctuation\">[</span><span class=\"token string\">'null'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>TimestampedBooleanField<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">contribute_to_class</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> cls<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>TimestampedBooleanField<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>contribute_to_class<span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># Use the defined boolean property name or pick a default</span>\n        property_name <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>property_name <span class=\"token keyword\">or</span> <span class=\"token string\">'is_{0}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span>\n        <span class=\"token builtin\">setattr</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">,</span> property_name<span class=\"token punctuation\">,</span> TimestampedBooleanDescriptor<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Let's now update our <code>BlogPost</code> model to use this timestamp field.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">BlogPost</span><span class=\"token punctuation\">(</span>models<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    content <span class=\"token operator\">=</span> models<span class=\"token punctuation\">.</span>TextField<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    published_at <span class=\"token operator\">=</span> TimestampedBooleanField<span class=\"token punctuation\">(</span><span class=\"token builtin\">property</span><span class=\"token operator\">=</span><span class=\"token string\">'is_published'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>With the model all wired up with our descriptor wielding field, let's\nsee if it works.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> post <span class=\"token operator\">=</span> BlogPost<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>published_at <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>\n<span class=\"token boolean\">True</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>is_published\n<span class=\"token boolean\">False</span>\n\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>is_published <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>published_at\ndatetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">(</span><span class=\"token number\">2014</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">191879</span><span class=\"token punctuation\">,</span> tzinfo<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>UTC<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Still works after reloading from the DB</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post2 <span class=\"token operator\">=</span> BlogPost<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>pk<span class=\"token operator\">=</span>post<span class=\"token punctuation\">.</span>pk<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post2<span class=\"token punctuation\">.</span>is_published\n<span class=\"token boolean\">True</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> post2<span class=\"token punctuation\">.</span>published_at\ndatetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">(</span><span class=\"token number\">2014</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">47</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">191879</span><span class=\"token punctuation\">,</span> tzinfo<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>UTC<span class=\"token operator\">></span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>There you go, depending on how you want to access your model, you can choose\nto use either the timestamp attribute or the boolean. All of this is\nencapsulated in a descriptor class, keeping your model definition clean and\nintuitive.</p>\n<h2 id=\"summary\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h2>\n<p>There's numerous opportunities to leverage descriptors to enhance your model\nfields. Django itself uses them to handle File Upload fields since they're\nstored in the database as pathnames to the file, but provided as a file-like\nproxies to your django code.</p>\n<p>There's plenty of additional uses for descriptors. Please leave a comment (or\ntweet, etc) if you have addditional ideas or examples where descriptors can\nimprove your model code.</p>","excerpt":"How can we enhance our Django model fields to act beyond simple database types\nto encapsulate their associated business logic? Leveraging","frontmatter":{"title":"Django Model Descriptors","date":"November 26, 2014","hero":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAACBP/aAAwDAQACEAMQAAABix9iWzIHiX//xAAZEAACAwEAAAAAAAAAAAAAAAAAAgEDETH/2gAIAQEAAQUCVNJrJUrGG7//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAEDAQE/AW5hD//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/Aar/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQITH/2gAIAQEAAT8hJoIM5EUw/wD/2gAMAwEAAgADAAAAEOTP/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEh/9oACAEDAQE/EKsJf//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQIBAT8QU9h5f//EABkQAAMBAQEAAAAAAAAAAAAAAAABESFBMf/aAAgBAQABPxBnA9VCioIowQ88EVYf/9k=","aspectRatio":1.7777777777777777,"src":"/static/168ff2c80f69305a62d81ee656ccc4ab/8b365/gradient-patterns-simple-background-widescreen-798987-1920x1080.jpg","srcSet":"/static/168ff2c80f69305a62d81ee656ccc4ab/c93b8/gradient-patterns-simple-background-widescreen-798987-1920x1080.jpg 480w,\n/static/168ff2c80f69305a62d81ee656ccc4ab/322f6/gradient-patterns-simple-background-widescreen-798987-1920x1080.jpg 960w,\n/static/168ff2c80f69305a62d81ee656ccc4ab/8b365/gradient-patterns-simple-background-widescreen-798987-1920x1080.jpg 1920w","sizes":"(max-width: 1920px) 100vw, 1920px"}}},"tags":"Django, Python"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/django-descriptors"}}}