<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.8"><link rel="alternate" type="application/rss+xml" title="Kevin Stone" href="/rss.xml"><link rel="sitemap" href="/sitemap-index.xml"><title>Django Model Behaviors</title><link rel="canonical" href="https://blog.kevinastone.com/django-model-behaviors/"><meta name="description" content="Personal blog for Kevin Stone."><meta name="robots" content="index, follow"><meta property="og:title" content="Django Model Behaviors"><meta property="og:type" content="article"><meta property="og:image" content><meta property="og:url" content="https://blog.kevinastone.com/django-model-behaviors/"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@kevinastone"><meta name="keywords"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/assets/ClientRouter.astro_astro_type_script_index_0_lang.CDGfc0hd.js"></script><link rel="stylesheet" href="/assets/_id_.CbLnlZQv.css">
<style>.img-wrapper[data-astro-cid-3eui6wlw]{background-color:var(--base);display:flex;position:absolute;overflow:hidden;width:100%;height:100%}.img-wrapper[data-astro-cid-3eui6wlw] .duotone-img{filter:grayscale(100%) contrast(1);mix-blend-mode:multiply;opacity:var(--opacity);object-fit:cover;width:100%;height:100%;display:block}.img-wrapper[data-astro-cid-3eui6wlw]:before{content:"";position:absolute;inset:0;background-color:var(--foreground);mix-blend-mode:overlay;z-index:1;pointer-events:none}/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-font-weight:initial}}}.wrapper[data-astro-cid-vva3ln22]{justify-content:center;align-items:center;width:100%;display:flex;position:relative}.hero[data-astro-cid-vva3ln22]{color:#fff;margin-bottom:var(--spacing-rhythm-1\.5,calc(1.5*var(--spacing-rhythm)));padding-block:var(--spacing-rhythm-2,calc(2*var(--spacing-rhythm)));text-align:center}.hero[data-astro-cid-vva3ln22] h1{margin-top:var(--spacing-rhythm-2,calc(2*var(--spacing-rhythm)));margin-bottom:calc(var(--spacing,.25rem)*8);font-size:var(--text-4xl,2.25rem);line-height:var(--tw-leading,var(--text-4xl--line-height,calc(2.5/2.25)));--tw-font-weight:var(--font-weight-bold,700);font-weight:var(--font-weight-bold,700)}.bg[data-astro-cid-vva3ln22]{z-index:1;object-fit:cover;object-position:center;width:100%;height:100%;position:absolute;inset:0}.content[data-astro-cid-vva3ln22]{z-index:3;position:relative}@property --tw-font-weight{syntax:"*";inherits:false}
</style></head> <body> <header class="brand-bg-gradient" data-astro-cid-3ef6ksr2> <div class="navbar" data-astro-cid-3ef6ksr2> <div class="fixed-width">  <div class="row" data-astro-cid-3ef6ksr2> <div class="brand" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Kevin Stone</a> </div> <div class="search" data-astro-cid-3ef6ksr2> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2nfyNG" prefix="r2" component-url="/assets/app.B4Zbbe-O.js" component-export="default" renderer-url="/assets/client.Bfkaqq2T.js" props="{&quot;data-astro-cid-3ef6ksr2&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true}" await-children><form class="relative w-full m-0"><input class="
        w-full
        bg-transparent
        border
        border-accent
        rounded-sm
        text-background
        m-0
        outline-none
        py-1
        px-3
        transition-colors
        duration-500
        focus:bg-background
        focus:border-transparent
        focus:text-primary
        hover:bg-background
        hover:border-transparent
        hover:text-primary
        not-placeholder-shown:bg-background
        not-placeholder-shown:text-primary
      " type="search" placeholder="Search" autoComplete="off" autoCorrect="off" autoCapitalize="off" spellCheck="false" name="query" value=""/><ul class="absolute w-full mt-1 overflow-hidden list-none p-0 bg-background rounded-md shadow-lg z-50"></ul></form><!--astro:end--></astro-island> </div> </div>  </div> </div> </header>  <div class="wrapper hero brand-bg-gradient" data-astro-cid-vva3ln22>  <div class="content" data-astro-cid-vva3ln22>  <div class="fixed-width">  <h1>Django Model Behaviors</h1> <p class="sub-heading"> <time datetime="2013-05-12T00:00:00.000Z"> May 12, 2013 </time> </p>  </div>  </div> </div>  <main> <div class="fixed-width">    <article class="prose max-w-none"> <p>As Django projects scale in complexity beyond the neat and tidy tutorial phase, how can we structure our models to keep things manageable? We’re talking 10s to 100s of models, used across numerous views, templates and tests…</p>
<h2 id="compositional-model-behaviors">Compositional Model Behaviors</h2>
<p>The Compositional Model pattern allows you to manage the complexity of your models through compartmentalization of functionality into manageable components.</p>
<h4 id="the-benefits-of-fat-models">The Benefits of Fat Models</h4>
<ul>
<li>Encapsulation</li>
<li>Single Path</li>
<li>Separation of Concerns (MVC)</li>
</ul>
<h4 id="without-the-maintenance-cost">Without the Maintenance Cost</h4>
<ul>
<li>DRY</li>
<li>Readability</li>
<li>Reusability</li>
<li>Single Responsibility Principle</li>
<li>Testability</li>
</ul>
<h2 id="model-behaviors-example">Model Behaviors Example</h2>
<h4 id="traditional-model">Traditional Model</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    title </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">CharField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">max_length</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">255</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    body </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">TextField</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#CDD6F4">    slug </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">SlugField</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#CDD6F4">    author </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">ForeignKey</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">User</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> related_name</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">'posts'</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    create_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">auto_now_add</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    modified_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">auto_now</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    publish_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">null</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span></code></pre>
<h4 id="decomposed-into-discrete-behaviors">Decomposed into Discrete Behaviors</h4>
<p>The goal of the behavior pattern is to decompose your models into core, reusable mixins. Create a higher level abstraction than the model field that encapsulates the intended business logic.</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">behaviors </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> Authorable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Permalinkable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Timestampable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Publishable</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">Authorable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Permalinkable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Timestampable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Publishable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    title </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">CharField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">max_length</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">255</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    body </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">TextField</span><span style="color:#9399B2">()</span></span></code></pre>
<h4 id="reusable-behaviors">Reusable Behaviors</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Authorable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    author </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">ForeignKey</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">User</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Permalinkable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    slug </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">SlugField</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Publishable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    publish_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">null</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Timestampable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    create_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">auto_now_add</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    modified_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">auto_now</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span></code></pre>
<h2 id="models-are-more-than-just-fields">Models are more than just Fields</h2>
<p>Our first cut at common behaviors just captured common fields, but what about everything else models encapsulate?</p>
<ul>
<li>Properties</li>
<li>Custom Methods</li>
<li>Method Overloads (save(), etc…)</li>
<li>Validation</li>
<li>Querysets</li>
</ul>
<h4 id="capturing-model-methods">Capturing Model Methods</h4>
<p>Let’s extend our traditional fat model with some of these encapsulated busuiness logic</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FAB387;font-style:italic">    @</span><span style="color:#CBA6F7;font-style:italic">property</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> is_published</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">publish_date </span><span style="color:#94E2D5">&#x3C;</span><span style="color:#CDD6F4"> timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FAB387;font-style:italic">    @models</span><span style="color:#9399B2">.</span><span style="color:#FAB387;font-style:italic">permalink</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> get_absolute_url</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#9399B2"> (</span><span style="color:#A6E3A1">'blog-post'</span><span style="color:#9399B2">,</span><span style="color:#9399B2"> (),</span><span style="color:#9399B2"> {</span></span>
<span class="line"><span style="color:#A6E3A1">            "slug"</span><span style="color:#9399B2">:</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">        })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> pre_save</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> instance</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> add</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">text </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> slugify</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CBA6F7"> not</span><span style="color:#CDD6F4"> instance</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            instance</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> slugify</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">title</span><span style="color:#9399B2">)</span></span></code></pre>
<h4 id="behaviors-with-methods">Behaviors with Methods</h4>
<p>In actuality, these same methods can be generalized and extracted into our behavior models</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Permalinkable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    slug </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">SlugField</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> get_url_kwargs</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#94E2D5"> **</span><span style="color:#EBA0AC;font-style:italic">kwargs</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">        kwargs</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">update</span><span style="color:#9399B2">(</span><span style="color:#FAB387;font-style:italic">getattr</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> 'url_kwargs'</span><span style="color:#9399B2">,</span><span style="color:#9399B2"> {}))</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#CDD6F4"> kwargs</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FAB387;font-style:italic">    @models</span><span style="color:#9399B2">.</span><span style="color:#FAB387;font-style:italic">permalink</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> get_absolute_url</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">        url_kwargs </span><span style="color:#94E2D5">=</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">get_url_kwargs</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">slug</span><span style="color:#94E2D5">=</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#9399B2"> (</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">url_name</span><span style="color:#9399B2">,</span><span style="color:#9399B2"> (),</span><span style="color:#CDD6F4"> url_kwargs</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> pre_save</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> instance</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> add</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">text </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> slugify</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CBA6F7"> not</span><span style="color:#CDD6F4"> instance</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            instance</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> slugify</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">slug_source</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> Publishable</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    publish_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DateTimeField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">null</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    class</span><span style="color:#F9E2AF;font-style:italic"> Meta</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        abstract </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">    objects </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> PassThroughManager</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">for_queryset_class</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">PublishableQuerySet</span><span style="color:#9399B2">)()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> publish_on</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> date</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">None</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CBA6F7"> not</span><span style="color:#CDD6F4"> date</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">publish_date </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> date</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">save</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FAB387;font-style:italic">    @</span><span style="color:#CBA6F7;font-style:italic">property</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> is_published</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">publish_date </span><span style="color:#94E2D5">&#x3C;</span><span style="color:#CDD6F4"> timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">()</span></span></code></pre>
<h4 id="wire-up-the-concrete-model">Wire up the Concrete Model</h4>
<p>Since we generalized our behaviors, we need to add some helpers on our concrete models to complete the functionality.</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">behaviors </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> Authorable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Permalinkable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Timestampable</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> Publishable</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">Authorable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Permalinkable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Timestampable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Publishable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    title </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">CharField</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">max_length</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">255</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">    body </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> models</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">TextField</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">    url_name </span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1"> "blog-post"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FAB387;font-style:italic">    @</span><span style="color:#CBA6F7;font-style:italic">property</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> slug_source</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">title</span></span></code></pre>
<h2 id="naming-tips">Naming Tips</h2>
<p>Use “&#x3C;verb>-able” naming pattern for behaviors. The “-able” suffix ensures the behaviors are readily identifiable. It also prevents yet another use of the word Mixin. (Don’t worry when the naming deviates from decent english such as in the case of <code>OptionallyGenericRelateable</code>)</p>
<h2 id="custom-queryset-chaining">Custom Queryset Chaining</h2>
<p>We all know to chain queryset methods, but what about adding custom manager methods?</p>
<p>Let’s Find Posts from a Given Author (username1) that are Published (publish_date in the past)</p>
<h4 id="queryset-without-encapsulation">QuerySet without Encapsulation</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">models </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> BlogPost</span></span>
<span class="line"></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">author__username</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">)</span><span style="color:#9399B2"> \</span></span>
<span class="line"><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date__lte</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span></code></pre>
<h4 id="custom-managers">Custom Managers</h4>
<p>Let’s create methods on a custom Manager to handle the past-publication date and author filters.</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPostManager</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Manager</span><span style="color:#9399B2">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> published</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date__lte</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> authored_by</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> author</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">author__username</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">author</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">    objects </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> BlogPostManager</span><span style="color:#9399B2">()</span></span></code></pre>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> published_posts </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> posts_by_author </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlockPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">)</span></span></code></pre>
<h4 id="chaining-our-filters">Chaining our Filters?</h4>
<p>What if we try to chain our custom filters?</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#FAB387;font-style:italic">AttributeError</span><span style="color:#9399B2">:</span><span style="color:#A6E3A1"> 'QuerySet'</span><span style="color:#CBA6F7;font-style:italic"> object</span><span style="color:#CDD6F4"> has no attribute </span><span style="color:#A6E3A1">'published'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CBA6F7;font-style:italic"> type</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">Blogpost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">))</span></span>
<span class="line"><span style="color:#94E2D5">&#x3C;</span><span style="color:#CBA6F7">class</span><span style="color:#A6E3A1"> 'django.db.models.query.QuerySet'</span><span style="color:#94E2D5">></span></span></code></pre>
<h4 id="solution-custom-querysets"><em>Solution</em>: Custom Querysets</h4>
<p>Leverage <code>PassthroughManager</code> from <a href="https://github.com/carljm/django-model-utils">django-model-utils</a> to allow chaining of custom manager methods.</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> model_utils</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">managers </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> PassThroughManager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> PublishableQuerySet</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">query</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">QuerySet</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> published</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date__lte</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> AuthorableQuerySet</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">query</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">QuerySet</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> authored_by</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> author</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">author__username</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">author</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPostQuerySet</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">AuthorableQuerySet</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> PublishableQuerySet</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    pass</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPost</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">Authorable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Permalinkable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Timestampable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> Publishable</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> models</span><span style="color:#9399B2">.</span><span style="color:#F9E2AF;font-style:italic">Model</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">    objects </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> PassThroughManager</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">for_queryset_class</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">BlogPostQuerySet</span><span style="color:#9399B2">)()</span></span></code></pre>
<p>Now you can chain custom methods inherited from multiple behaviors.</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> author_public_posts </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CBA6F7;font-style:italic"> type</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">Blogpost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">))</span></span>
<span class="line"><span style="color:#94E2D5">&#x3C;</span><span style="color:#CBA6F7">class</span><span style="color:#A6E3A1"> 'example.queryset.BlogPostQuerySet'</span><span style="color:#94E2D5">></span></span></code></pre>
<h4 id="ensulated-business-logic">Ensulated Business Logic</h4>
<p>What’s more legible and maintainable?</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CDD6F4">BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">author__username</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">filter</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date__lte</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span></code></pre>
<p>or</p>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CDD6F4">BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">authored_by</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'username1'</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">()</span></span></code></pre>
<h2 id="testing-behaviors">Testing Behaviors</h2>
<p>Create matching Behavior tests to validate our models.</p>
<h4 id="same-benefits-as-for-models">Same Benefits as for Models</h4>
<ul>
<li>DRY</li>
<li>Readability</li>
<li>Reusability</li>
<li>Single Responsibility</li>
</ul>
<h2 id="unit-test-example">Unit Test Example</h2>
<p>We can create reusuable test components that validate our behaviors. The list of test mixins then become documentation for the expected role of the model.</p>
<h4 id="traditional-test">Traditional Test</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">test </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> TestCase</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">models </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> BlogPost</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPostTestCase</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">TestCase</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> test_published_blogpost</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CDD6F4">        blogpost </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">create</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">assertTrue</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">blogpost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">is_published</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">assertIn</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">blogpost</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">())</span></span></code></pre>
<h4 id="converted-to-a-behavior-test-mixin">Converted to a Behavior Test Mixin</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BehaviorTestCaseMixin</span><span style="color:#9399B2">(</span><span style="color:#CBA6F7;font-style:italic">object</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> get_model</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">            return</span><span style="color:#FAB387;font-style:italic"> getattr</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> 'model'</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> create_instance</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#94E2D5"> **</span><span style="color:#EBA0AC;font-style:italic">kwargs</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        raise</span><span style="color:#FAB387;font-style:italic"> NotImplementedError</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"Implement me"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> PublishableTests</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">BehaviorTestCaseMixin</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> test_published_blogpost</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">utils </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> timezone</span></span>
<span class="line"><span style="color:#CDD6F4">        obj </span><span style="color:#94E2D5">=</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">create_instance</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">publish_date</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">timezone</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">now</span><span style="color:#9399B2">())</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">assertTrue</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">obj</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">is_published</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">assertIn</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">obj</span><span style="color:#9399B2">,</span><span style="color:#F38BA8;font-style:italic"> self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">model</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">published</span><span style="color:#9399B2">())</span></span></code></pre>
<h4 id="the-updated-unit-test">The Updated Unit Test</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> django</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">test </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> TestCase</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">models </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> BlogPost</span></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#9399B2"> .</span><span style="color:#CDD6F4">behaviors</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">tests </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> PublishableTests</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPostTestCase</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">PublishableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> TestCase</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    model </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlogPost</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> create_instance</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#94E2D5"> **</span><span style="color:#EBA0AC;font-style:italic">kwargs</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">create</span><span style="color:#9399B2">(</span><span style="color:#94E2D5">**</span><span style="color:#CDD6F4">kwargs</span><span style="color:#9399B2">)</span></span></code></pre>
<h4 id="combine-with-model-specific-tests">Combine with Model Specific Tests</h4>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> BlogPostTestCase</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">PublishableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> AuthorableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> PermalinkableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> TimestampableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> TestCase</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    model </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> BlogPost</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> create_instance</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">,</span><span style="color:#94E2D5"> **</span><span style="color:#EBA0AC;font-style:italic">kwargs</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#CDD6F4"> BlogPost</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">objects</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">create</span><span style="color:#9399B2">(</span><span style="color:#94E2D5">**</span><span style="color:#CDD6F4">kwargs</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> test_blog_specific_functionality</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">        ...</span></span></code></pre>
<h2 id="additional-model-testing-tips">Additional Model Testing Tips</h2>
<ul>
<li>Use <a href="https://github.com/FactoryBoy/factory_boy">Factory Boy</a> for creating test instances/fixtures</li>
<li>Use Inherited TestCases to validate different scenarios</li>
</ul>
<pre class="astro-code catppuccin-mocha" style="background-color:#1e1e2e;color:#cdd6f4; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> StaffBlogPostTestCase</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">PublishableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> AuthorableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> PermalinkableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> TimestampableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> BaseBlogPostTestCase</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    det </span><span style="color:#89B4FA">setUp</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">user </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> StaffUser</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">class</span><span style="color:#F9E2AF;font-style:italic"> AuthorizedUserBlogPostTestCase</span><span style="color:#9399B2">(</span><span style="color:#F9E2AF;font-style:italic">PublishableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> AuthorableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> PermalinkableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> TimestampableTests</span><span style="color:#9399B2">,</span><span style="color:#F9E2AF;font-style:italic"> BaseBlogPostTestCase</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">    det </span><span style="color:#89B4FA">setUp</span><span style="color:#9399B2">(</span><span style="color:#F38BA8;font-style:italic">self</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">        self</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">user </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> AuthorizedUser</span><span style="color:#9399B2">()</span></span></code></pre>
<p>(Same behavior expected for Staff or Authorized User)</p>
<h2 id="reusability">Reusability</h2>
<h4 id="eventually-build-a-libray-of-behaviors">Eventually Build a Libray of Behaviors</h4>
<ul>
<li><em>Permalinkable</em></li>
<li><em>Publishable</em></li>
<li><em>Authorable</em></li>
<li><em>Timestampable</em></li>
</ul>
<h4 id="reusable-both-across-our-own-apps-and-shareable-through-the-community">Reusable both across our own Apps and shareable through the Community</h4>
<p>More Examples</p>
<ul>
<li><em>Moderatable</em> - <code>BooleanField('approved')</code></li>
<li><em>Scheduleable</em> - (<code>start_date</code> and <code>end_date</code> with range queries)</li>
<li><em>GenericRelatable</em> (the triplet of <code>content_type</code>, <code>object_id</code> and <code>GenericForeignKey</code>)</li>
<li><em>Orderable</em> - <code>PositiveSmallIntegerField('position')</code></li>
</ul>
<h2 id="recommended-app-layout">Recommended App Layout</h2>
<ul>
<li>querysets.py</li>
<li>behaviors.py (uses querysets)</li>
<li>models.py (composition of querysets and behaviors)</li>
<li>factories.py (uses models)</li>
<li>tests.py (uses all, split this into a module for larger apps)</li>
</ul>
<p>I usually have a <em>common</em> app that has the shared behaviors, model and behavior test mixins with no dependencies on other apps.</p>
<h2 id="limitationspitfalls">Limitations/Pitfalls</h2>
<p>Basically the challenges of Django Model Inheritance.</p>
<h4 id="leak-abstractions">Leak Abstractions</h4>
<ul>
<li>Meta Options don’t implicitly inherit (ordering, etc)</li>
<li>Manager vs Queryset vs Model (some duplication of logic)</li>
<li>ModelField options (toggling <code>default=True</code> vs <code>default=False</code>)</li>
</ul>
<p>You often need to handle the composition yourself such as merging custom QuerySet classes or combining Meta Options.</p>
<h2 id="3rd-party-helpers">3rd Party Helpers</h2>
<p>Don’t reinvent the wheel if you don’t have to.</p>
<ul>
<li><a href="https://github.com/django-extensions/django-extensions">Django Extensions</a> (UUIDField, AutoSlugField, etc)</li>
<li><a href="https://github.com/carljm/django-model-utils">Django Model Utils</a> (already mentioned)</li>
<li>Filters (<a href="https://github.com/alex/django-filter">django-filter</a>)</li>
</ul>
<h4 id="test-helpers">Test Helpers</h4>
<ul>
<li>Factories (<a href="https://github.com/FactoryBoy/factory_boy">factory boy</a>)
Mocking (<a href="http://www.voidspace.org.uk/python/mock/">mock</a>)</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>All the example code from this post is available on a <a href="https://github.com/kevinastone/django-model-behaviors-example">GitHub Project</a>.</p> <section><script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><astro-island uid="Z9T4gl" prefix="r3" component-url="/assets/Disqus.ZXPp-emh.js" component-export="default" renderer-url="/assets/client.Bfkaqq2T.js" props="{&quot;id&quot;:[0,&quot;django-model-behaviors&quot;],&quot;title&quot;:[0,&quot;Django Model Behaviors&quot;],&quot;shortname&quot;:[0,&quot;kevinstone&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;Disqus&quot;,&quot;value&quot;:true}" await-children><div id="disqus_thread"></div><!--astro:end--></astro-island></section> </article>   </div> </main> <footer data-astro-cid-sz7xmlte> <div class="fixed-width">  <p data-astro-cid-sz7xmlte>&copy; Kevin A. Stone 2026, Built with <a href="https://astro.build/" data-astro-cid-sz7xmlte>Astro</a></p>  </div> </footer>  </body></html>